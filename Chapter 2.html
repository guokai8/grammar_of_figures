<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 2: The Language of Color – The Complete Guide to Bash Errors: From Beginner to Expert</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter 3.html" rel="next">
<link href="./Chapter 1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter 2.html"><span class="chapter-title">Chapter 2: The Language of Color</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Complete Guide to Bash Errors: From Beginner to Expert</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Grammar of Figures: The Art &amp; Science of Visualizing Data for Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 0.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>Grammar of Figures: The Art and Science of Visualizing Data for Publication</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 2: The Language of Color</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Typography, Annotation &amp; Labels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: Data Encoding &amp; Graph Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: Technical Specifications &amp; Publication Requirements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Common Figure Types Deep Dive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Specialized Field Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Interactive and Dynamic Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#color-theory-foundations" id="toc-color-theory-foundations" class="nav-link active" data-scroll-target="#color-theory-foundations">2.1 Color Theory Foundations</a>
  <ul class="collapse">
  <li><a href="#why-color-matters-in-scientific-visualization" id="toc-why-color-matters-in-scientific-visualization" class="nav-link" data-scroll-target="#why-color-matters-in-scientific-visualization">Why Color Matters in Scientific Visualization</a></li>
  <li><a href="#color-models-and-color-spaces" id="toc-color-models-and-color-spaces" class="nav-link" data-scroll-target="#color-models-and-color-spaces">Color Models and Color Spaces</a></li>
  <li><a href="#summary-which-color-space-to-use" id="toc-summary-which-color-space-to-use" class="nav-link" data-scroll-target="#summary-which-color-space-to-use">Summary: Which Color Space to Use?</a></li>
  <li><a href="#exercise-2.1.1-color-space-exploration" id="toc-exercise-2.1.1-color-space-exploration" class="nav-link" data-scroll-target="#exercise-2.1.1-color-space-exploration">Exercise 2.1.1: Color Space Exploration</a></li>
  </ul></li>
  <li><a href="#choosing-color-palettes" id="toc-choosing-color-palettes" class="nav-link" data-scroll-target="#choosing-color-palettes">2.2 Choosing Color Palettes</a>
  <ul class="collapse">
  <li><a href="#the-three-palette-types" id="toc-the-three-palette-types" class="nav-link" data-scroll-target="#the-three-palette-types">The Three Palette Types</a></li>
  <li><a href="#palette-selection-decision-tree" id="toc-palette-selection-decision-tree" class="nav-link" data-scroll-target="#palette-selection-decision-tree">Palette Selection Decision Tree</a></li>
  <li><a href="#exercise-2.2.1-palette-type-classification" id="toc-exercise-2.2.1-palette-type-classification" class="nav-link" data-scroll-target="#exercise-2.2.1-palette-type-classification">Exercise 2.2.1: Palette Type Classification</a></li>
  </ul></li>
  <li><a href="#light-vs.-dark-background" id="toc-light-vs.-dark-background" class="nav-link" data-scroll-target="#light-vs.-dark-background">2.3 Light vs.&nbsp;Dark Background</a>
  <ul class="collapse">
  <li><a href="#the-context-driven-choice" id="toc-the-context-driven-choice" class="nav-link" data-scroll-target="#the-context-driven-choice">The Context-Driven Choice</a></li>
  <li><a href="#publication-standard-light-backgrounds-default" id="toc-publication-standard-light-backgrounds-default" class="nav-link" data-scroll-target="#publication-standard-light-backgrounds-default">Publication Standard: Light Backgrounds (Default)</a></li>
  <li><a href="#when-dark-themes-are-appropriate" id="toc-when-dark-themes-are-appropriate" class="nav-link" data-scroll-target="#when-dark-themes-are-appropriate">When Dark Themes Are Appropriate</a></li>
  <li><a href="#the-color-restraint-principle-for-publications" id="toc-the-color-restraint-principle-for-publications" class="nav-link" data-scroll-target="#the-color-restraint-principle-for-publications">The Color Restraint Principle for Publications</a></li>
  <li><a href="#the-3-color-rule-for-scientific-figures" id="toc-the-3-color-rule-for-scientific-figures" class="nav-link" data-scroll-target="#the-3-color-rule-for-scientific-figures">The “3-Color Rule” for Scientific Figures</a></li>
  <li><a href="#logical-color-schemes-semantic-consistency" id="toc-logical-color-schemes-semantic-consistency" class="nav-link" data-scroll-target="#logical-color-schemes-semantic-consistency">Logical Color Schemes: Semantic Consistency</a></li>
  <li><a href="#field-specific-color-conventions" id="toc-field-specific-color-conventions" class="nav-link" data-scroll-target="#field-specific-color-conventions">Field-Specific Color Conventions</a></li>
  <li><a href="#code-examples-light-theme-with-minimal-color" id="toc-code-examples-light-theme-with-minimal-color" class="nav-link" data-scroll-target="#code-examples-light-theme-with-minimal-color">Code Examples: Light Theme with Minimal Color</a></li>
  <li><a href="#dark-theme-when-and-how-presentations-only" id="toc-dark-theme-when-and-how-presentations-only" class="nav-link" data-scroll-target="#dark-theme-when-and-how-presentations-only">Dark Theme: When and How (Presentations Only)</a></li>
  <li><a href="#publication-submission-checklist-color-theme" id="toc-publication-submission-checklist-color-theme" class="nav-link" data-scroll-target="#publication-submission-checklist-color-theme">Publication Submission Checklist: Color &amp; Theme</a></li>
  <li><a href="#exercise-2.3.1-color-restraint-practice" id="toc-exercise-2.3.1-color-restraint-practice" class="nav-link" data-scroll-target="#exercise-2.3.1-color-restraint-practice">Exercise 2.3.1: Color Restraint Practice</a></li>
  </ul></li>
  <li><a href="#light-vs.-deep-colors-saturation-and-intensity" id="toc-light-vs.-deep-colors-saturation-and-intensity" class="nav-link" data-scroll-target="#light-vs.-deep-colors-saturation-and-intensity">2.4 Light vs.&nbsp;Deep Colors: Saturation and Intensity</a>
  <ul class="collapse">
  <li><a href="#understanding-color-intensity-in-scientific-figures" id="toc-understanding-color-intensity-in-scientific-figures" class="nav-link" data-scroll-target="#understanding-color-intensity-in-scientific-figures">Understanding Color Intensity in Scientific Figures</a></li>
  <li><a href="#the-saturation-spectrum" id="toc-the-saturation-spectrum" class="nav-link" data-scroll-target="#the-saturation-spectrum">The Saturation Spectrum</a></li>
  <li><a href="#the-visual-hierarchy-principle-deep-colors-for-focus" id="toc-the-visual-hierarchy-principle-deep-colors-for-focus" class="nav-link" data-scroll-target="#the-visual-hierarchy-principle-deep-colors-for-focus">The Visual Hierarchy Principle: Deep Colors for Focus</a></li>
  <li><a href="#practical-application-examples" id="toc-practical-application-examples" class="nav-link" data-scroll-target="#practical-application-examples">Practical Application Examples</a></li>
  <li><a href="#guidelines-for-saturation-use" id="toc-guidelines-for-saturation-use" class="nav-link" data-scroll-target="#guidelines-for-saturation-use">Guidelines for Saturation Use</a></li>
  <li><a href="#the-3-color-saturation-strategy" id="toc-the-3-color-saturation-strategy" class="nav-link" data-scroll-target="#the-3-color-saturation-strategy">The “3-Color + Saturation” Strategy</a></li>
  <li><a href="#publication-checklist-color-saturation" id="toc-publication-checklist-color-saturation" class="nav-link" data-scroll-target="#publication-checklist-color-saturation">Publication Checklist: Color Saturation</a></li>
  </ul></li>
  <li><a href="#continuous-vs.-discrete-color-scales" id="toc-continuous-vs.-discrete-color-scales" class="nav-link" data-scroll-target="#continuous-vs.-discrete-color-scales">2.5 Continuous vs.&nbsp;Discrete Color Scales</a>
  <ul class="collapse">
  <li><a href="#understanding-the-distinction" id="toc-understanding-the-distinction" class="nav-link" data-scroll-target="#understanding-the-distinction">Understanding the Distinction</a></li>
  <li><a href="#continuous-color-scales-sequentialdiverging-gradients" id="toc-continuous-color-scales-sequentialdiverging-gradients" class="nav-link" data-scroll-target="#continuous-color-scales-sequentialdiverging-gradients">Continuous Color Scales (Sequential/Diverging Gradients)</a></li>
  <li><a href="#when-continuous-scales-make-sense" id="toc-when-continuous-scales-make-sense" class="nav-link" data-scroll-target="#when-continuous-scales-make-sense">When Continuous Scales Make Sense</a></li>
  <li><a href="#discrete-color-scales-categorical-palettes" id="toc-discrete-color-scales-categorical-palettes" class="nav-link" data-scroll-target="#discrete-color-scales-categorical-palettes">Discrete Color Scales (Categorical Palettes)</a></li>
  <li><a href="#when-discrete-scales-make-sense" id="toc-when-discrete-scales-make-sense" class="nav-link" data-scroll-target="#when-discrete-scales-make-sense">When Discrete Scales Make Sense</a></li>
  <li><a href="#common-mistakes-mixing-continuous-and-discrete" id="toc-common-mistakes-mixing-continuous-and-discrete" class="nav-link" data-scroll-target="#common-mistakes-mixing-continuous-and-discrete">Common Mistakes: Mixing Continuous and Discrete</a></li>
  <li><a href="#decision-matrix-continuous-vs.-discrete" id="toc-decision-matrix-continuous-vs.-discrete" class="nav-link" data-scroll-target="#decision-matrix-continuous-vs.-discrete">Decision Matrix: Continuous vs.&nbsp;Discrete</a></li>
  <li><a href="#exercise-2.5.1-scale-type-classification" id="toc-exercise-2.5.1-scale-type-classification" class="nav-link" data-scroll-target="#exercise-2.5.1-scale-type-classification">Exercise 2.5.1: Scale Type Classification</a></li>
  </ul></li>
  <li><a href="#color-in-context-scientific-taste-and-discipline-conventions" id="toc-color-in-context-scientific-taste-and-discipline-conventions" class="nav-link" data-scroll-target="#color-in-context-scientific-taste-and-discipline-conventions">2.6 Color in Context: Scientific Taste and Discipline Conventions</a>
  <ul class="collapse">
  <li><a href="#the-unwritten-rules-of-scientific-color-use" id="toc-the-unwritten-rules-of-scientific-color-use" class="nav-link" data-scroll-target="#the-unwritten-rules-of-scientific-color-use">The Unwritten Rules of Scientific Color Use</a></li>
  <li><a href="#what-is-scientific-taste-in-color" id="toc-what-is-scientific-taste-in-color" class="nav-link" data-scroll-target="#what-is-scientific-taste-in-color">What is “Scientific Taste” in Color?</a></li>
  <li><a href="#core-principles-of-scientific-color-taste" id="toc-core-principles-of-scientific-color-taste" class="nav-link" data-scroll-target="#core-principles-of-scientific-color-taste">Core Principles of Scientific Color Taste</a></li>
  <li><a href="#field-specific-color-conventions-1" id="toc-field-specific-color-conventions-1" class="nav-link" data-scroll-target="#field-specific-color-conventions-1">Field-Specific Color Conventions</a></li>
  <li><a href="#when-to-break-conventions-rarely" id="toc-when-to-break-conventions-rarely" class="nav-link" data-scroll-target="#when-to-break-conventions-rarely">When to Break Conventions (Rarely)</a></li>
  <li><a href="#exercise-2.6.1-convention-recognition-and-application" id="toc-exercise-2.6.1-convention-recognition-and-application" class="nav-link" data-scroll-target="#exercise-2.6.1-convention-recognition-and-application">Exercise 2.6.1: Convention Recognition and Application</a></li>
  <li><a href="#summary-color-taste-checklist" id="toc-summary-color-taste-checklist" class="nav-link" data-scroll-target="#summary-color-taste-checklist">Summary: Color Taste Checklist</a></li>
  </ul></li>
  <li><a href="#accessibility-and-integrity-in-color" id="toc-accessibility-and-integrity-in-color" class="nav-link" data-scroll-target="#accessibility-and-integrity-in-color">2.7 Accessibility and Integrity in Color</a>
  <ul class="collapse">
  <li><a href="#the-ethical-imperative" id="toc-the-ethical-imperative" class="nav-link" data-scroll-target="#the-ethical-imperative">The Ethical Imperative</a></li>
  <li><a href="#types-of-color-vision-deficiency" id="toc-types-of-color-vision-deficiency" class="nav-link" data-scroll-target="#types-of-color-vision-deficiency">Types of Color Vision Deficiency</a></li>
  <li><a href="#designing-for-color-accessibility" id="toc-designing-for-color-accessibility" class="nav-link" data-scroll-target="#designing-for-color-accessibility">Designing for Color Accessibility</a></li>
  <li><a href="#color-integrity-ethical-use-of-color" id="toc-color-integrity-ethical-use-of-color" class="nav-link" data-scroll-target="#color-integrity-ethical-use-of-color">Color Integrity: Ethical Use of Color</a></li>
  <li><a href="#complete-accessibility-checklist" id="toc-complete-accessibility-checklist" class="nav-link" data-scroll-target="#complete-accessibility-checklist">Complete Accessibility Checklist</a></li>
  <li><a href="#exercise-2.7.1-accessibility-audit" id="toc-exercise-2.7.1-accessibility-audit" class="nav-link" data-scroll-target="#exercise-2.7.1-accessibility-audit">Exercise 2.7.1: Accessibility Audit</a></li>
  <li><a href="#summary-accessibility-integrity-principles" id="toc-summary-accessibility-integrity-principles" class="nav-link" data-scroll-target="#summary-accessibility-integrity-principles">Summary: Accessibility &amp; Integrity Principles</a></li>
  </ul></li>
  <li><a href="#logical-color-mapping-special-cases-and-edge-scenarios" id="toc-logical-color-mapping-special-cases-and-edge-scenarios" class="nav-link" data-scroll-target="#logical-color-mapping-special-cases-and-edge-scenarios">2.8 Logical Color Mapping: Special Cases and Edge Scenarios</a>
  <ul class="collapse">
  <li><a href="#the-critical-principle-color-logic-must-match-data-reality" id="toc-the-critical-principle-color-logic-must-match-data-reality" class="nav-link" data-scroll-target="#the-critical-principle-color-logic-must-match-data-reality">The Critical Principle: Color Logic Must Match Data Reality</a></li>
  <li><a href="#scenario-1-all-values-are-significant" id="toc-scenario-1-all-values-are-significant" class="nav-link" data-scroll-target="#scenario-1-all-values-are-significant">Scenario 1: All Values Are Significant</a></li>
  <li><a href="#scenario-2-missing-data-in-heatmaps" id="toc-scenario-2-missing-data-in-heatmaps" class="nav-link" data-scroll-target="#scenario-2-missing-data-in-heatmaps">Scenario 2: Missing Data in Heatmaps</a></li>
  <li><a href="#scenario-3-zero-is-meaningful-vs.-zero-is-arbitrary" id="toc-scenario-3-zero-is-meaningful-vs.-zero-is-arbitrary" class="nav-link" data-scroll-target="#scenario-3-zero-is-meaningful-vs.-zero-is-arbitrary">Scenario 3: Zero is Meaningful vs.&nbsp;Zero is Arbitrary</a></li>
  <li><a href="#summary-logical-color-mapping-rules" id="toc-summary-logical-color-mapping-rules" class="nav-link" data-scroll-target="#summary-logical-color-mapping-rules">Summary: Logical Color Mapping Rules</a></li>
  <li><a href="#exercise-2.8.1-logical-color-mapping-audit" id="toc-exercise-2.8.1-logical-color-mapping-audit" class="nav-link" data-scroll-target="#exercise-2.8.1-logical-color-mapping-audit">Exercise 2.8.1: Logical Color Mapping Audit</a></li>
  <li><a href="#scenario-4-cyclic-data-time-of-day-angles-compass-directions" id="toc-scenario-4-cyclic-data-time-of-day-angles-compass-directions" class="nav-link" data-scroll-target="#scenario-4-cyclic-data-time-of-day-angles-compass-directions">Scenario 4: Cyclic Data (Time of Day, Angles, Compass Directions)</a></li>
  <li><a href="#scenario-5-multiple-scales-in-one-figure" id="toc-scenario-5-multiple-scales-in-one-figure" class="nav-link" data-scroll-target="#scenario-5-multiple-scales-in-one-figure">Scenario 5: Multiple Scales in One Figure</a></li>
  <li><a href="#complete-logical-color-mapping-checklist" id="toc-complete-logical-color-mapping-checklist" class="nav-link" data-scroll-target="#complete-logical-color-mapping-checklist">Complete Logical Color Mapping Checklist</a></li>
  <li><a href="#summary-advanced-color-logic" id="toc-summary-advanced-color-logic" class="nav-link" data-scroll-target="#summary-advanced-color-logic">Summary: Advanced Color Logic</a></li>
  <li><a href="#color-palette-design-principles" id="toc-color-palette-design-principles" class="nav-link" data-scroll-target="#color-palette-design-principles"><strong>2.8 Color Palette Design Principles</strong></a></li>
  <li><a href="#rule-1-the-3-5-color-maximum" id="toc-rule-1-the-3-5-color-maximum" class="nav-link" data-scroll-target="#rule-1-the-3-5-color-maximum"><strong>Rule 1: The 3-5 Color Maximum</strong></a></li>
  <li><a href="#rule-2-color-harmony---avoid-deep-light-mixing" id="toc-rule-2-color-harmony---avoid-deep-light-mixing" class="nav-link" data-scroll-target="#rule-2-color-harmony---avoid-deep-light-mixing"><strong>Rule 2: Color Harmony - Avoid Deep + Light Mixing</strong></a></li>
  <li><a href="#rule-3-biological-logic-in-color-assignment" id="toc-rule-3-biological-logic-in-color-assignment" class="nav-link" data-scroll-target="#rule-3-biological-logic-in-color-assignment"><strong>Rule 3: Biological Logic in Color Assignment</strong></a></li>
  <li><a href="#rule-4-namissing-data-color-strategy" id="toc-rule-4-namissing-data-color-strategy" class="nav-link" data-scroll-target="#rule-4-namissing-data-color-strategy"><strong>Rule 4: NA/Missing Data Color Strategy</strong></a></li>
  <li><a href="#rule-5-sequential-colors---single-hue-families" id="toc-rule-5-sequential-colors---single-hue-families" class="nav-link" data-scroll-target="#rule-5-sequential-colors---single-hue-families"><strong>Rule 5: Sequential Colors - Single Hue Families</strong></a></li>
  </ul></li>
  <li><a href="#shape-selection-and-usage-new-section" id="toc-shape-selection-and-usage-new-section" class="nav-link" data-scroll-target="#shape-selection-and-usage-new-section"><strong>2.9 Shape Selection and Usage (NEW SECTION)</strong></a>
  <ul class="collapse">
  <li><a href="#rule-shape-must-provide-clear-contrast" id="toc-rule-shape-must-provide-clear-contrast" class="nav-link" data-scroll-target="#rule-shape-must-provide-clear-contrast"><strong>Rule: Shape Must Provide Clear Contrast</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 2: The Language of Color</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="color-theory-foundations" class="level2">
<h2 class="anchored" data-anchor-id="color-theory-foundations">2.1 Color Theory Foundations</h2>
<section id="why-color-matters-in-scientific-visualization" class="level3">
<h3 class="anchored" data-anchor-id="why-color-matters-in-scientific-visualization">Why Color Matters in Scientific Visualization</h3>
<p>Color is one of the most powerful visual channels available, yet it’s also one of the most misused. Unlike position or length, which have inherent quantitative meaning, color’s interpretation is:</p>
<ul>
<li><strong>Culturally dependent</strong> (red means “danger” in some contexts, “celebration” in others)</li>
<li><strong>Context-dependent</strong> (same color looks different on different backgrounds)</li>
<li><strong>Perceptually non-uniform</strong> (equal numeric differences ≠ equal perceptual differences)</li>
<li><strong>Biologically variable</strong> (8% of males, 0.5% of females have color vision deficiency)</li>
</ul>
<p><strong>The Goal of This Chapter:</strong> Teach you to use color <strong>scientifically</strong> — as a precise encoding tool, not decoration.</p>
<hr>
</section>
<section id="color-models-and-color-spaces" class="level3">
<h3 class="anchored" data-anchor-id="color-models-and-color-spaces">Color Models and Color Spaces</h3>
<p>To use color effectively, we must understand how to specify and manipulate it. Different color models serve different purposes.</p>
<section id="rgb-the-additive-model-screens" class="level4">
<h4 class="anchored" data-anchor-id="rgb-the-additive-model-screens">RGB: The Additive Model (Screens)</h4>
<p><strong>Definition:</strong> Colors created by mixing Red, Green, and Blue light.</p>
<p><strong>Range:</strong> Each channel: 0-255 (8-bit) or 0.0-1.0 (normalized)</p>
<p><strong>Examples:</strong></p>
<pre><code>Pure Red:    RGB(255, 0, 0)   or RGB(1.0, 0.0, 0.0)
Pure Green:  RGB(0, 255, 0)   or RGB(0.0, 1.0, 0.0)
Pure Blue:   RGB(0, 0, 255)   or RGB(0.0, 0.0, 1.0)
White:       RGB(255, 255, 255)
Black:       RGB(0, 0, 0)
Gray:        RGB(128, 128, 128)</code></pre>
<p><strong>Strengths:</strong> - Native to digital displays - Direct hardware mapping - Simple for programming</p>
<p><strong>Weaknesses:</strong> - <strong>Not perceptually uniform</strong>: Equal RGB steps don’t produce equal visual differences - <strong>Hard to reason about</strong>: “What’s halfway between red and blue?” → Purple? Magenta? - <strong>Doesn’t separate color dimensions</strong>: Hue and brightness are entangled</p>
<p><strong>When to Use:</strong> - Specifying colors for screen display - Digital-only figures - When starting from hex codes (e.g., #FF5733)</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate RGB color space</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color samples</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>colors_rgb <span class="op">=</span> [</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="st">'Red</span><span class="ch">\n</span><span class="st">RGB(255,0,0)'</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="st">'Green</span><span class="ch">\n</span><span class="st">RGB(0,255,0)'</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="st">'Blue</span><span class="ch">\n</span><span class="st">RGB(0,0,255)'</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="st">'Yellow</span><span class="ch">\n</span><span class="st">RGB(255,255,0)'</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="st">'Magenta</span><span class="ch">\n</span><span class="st">RGB(255,0,255)'</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="st">'Cyan</span><span class="ch">\n</span><span class="st">RGB(0,255,255)'</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (r, g, b, label) <span class="kw">in</span> <span class="bu">enumerate</span>(colors_rgb):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>(r, g, b))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(rect)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    ax.text(i<span class="op">+</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, label, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> (r<span class="op">+</span>g<span class="op">+</span>b) <span class="op">&lt;</span> <span class="fl">1.5</span> <span class="cf">else</span> <span class="st">'black'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="bu">len</span>(colors_rgb))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">'off'</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'RGB Color Model: Additive Primaries'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'rgb_color_model.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create RGB color samples</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>rgb_colors <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>, <span class="st">'yellow'</span>, <span class="st">'magenta'</span>, <span class="st">'cyan'</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">rgb_code =</span> <span class="fu">c</span>(<span class="st">'RGB(255,0,0)'</span>, <span class="st">'RGB(0,255,0)'</span>, <span class="st">'RGB(0,0,255)'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">'RGB(255,255,0)'</span>, <span class="st">'RGB(255,0,255)'</span>, <span class="st">'RGB(0,255,255)'</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hex =</span> <span class="fu">c</span>(<span class="st">'#FF0000'</span>, <span class="st">'#00FF00'</span>, <span class="st">'#0000FF'</span>, <span class="st">'#FFFF00'</span>, <span class="st">'#FF00FF'</span>, <span class="st">'#00FFFF'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rgb_colors, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> hex), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(color, rgb_code, <span class="at">sep=</span><span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'RGB Color Model: Additive Primaries'</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'rgb_color_model.png'</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="cmyk-the-subtractive-model-print" class="level4">
<h4 class="anchored" data-anchor-id="cmyk-the-subtractive-model-print">CMYK: The Subtractive Model (Print)</h4>
<p><strong>Definition:</strong> Colors created by mixing Cyan, Magenta, Yellow, and Black (K) inks.</p>
<p><strong>Range:</strong> Each channel: 0-100%</p>
<p><strong>Why It Exists:</strong> - Ink on paper <strong>absorbs</strong> light (subtractive) - Different from light emission (additive RGB) - Professional printing uses CMYK</p>
<p><strong>Example:</strong></p>
<pre><code>Pure Red:     CMYK(0%, 100%, 100%, 0%)   [No cyan, full magenta+yellow]
Pure Green:   CMYK(100%, 0%, 100%, 0%)   [Full cyan+yellow, no magenta]
Pure Blue:    CMYK(100%, 100%, 0%, 0%)   [Full cyan+magenta]
Black:        CMYK(0%, 0%, 0%, 100%)     [Pure black ink]</code></pre>
<p><strong>When to Use:</strong> - Preparing figures for print publication - Journal requires CMYK submission - Proofing how colors will appear in print</p>
<p><strong>Important Note:</strong> - RGB → CMYK conversion can shift colors (especially bright blues, greens) - Always preview in target color space - Some RGB colors have no CMYK equivalent (out of gamut)</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Matplotlib doesn't natively support CMYK, but we can demonstrate conversion</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create RGB image</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB version</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>rgb_colors <span class="op">=</span> [<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>, <span class="st">'cyan'</span>, <span class="st">'magenta'</span>, <span class="st">'yellow'</span>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, color <span class="kw">in</span> <span class="bu">enumerate</span>(rgb_colors):</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> plt.Rectangle((i, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>color)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].add_patch(rect)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlim(<span class="dv">0</span>, <span class="bu">len</span>(rgb_colors))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'RGB (Screen Display)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated "CMYK" appearance (with gamut limitations)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># In reality, you'd convert via color management</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>cmyk_note <span class="op">=</span> <span class="st">"""CMYK (Print):</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">- Some colors shift</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">- Gamut smaller than RGB</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">- Preview before submission"""</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, cmyk_note, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'CMYK Considerations'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'RGB vs CMYK Color Spaces'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'rgb_vs_cmyk.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB to CMYK conversion approximation</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>rgb_to_cmyk <span class="ot">&lt;-</span> <span class="cf">function</span>(r, g, b) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalize RGB to 0-1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> r<span class="sc">/</span><span class="dv">255</span>; g <span class="ot">&lt;-</span> g<span class="sc">/</span><span class="dv">255</span>; b <span class="ot">&lt;-</span> b<span class="sc">/</span><span class="dv">255</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate K (black)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">max</span>(<span class="fu">c</span>(r, g, b))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">C=</span><span class="dv">0</span>, <span class="at">M=</span><span class="dv">0</span>, <span class="at">Y=</span><span class="dv">0</span>, <span class="at">K=</span><span class="dv">100</span>))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate CMY</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> r <span class="sc">-</span> k) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> k)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> g <span class="sc">-</span> k) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> k)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> b <span class="sc">-</span> k) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> k)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">C=</span><span class="fu">round</span>(c<span class="sc">*</span><span class="dv">100</span>), <span class="at">M=</span><span class="fu">round</span>(m<span class="sc">*</span><span class="dv">100</span>), <span class="at">Y=</span><span class="fu">round</span>(y<span class="sc">*</span><span class="dv">100</span>), <span class="at">K=</span><span class="fu">round</span>(k<span class="sc">*</span><span class="dv">100</span>)))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Example colors</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>colors_demo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">'Red'</span>, <span class="st">'Green'</span>, <span class="st">'Blue'</span>, <span class="st">'Cyan'</span>, <span class="st">'Magenta'</span>, <span class="st">'Yellow'</span>),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">rgb =</span> <span class="fu">c</span>(<span class="st">'#FF0000'</span>, <span class="st">'#00FF00'</span>, <span class="st">'#0000FF'</span>, <span class="st">'#00FFFF'</span>, <span class="st">'#FF00FF'</span>, <span class="st">'#FFFF00'</span>),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> <span class="fu">c</span>(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>),</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">255</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add CMYK values</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>colors_demo<span class="sc">$</span>cmyk <span class="ot">&lt;-</span> <span class="fu">apply</span>(colors_demo[, <span class="fu">c</span>(<span class="st">'r'</span>, <span class="st">'g'</span>, <span class="st">'b'</span>)], <span class="dv">1</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">rgb_to_cmyk</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>]), <span class="at">collapse=</span><span class="st">','</span>))</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(colors_demo, <span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rgb), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">height =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'RGB: '</span>, rgb, <span class="st">'</span><span class="sc">\n</span><span class="st">CMYK: '</span>, cmyk)),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'RGB to CMYK Conversion'</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'Note: Actual print colors may differ'</span>) <span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">'italic'</span>))</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'rgb_to_cmyk_conversion.png'</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="hsvhsb-hue-saturation-value-brightness" class="level4">
<h4 class="anchored" data-anchor-id="hsvhsb-hue-saturation-value-brightness">HSV/HSB: Hue, Saturation, Value (Brightness)</h4>
<p><strong>Definition:</strong> A more intuitive color model based on human perception.</p>
<p><strong>Components:</strong> - <strong>Hue (H)</strong>: The “pure” color (0-360°) - 0° = Red, 120° = Green, 240° = Blue - Circular: 360° wraps back to red</p>
<ul>
<li><strong>Saturation (S)</strong>: Color intensity (0-100%)
<ul>
<li>0% = Gray (no color)</li>
<li>100% = Pure, vivid color</li>
</ul></li>
<li><strong>Value/Brightness (V)</strong>: Lightness (0-100%)
<ul>
<li>0% = Black</li>
<li>100% = Brightest version of that hue</li>
</ul></li>
</ul>
<p><strong>Advantages:</strong> - <strong>Intuitive</strong>: “I want a light, desaturated blue” → easy to specify - <strong>Easy manipulation</strong>: Adjust brightness without changing hue - <strong>Good for color picking</strong>: Natural way humans think about color</p>
<p><strong>Disadvantages:</strong> - Still not perceptually uniform - Brightness perception varies with hue (yellow appears brighter than blue at same V)</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> hsv_to_rgb</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate Hue variation (S=1, V=1)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>hues <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">12</span>, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, hue <span class="kw">in</span> <span class="bu">enumerate</span>(hues):</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> hsv_to_rgb([hue, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>color)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].add_patch(rect)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].text(i<span class="op">+</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(hue<span class="op">*</span><span class="dv">360</span>)<span class="sc">}</span><span class="ss">°'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">'white'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlim(<span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Hue Variation (Saturation=100%, Value=100%)'</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate Saturation variation (H=0.6 [blue], V=1)</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>saturations <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, sat <span class="kw">in</span> <span class="bu">enumerate</span>(saturations):</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> hsv_to_rgb([<span class="fl">0.6</span>, sat, <span class="fl">1.0</span>])</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>color)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].add_patch(rect)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(i<span class="op">+</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(sat<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">'black'</span> <span class="cf">if</span> sat <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'white'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Saturation Variation (Hue=216°, Value=100%)'</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'HSV Color Model'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'hsv_color_model.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hue variation</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>hue_demo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">hue =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">330</span>, <span class="at">by =</span> <span class="dv">30</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">saturation =</span> <span class="dv">1</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="dv">1</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>hue_demo<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">hsv</span>(hue_demo<span class="sc">$</span>hue<span class="sc">/</span><span class="dv">360</span>, hue_demo<span class="sc">$</span>saturation, hue_demo<span class="sc">$</span>value)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hue_demo, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> color), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(hue, <span class="st">'°'</span>)), <span class="at">color =</span> <span class="st">'white'</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Hue Variation (Saturation=100%, Value=100%)'</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Saturation variation</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>sat_demo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">hue =</span> <span class="fl">0.6</span>,  <span class="co"># Blue</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">saturation =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">10</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="dv">1</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>sat_demo<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">hsv</span>(sat_demo<span class="sc">$</span>hue, sat_demo<span class="sc">$</span>saturation, sat_demo<span class="sc">$</span>value)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>sat_demo<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(sat_demo<span class="sc">$</span>saturation<span class="sc">*</span><span class="dv">100</span>), <span class="st">'%'</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sat_demo, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> color), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">ifelse</span>(sat_demo<span class="sc">$</span>saturation <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="st">'black'</span>, <span class="st">'white'</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Saturation Variation (Hue=216°, Value=100%)'</span>) <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">'HSV Color Model'</span>,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'hsv_color_model.png'</span>, combined, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="cielab-lab-perceptually-uniform" class="level4">
<h4 class="anchored" data-anchor-id="cielab-lab-perceptually-uniform">CIELAB (L*a*b*): Perceptually Uniform</h4>
<p><strong>Definition:</strong> A color space designed to be <strong>perceptually uniform</strong> — equal distances in the space correspond to equal perceived color differences.</p>
<p><strong>Components:</strong> - <strong>L* (Lightness)</strong>: 0 (black) to 100 (white) - <strong>a*</strong>: Green (-) to Red (+) axis - <strong>b*</strong>: Blue (-) to Yellow (+) axis</p>
<p><strong>Why It Matters:</strong></p>
<pre><code>Problem with RGB/HSV:
- RGB(100, 0, 0) → RGB(110, 0, 0): small perceptual change
- RGB(200, 0, 0) → RGB(210, 0, 0): even smaller perceptual change
→ Not uniform!

Solution with CIELAB:
- Moving 10 units in any direction produces approximately equal perceptual change
→ Uniform!</code></pre>
<p><strong>Applications:</strong> - <strong>Designing perceptually uniform colormaps</strong> (e.g., viridis) - <strong>Measuring color similarity</strong> (Delta E metric) - <strong>Quality control in printing</strong> - <strong>Accessible color palette design</strong></p>
<p><strong>When to Use:</strong> - Creating custom sequential colormaps - Ensuring smooth gradients - Comparing colors quantitatively - Accessibility testing</p>
<p><strong>Code Example (Python) - Perceptual Uniformity:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimage <span class="im">import</span> color</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate gradients in RGB and LAB</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB gradient (red to blue)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>rgb_gradient <span class="op">=</span> np.zeros((<span class="dv">1</span>, n_steps, <span class="dv">3</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>rgb_gradient[<span class="dv">0</span>, :, <span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">0</span>, n_steps)  <span class="co"># Red decreases</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>rgb_gradient[<span class="dv">0</span>, :, <span class="dv">2</span>] <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, n_steps)  <span class="co"># Blue increases</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to LAB</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>lab_gradient <span class="op">=</span> color.rgb2lab(rgb_gradient[<span class="dv">0</span>])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate perceptual differences</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>rgb_diffs <span class="op">=</span> np.diff(rgb_gradient[<span class="dv">0</span>], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>rgb_distances <span class="op">=</span> np.linalg.norm(rgb_diffs, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>lab_diffs <span class="op">=</span> np.diff(lab_gradient, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>lab_distances <span class="op">=</span> np.linalg.norm(lab_diffs, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Show gradient</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].imshow(rgb_gradient, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Red to Blue Gradient'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axis(<span class="st">'off'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB distances (non-uniform)</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(rgb_distances, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Step Size (RGB)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'RGB: Non-Uniform Perceptual Steps'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(rgb_distances.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Mean=</span><span class="sc">{</span>rgb_distances<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># LAB distances (more uniform)</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(lab_distances, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'coral'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'Gradient Step'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'Step Size (LAB)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">'LAB: More Uniform Perceptual Steps'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axhline(lab_distances.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Mean=</span><span class="sc">{</span>lab_distances<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].legend()</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'perceptual_uniformity.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create gradients</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>n_steps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB gradient (red to blue)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>red_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="at">length.out =</span> n_steps)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>blue_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n_steps)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>rgb_colors <span class="ot">&lt;-</span> <span class="fu">rgb</span>(red_vals, <span class="dv">0</span>, blue_vals)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to LAB</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>rgb_mat <span class="ot">&lt;-</span> <span class="fu">col2rgb</span>(rgb_colors)<span class="sc">/</span><span class="dv">255</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>lab_colors <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(rgb_mat, <span class="dv">2</span>, <span class="cf">function</span>(x) {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as</span>(<span class="fu">RGB</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>]), <span class="st">"LAB"</span>)<span class="sc">@</span>coords</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate perceptual distances</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>rgb_distances <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diff</span>(red_vals)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">diff</span>(blue_vals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>lab_distances <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">rowSums</span>(<span class="fu">diff</span>(lab_colors)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot gradient</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>grad_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n_steps,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> rgb_colors</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grad_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Red to Blue Gradient'</span>) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB distances</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>rgb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>(n_steps<span class="dv">-1</span>),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance =</span> rgb_distances</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rgb_df, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> distance)) <span class="sc">+</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">'steelblue'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'steelblue'</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(rgb_distances), <span class="at">color =</span> <span class="st">'red'</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> n_steps<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">mean</span>(rgb_distances)<span class="sc">*</span><span class="fl">1.1</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'Mean = '</span>, <span class="fu">round</span>(<span class="fu">mean</span>(rgb_distances), <span class="dv">3</span>)),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>) <span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'RGB: Non-Uniform Perceptual Steps'</span>,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Step Size (RGB)'</span>) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co"># LAB distances</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>lab_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>(n_steps<span class="dv">-1</span>),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance =</span> lab_distances</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lab_df, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> distance)) <span class="sc">+</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">'coral'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'coral'</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(lab_distances), <span class="at">color =</span> <span class="st">'red'</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>             <span class="at">linestyle =</span> <span class="st">'dashed'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> n_steps<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">mean</span>(lab_distances)<span class="sc">*</span><span class="fl">1.1</span>,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'Mean = '</span>, <span class="fu">round</span>(<span class="fu">mean</span>(lab_distances), <span class="dv">1</span>)),</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>) <span class="sc">+</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'LAB: More Uniform Perceptual Steps'</span>,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Gradient Step'</span>, <span class="at">y =</span> <span class="st">'Step Size (LAB)'</span>) <span class="sc">+</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">/</span> p3 <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">'Perceptual Uniformity: RGB vs CIELAB'</span>,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'perceptual_uniformity.png'</span>, combined, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="summary-which-color-space-to-use" class="level3">
<h3 class="anchored" data-anchor-id="summary-which-color-space-to-use">Summary: Which Color Space to Use?</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Task</th>
<th>Best Color Space</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Digital display</strong></td>
<td>RGB</td>
<td>Native to screens</td>
</tr>
<tr class="even">
<td><strong>Print publication</strong></td>
<td>CMYK</td>
<td>Required by printers</td>
</tr>
<tr class="odd">
<td><strong>Color picking/adjustment</strong></td>
<td>HSV</td>
<td>Intuitive manipulation</td>
</tr>
<tr class="even">
<td><strong>Designing gradients</strong></td>
<td>CIELAB</td>
<td>Perceptually uniform</td>
</tr>
<tr class="odd">
<td><strong>Accessibility testing</strong></td>
<td>CIELAB</td>
<td>Quantify perceptual differences</td>
</tr>
<tr class="even">
<td><strong>General programming</strong></td>
<td>RGB or Hex</td>
<td>Simplest, most compatible</td>
</tr>
</tbody>
</table>
<p><strong>Best Practice Workflow:</strong></p>
<pre><code>1. Think in HSV (intuitive)
2. Implement in RGB (compatible)
3. Validate in CIELAB (uniform)
4. Convert to CMYK if printing (required)</code></pre>
<hr>
</section>
<section id="exercise-2.1.1-color-space-exploration" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.1.1-color-space-exploration">Exercise 2.1.1: Color Space Exploration</h3>
<p><strong>Objective:</strong> Experience how different color spaces represent the same color</p>
<p><strong>Task:</strong></p>
<ol type="1">
<li><p><strong>Pick a color</strong> from a published figure you admire</p></li>
<li><p><strong>Convert it across spaces:</strong></p>
<ul>
<li>Use a color picker to get RGB values</li>
<li>Convert to HSV: <a href="https://www.rapidtables.com/convert/color/rgb-to-hsv.html">https://www.rapidtables.com/convert/color/rgb-to-hsv.html</a></li>
<li>Convert to CIELAB: <a href="https://colormine.org/convert/rgb-to-lab">https://colormine.org/convert/rgb-to-lab</a></li>
<li>Convert to CMYK: <a href="https://www.rapidtables.com/convert/color/rgb-to-cmyk.html">https://www.rapidtables.com/convert/color/rgb-to-cmyk.html</a></li>
</ul></li>
<li><p><strong>Document:</strong></p>
<pre><code></code></pre></li>
<li><p><strong>Reflection:</strong></p>
<ul>
<li>Which representation is most intuitive to you?</li>
<li>If you wanted a “lighter version” of this color, which space makes that easiest?</li>
<li>How much does CMYK shift from RGB? (Compare visually)</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="choosing-color-palettes" class="level2">
<h2 class="anchored" data-anchor-id="choosing-color-palettes">2.2 Choosing Color Palettes</h2>
<p>Now that we understand color spaces, let’s apply them to the most critical decision: <strong>choosing appropriate color palettes</strong> for different types of data.</p>
<section id="the-three-palette-types" class="level3">
<h3 class="anchored" data-anchor-id="the-three-palette-types">The Three Palette Types</h3>
<p>Every color palette falls into one of three categories, each suited to different data types:</p>
<section id="sequential-palettes-quantitative-ordered-data" class="level4">
<h4 class="anchored" data-anchor-id="sequential-palettes-quantitative-ordered-data">1. Sequential Palettes (Quantitative, Ordered Data)</h4>
<p><strong>Use for:</strong> - Continuous numerical data - Ordered categories (mild → moderate → severe) - Any data with a natural progression</p>
<p><strong>Characteristics:</strong> - <strong>Single hue</strong> varying in lightness/saturation - <strong>Clear directionality</strong> (low → high) - <strong>Perceptually ordered</strong> (darker = more)</p>
<p><strong>Examples:</strong></p>
<pre><code>Good Sequential Palettes:
✓ Light Blue → Dark Blue
✓ White → Red
✓ Light Gray → Black
✓ Viridis (yellow → blue, perceptually uniform)</code></pre>
<p><strong>Bad Sequential Palettes:</strong></p>
<pre><code>✗ Rainbow (red → orange → yellow → green → blue → purple)
  → No inherent ordering
  → Perceptual non-uniformity

✗ Random hues (blue → pink → orange)
  → Implies categorical data, not continuous</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data (heatmap)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>).cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Good sequential palettes</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>palettes <span class="op">=</span> [</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Blues'</span>, <span class="st">'Good: Single Hue (Blue)'</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'YlOrRd'</span>, <span class="st">'Good: Yellow-Orange-Red'</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'viridis'</span>, <span class="st">'Good: Viridis (Perceptually Uniform)'</span>),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'jet'</span>, <span class="st">'BAD: Rainbow (No Order)'</span>),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Set3'</span>, <span class="st">'BAD: Qualitative (Wrong Type)'</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'RdYlGn'</span>, <span class="st">'ACCEPTABLE: Diverging (If Zero is Meaningful)'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (cmap, title) <span class="kw">in</span> <span class="bu">zip</span>(axes.flat, palettes):</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    im <span class="op">=</span> ax.imshow(data, cmap<span class="op">=</span>cmap, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    ax.set_title(title, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'green'</span> <span class="cf">if</span> <span class="st">'Good'</span> <span class="kw">in</span> title <span class="cf">else</span> <span class="st">'red'</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    ax.axis(<span class="st">'off'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(im, ax<span class="op">=</span>ax, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Sequential Palettes: Good vs Bad'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'sequential_palettes.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)), <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(data_matrix)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to create heatmap</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>create_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, palette, title, quality) {</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span>palette) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span>title) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color=</span><span class="fu">ifelse</span>(quality<span class="sc">==</span><span class="st">'good'</span>, <span class="st">'darkgreen'</span>, <span class="st">'red'</span>)),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="st">'bottom'</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key.width=</span><span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">'cm'</span>),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key.height=</span><span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">'cm'</span>))</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Good sequential palettes</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">'Blues'</span>),</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Good: Single Hue (Blue)'</span>, <span class="st">'good'</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">'YlOrRd'</span>),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Good: Yellow-Orange-Red'</span>, <span class="st">'good'</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">viridis</span>(<span class="dv">100</span>),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Good: Viridis (Perceptually Uniform)'</span>, <span class="st">'good'</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad sequential palettes</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">rainbow</span>(<span class="dv">100</span>),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'BAD: Rainbow (No Order)'</span>, <span class="st">'bad'</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">'Set3'</span>),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'BAD: Qualitative (Wrong Type)'</span>, <span class="st">'bad'</span>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(data_long, <span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">'RdYlGn'</span>),</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'ACCEPTABLE: Diverging (If Zero Meaningful)'</span>, <span class="st">'acceptable'</span>)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> (p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">/</span> (p4 <span class="sc">|</span> p5 <span class="sc">|</span> p6) <span class="sc">+</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Sequential Palettes: Good vs Bad'</span>,</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'sequential_palettes.png'</span>, combined, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="diverging-palettes-data-with-meaningful-midpoint" class="level4">
<h4 class="anchored" data-anchor-id="diverging-palettes-data-with-meaningful-midpoint">2. Diverging Palettes (Data with Meaningful Midpoint)</h4>
<p><strong>Use for:</strong> - Data with a <strong>critical central value</strong> (zero, neutral, baseline) - Deviations in two directions (positive/negative, above/below average) - Comparisons showing increase vs.&nbsp;decrease</p>
<p><strong>Characteristics:</strong> - <strong>Two contrasting hues</strong> at extremes - <strong>Neutral color</strong> (white, gray, beige) at center - <strong>Symmetric intensity</strong> increasing toward both ends</p>
<p><strong>Examples:</strong></p>
<pre><code>Good Diverging Palettes:
✓ Blue ← White → Red (cold/hot, negative/positive)
✓ Green ← Beige → Purple (gene downregulation/upregulation)
✓ RdBu (Red-Blue, colorblind-safe)</code></pre>
<p><strong>When NOT to Use:</strong></p>
<pre><code>✗ Data without a meaningful center point
  Example: Temperature in Kelvin (0K is absolute, not "neutral")

✗ Data that's inherently one-directional
  Example: Age (0-100, no negative ages)</code></pre>
<p><strong>Real-World Example:</strong></p>
<pre><code>Gene expression fold-change:
- Values: -5 to +5
- Center: 0 (no change)
- Negative: Downregulated (blue)
- Positive: Upregulated (red)
→ Perfect for diverging palette</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate diverging data (centered at zero)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>data_diverging <span class="op">=</span> np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>) <span class="op">*</span> <span class="dv">2</span>  <span class="co"># Mean=0, symmetric</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">4</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Good diverging palettes</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>palettes_div <span class="op">=</span> [</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'RdBu_r'</span>, <span class="st">'Good: Red-Blue (Symmetric)'</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'PiYG'</span>, <span class="st">'Good: Pink-Green (Colorblind-Safe)'</span>),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'coolwarm'</span>, <span class="st">'Good: Cool-Warm'</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, (cmap, title) <span class="kw">in</span> <span class="bu">zip</span>(axes.flat, palettes_div):</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set symmetric limits around zero</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    vmax <span class="op">=</span> np.<span class="bu">abs</span>(data_diverging).<span class="bu">max</span>()</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    im <span class="op">=</span> ax.imshow(data_diverging, cmap<span class="op">=</span>cmap, aspect<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                   vmin<span class="op">=-</span>vmax, vmax<span class="op">=</span>vmax)  <span class="co"># Critical: symmetric limits</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    ax.set_title(title, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    ax.axis(<span class="st">'off'</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Colorbar with zero highlighted</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>ax, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    cbar.ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Highlight zero</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Diverging Palettes: Critical Zero Point'</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'diverging_palettes.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate diverging data</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>data_div <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">*</span> <span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>data_long_div <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>data_long_div<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(data_div)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for diverging heatmap</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>create_div_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, palette_name, title) {</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get symmetric limits</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  max_abs <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(data<span class="sc">$</span>value))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, palette_name),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span>max_abs, max_abs)) <span class="sc">+</span>  <span class="co"># Symmetric limits</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span>title) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="st">'bottom'</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key.width=</span><span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">'cm'</span>),</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key.height=</span><span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">'cm'</span>)) <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Highlight zero in legend</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">'black'</span>, <span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_div_heatmap</span>(data_long_div, <span class="st">'RdBu'</span>, <span class="st">'Good: Red-Blue (Symmetric)'</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_div_heatmap</span>(data_long_div, <span class="st">'PiYG'</span>, <span class="st">'Good: Pink-Green (Colorblind-Safe)'</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">create_div_heatmap</span>(data_long_div, <span class="st">'BrBG'</span>, <span class="st">'Good: Brown-Blue-Green'</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> combined <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">'Diverging Palettes: Critical Zero Point'</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'diverging_palettes.png'</span>, combined, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="qualitative-palettes-categorical-data" class="level4">
<h4 class="anchored" data-anchor-id="qualitative-palettes-categorical-data">3. Qualitative Palettes (Categorical Data)</h4>
<p><strong>Use for:</strong> - <strong>Unordered categories</strong> (species, treatments, locations) - <strong>Nominal data</strong> (no inherent ordering) - <strong>Group comparisons</strong> (control vs.&nbsp;experimental groups)</p>
<p><strong>Characteristics:</strong> - <strong>Distinct hues</strong> (maximally different colors) - <strong>Similar lightness</strong> (no implied hierarchy) - <strong>Visually balanced</strong> (no one color dominates)</p>
<p><strong>Rules:</strong></p>
<pre><code>✓ Limit to 6-8 categories maximum
  → Beyond this, colors become too similar

✓ Use colorblind-safe combinations
  → Avoid red-green only distinctions

✓ Consider adding shape/line style redundancy
  → Ensures accessibility</code></pre>
<p><strong>Good Qualitative Palettes:</strong></p>
<pre><code>✓ ColorBrewer 'Set2' (8 colors, colorblind-friendly)
✓ ColorBrewer 'Dark2' (8 colors, good contrast)
✓ Okabe-Ito palette (8 colors, designed for colorblindness)
✓ Custom palettes from your field's conventions</code></pre>
<p><strong>Bad Qualitative Palettes:</strong></p>
<pre><code>✗ Rainbow (implies ordering that doesn't exist)
✗ Sequential palette (Blues) for categories (implies hierarchy)
✗ Too many similar colors (light blue, medium blue, cyan, teal...)</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample categorical data</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Group A'</span>, <span class="st">'Group B'</span>, <span class="st">'Group C'</span>, <span class="st">'Group D'</span>, <span class="st">'Group E'</span>]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.repeat(np.arange(<span class="dv">50</span>), <span class="bu">len</span>(categories))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.tile(np.arange(<span class="bu">len</span>(categories)), <span class="dv">50</span>) <span class="op">+</span> np.random.randn(<span class="bu">len</span>(categories)<span class="op">*</span><span class="dv">50</span>)<span class="op">*</span><span class="fl">0.3</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>category <span class="op">=</span> np.tile(categories, <span class="dv">50</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Good qualitative palette (Okabe-Ito, colorblind-safe)</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>okabe_ito <span class="op">=</span> [<span class="st">'#E69F00'</span>, <span class="st">'#56B4E9'</span>, <span class="st">'#009E73'</span>, <span class="st">'#F0E442'</span>, <span class="st">'#0072B2'</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>             <span class="st">'#D55E00'</span>, <span class="st">'#CC79A7'</span>, <span class="st">'#000000'</span>]</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].scatter(x, y, c<span class="op">=</span>[okabe_ito[i<span class="op">%</span><span class="dv">8</span>] <span class="cf">for</span> i, _ <span class="kw">in</span> <span class="bu">enumerate</span>(category)],</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'GOOD: Okabe-Ito Palette</span><span class="ch">\n</span><span class="st">(Colorblind-Safe, Distinct Hues)'</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'X Variable'</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Y Variable'</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Good: ColorBrewer Set2</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>set2_colors <span class="op">=</span> sns.color_palette(<span class="st">'Set2'</span>, <span class="bu">len</span>(categories))</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(categories):</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.array(category) <span class="op">==</span> cat</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].scatter(x[mask], y[mask], color<span class="op">=</span>set2_colors[i],</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>                       label<span class="op">=</span>cat, alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'GOOD: ColorBrewer Set2</span><span class="ch">\n</span><span class="st">(Balanced, Distinct)'</span>,</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'X Variable'</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Y Variable'</span>)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad: Rainbow (implies false ordering)</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>rainbow_colors <span class="op">=</span> plt.cm.rainbow(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(categories)))</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(categories):</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.array(category) <span class="op">==</span> cat</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].scatter(x[mask], y[mask], color<span class="op">=</span>rainbow_colors[i],</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>                       label<span class="op">=</span>cat, alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'BAD: Rainbow</span><span class="ch">\n</span><span class="st">(Implies Ordering, Not Colorblind-Safe)'</span>,</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].legend(loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'X Variable'</span>)</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Y Variable'</span>)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad: Too similar colors (all blues)</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>blues_colors <span class="op">=</span> plt.cm.Blues(np.linspace(<span class="fl">0.3</span>, <span class="fl">0.9</span>, <span class="bu">len</span>(categories)))</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(categories):</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.array(category) <span class="op">==</span> cat</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].scatter(x[mask], y[mask], color<span class="op">=</span>blues_colors[i],</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>                       label<span class="op">=</span>cat, alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'BAD: Sequential for Categorical</span><span class="ch">\n</span><span class="st">(Similar Colors, Implies Hierarchy)'</span>,</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>                     fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].legend(loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'X Variable'</span>)</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Y Variable'</span>)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Qualitative Palettes: Good vs Bad'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'qualitative_palettes.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample categorical data</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Group A'</span>, <span class="st">'Group B'</span>, <span class="st">'Group C'</span>, <span class="st">'Group D'</span>, <span class="st">'Group E'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>data_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_per_group, <span class="at">each=</span><span class="fu">length</span>(categories)),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(categories), n_per_group) <span class="sc">+</span> <span class="fu">rnorm</span>(n_per_group<span class="sc">*</span><span class="fu">length</span>(categories), <span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">rep</span>(categories, n_per_group)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colorblind-safe palette</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>okabe_ito <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#E69F00'</span>, <span class="st">'#56B4E9'</span>, <span class="st">'#009E73'</span>, <span class="st">'#F0E442'</span>, <span class="st">'#0072B2'</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">'#D55E00'</span>, <span class="st">'#CC79A7'</span>, <span class="st">'#000000'</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Good: Okabe-Ito</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_cat, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>category)) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>okabe_ito[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(categories)]) <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'GOOD: Okabe-Ito Palette</span><span class="sc">\n</span><span class="st">(Colorblind-Safe, Distinct Hues)'</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'X Variable'</span>, <span class="at">y=</span><span class="st">'Y Variable'</span>) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">color=</span><span class="st">'darkgreen'</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'right'</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Good: ColorBrewer Set2</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_cat, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>category)) <span class="sc">+</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">'Set2'</span>) <span class="sc">+</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'GOOD: ColorBrewer Set2</span><span class="sc">\n</span><span class="st">(Balanced, Distinct)'</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'X Variable'</span>, <span class="at">y=</span><span class="st">'Y Variable'</span>) <span class="sc">+</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">color=</span><span class="st">'darkgreen'</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'right'</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad: Rainbow</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_cat, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>category)) <span class="sc">+</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rainbow</span>(<span class="fu">length</span>(categories))) <span class="sc">+</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'BAD: Rainbow</span><span class="sc">\n</span><span class="st">(Implies Ordering, Not Colorblind-Safe)'</span>,</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'X Variable'</span>, <span class="at">y=</span><span class="st">'Y Variable'</span>) <span class="sc">+</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">color=</span><span class="st">'red'</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'right'</span>)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad: Sequential (Blues) for categorical</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_cat, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>category)) <span class="sc">+</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">'Blues'</span>) <span class="sc">+</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'BAD: Sequential for Categorical</span><span class="sc">\n</span><span class="st">(Similar Colors, Implies Hierarchy)'</span>,</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">'X Variable'</span>, <span class="at">y=</span><span class="st">'Y Variable'</span>) <span class="sc">+</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">color=</span><span class="st">'red'</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'right'</span>)</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> (p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">'Qualitative Palettes: Good vs Bad'</span>,</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'qualitative_palettes.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="palette-selection-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="palette-selection-decision-tree">Palette Selection Decision Tree</h3>
<pre><code>START: What type of data do I have?

├─ QUANTITATIVE/CONTINUOUS
│   ├─ Has meaningful midpoint (zero, baseline)?
│   │   └─ YES → DIVERGING PALETTE
│   │       Examples: RdBu, PiYG, BrBG
│   │
│   └─ NO → SEQUENTIAL PALETTE
│       Examples: Blues, Viridis, YlOrRd
│
└─ CATEGORICAL/NOMINAL
    ├─ Ordered categories (mild/moderate/severe)?
    │   └─ YES → SEQUENTIAL PALETTE
    │       (Treat as ordinal data)
    │
    └─ NO → QUALITATIVE PALETTE
        Examples: Set2, Dark2, Okabe-Ito

        Special consideration:
        - If &gt;8 categories → Consider splitting figure
        - Always check colorblind simulation
        - Add shape/line redundancy</code></pre>
<hr>
</section>
<section id="exercise-2.2.1-palette-type-classification" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.2.1-palette-type-classification">Exercise 2.2.1: Palette Type Classification</h3>
<p><strong>Objective:</strong> Practice identifying appropriate palette types</p>
<p><strong>Instructions:</strong></p>
<p>For each dataset below, identify: 1. Data type (quantitative continuous, ordinal, nominal) 2. Appropriate palette type (sequential, diverging, qualitative) 3. Specific palette recommendation 4. Why alternatives would be wrong</p>
<p><strong>Datasets:</strong></p>
<p><strong>A. Temperature anomaly</strong> (deviation from 20th century average) - Values: -2°C to +2°C - Represents: Climate change warming/cooling</p>
<p><strong>B. Species distribution</strong> across 5 habitat types - Categories: Forest, Grassland, Desert, Wetland, Tundra - No inherent ordering</p>
<p><strong>C. Disease progression</strong> stages - Categories: Healthy, At-risk, Early disease, Advanced disease - Clear progression</p>
<p><strong>D. Population density</strong> (people per km²) - Values: 0 to 10,000 - All positive, no meaningful center</p>
<p><strong>E. Stock price change</strong> (% change from yesterday) - Values: -15% to +15% - Zero = no change</p>
<p><strong>Your answers should look like:</strong></p>
<pre><code>Dataset A:
- Data type: Quantitative continuous with meaningful zero
- Palette type: Diverging
- Recommendation: RdBu_r (blue=cooling, red=warming)
- Why not sequential: Would lose critical distinction between warming/cooling
- Why not qualitative: Data is continuous, not categorical</code></pre>
<hr>
<hr>
</section>
</section>
<section id="light-vs.-dark-background" class="level2">
<h2 class="anchored" data-anchor-id="light-vs.-dark-background">2.3 Light vs.&nbsp;Dark Background</h2>
<section id="the-context-driven-choice" class="level3">
<h3 class="anchored" data-anchor-id="the-context-driven-choice">The Context-Driven Choice</h3>
<p>The choice between light and dark themes isn’t about personal preference—it’s about <strong>medium, venue, and function</strong>. Scientific publications have specific requirements, and understanding when each theme is appropriate is crucial for effective communication.</p>
</section>
<section id="publication-standard-light-backgrounds-default" class="level3">
<h3 class="anchored" data-anchor-id="publication-standard-light-backgrounds-default">Publication Standard: Light Backgrounds (Default)</h3>
<p><strong>Why light themes dominate scientific literature:</strong></p>
<ol type="1">
<li><strong>Print legacy</strong>: Scientific journals evolved from print media where:
<ul>
<li>Black ink on white paper is most economical</li>
<li>High contrast ensures legibility</li>
<li>Grayscale reproduction is reliable</li>
</ul></li>
<li><strong>Reading comprehension</strong>: Studies show:
<ul>
<li>Dark text on light backgrounds reduces eye strain for extended reading</li>
<li>Better for detailed analysis and data interpretation</li>
<li>Maintains performance across various lighting conditions</li>
</ul></li>
<li><strong>Journal requirements</strong>: Most high-impact journals explicitly require:
<ul>
<li>White or light gray backgrounds</li>
<li>Black text and axis lines</li>
<li>Conservative, professional appearance</li>
</ul></li>
</ol>
<p><strong>Standard Scientific Figure Format:</strong></p>
<pre><code>✓ White background
✓ Black or dark gray text
✓ Colored data elements (but limited palette)
✓ Light gray gridlines (if used)
✓ Clean, minimal aesthetic</code></pre>
<hr>
</section>
<section id="when-dark-themes-are-appropriate" class="level3">
<h3 class="anchored" data-anchor-id="when-dark-themes-are-appropriate">When Dark Themes Are Appropriate</h3>
<p><strong>Acceptable Use Cases:</strong></p>
<p><strong>1. Presentations and Posters</strong></p>
<pre><code>Why it works:
- Projected in dark/dim rooms
- High contrast improves visibility from distance
- More dramatic visual impact
- Reduces screen glare

Requirements:
- Still maintain high contrast
- Use lighter text colors
- Test in actual presentation conditions</code></pre>
<p><strong>2. Supplementary Digital Materials</strong></p>
<pre><code>Why it works:
- Interactive web-based figures
- Video presentations
- Screen-based analysis tools

Requirements:
- Provide light theme alternative
- Ensure all elements remain visible
- Test on multiple devices</code></pre>
<p><strong>3. Specific Data Visualization Contexts</strong></p>
<pre><code>Astronomical imaging: Stars on black sky (natural representation)
Fluorescence microscopy: Bright signals on dark background (matches actual imaging)
Network visualizations: Sometimes clearer on dark backgrounds

But even here: Consider converting to light theme for publication</code></pre>
<hr>
</section>
<section id="the-color-restraint-principle-for-publications" class="level3">
<h3 class="anchored" data-anchor-id="the-color-restraint-principle-for-publications">The Color Restraint Principle for Publications</h3>
<p><strong>Critical Rule: Use color sparingly and purposefully</strong></p>
<p>In scientific publications, every color must have a <strong>functional reason</strong>, not merely aesthetic appeal. This principle stems from:</p>
<ol type="1">
<li><strong>Cognitive load</strong>: Too many colors overwhelm readers</li>
<li><strong>Reproducibility</strong>: Simpler color schemes are easier to recreate</li>
<li><strong>Accessibility</strong>: Fewer colors reduce colorblind accessibility issues</li>
<li><strong>Professional standards</strong>: Conservative color use signals scientific rigor</li>
<li><strong>Print costs</strong>: Historically, color pages cost more (legacy influence)</li>
</ol>
<hr>
</section>
<section id="the-3-color-rule-for-scientific-figures" class="level3">
<h3 class="anchored" data-anchor-id="the-3-color-rule-for-scientific-figures">The “3-Color Rule” for Scientific Figures</h3>
<p><strong>Guideline: Aim for 3 colors maximum per figure (excluding grayscale)</strong></p>
<p><strong>Why this works:</strong></p>
<p><strong>Example: Treatment Comparison Figure</strong></p>
<pre><code>✓ GOOD (3 colors):
  - Control group: Gray (#808080)
  - Treatment A: Blue (#2E86AB)
  - Treatment B: Red (#A23B72)
  - Background: White
  - Text/axes: Black
  - Gridlines: Light gray (#D3D3D3)

→ Clear, distinct, professional
→ Easy to distinguish in legend
→ Works in grayscale (shades differ)</code></pre>
<p><strong>Bad Example: Color Overload</strong></p>
<pre><code>✗ BAD (8+ colors):
  - 8 different treatment groups in rainbow colors
  - Multiple colored gridlines
  - Colored background
  - Multicolored title

→ Visually chaotic
→ Hard to match legend to data
→ Loses impact of individual colors</code></pre>
<hr>
</section>
<section id="logical-color-schemes-semantic-consistency" class="level3">
<h3 class="anchored" data-anchor-id="logical-color-schemes-semantic-consistency">Logical Color Schemes: Semantic Consistency</h3>
<p><strong>Colors should carry semantic meaning consistently across your entire manuscript</strong></p>
<p><strong>Principle: Same concept = Same color throughout all figures</strong></p>
<p><strong>Example Consistency Rules:</strong></p>
<p><strong>Temperature-related data:</strong></p>
<pre><code>✓ Consistent across all figures:
  - Cold/low temperature: Blue (#3498DB)
  - Hot/high temperature: Red (#E74C3C)
  - Neutral: Gray (#95A5A6)

✗ Inconsistent (confusing):
  - Figure 1: Cold=Blue, Hot=Red
  - Figure 2: Cold=Green, Hot=Orange
  - Figure 3: Cold=Purple, Hot=Yellow
→ Reader must relearn color meaning each time</code></pre>
<p><strong>Biological example:</strong></p>
<pre><code>Consistent color scheme for cell types across all figures:
  - Neurons: Purple (#9B59B6)
  - Astrocytes: Green (#27AE60)
  - Microglia: Orange (#E67E22)

Applied to:
  - Figure 1: Immunohistochemistry images
  - Figure 2: Flow cytometry plots
  - Figure 3: Gene expression heatmaps
  - Figure 4: Quantification bar charts

→ Immediate recognition, reduced cognitive load</code></pre>
<hr>
</section>
<section id="field-specific-color-conventions" class="level3">
<h3 class="anchored" data-anchor-id="field-specific-color-conventions">Field-Specific Color Conventions</h3>
<p><strong>Many scientific fields have established color conventions—follow them unless you have strong justification</strong></p>
<p><strong>Molecular Biology:</strong></p>
<pre><code>- DNA: Blue
- RNA: Red
- Protein: Green or purple
- Upregulated genes: Red
- Downregulated genes: Blue/green</code></pre>
<p><strong>Neuroscience:</strong></p>
<pre><code>- Excitatory neurons: Red
- Inhibitory neurons: Blue
- Dendrites: Green
- Axons: Red or blue</code></pre>
<p><strong>Climate Science:</strong></p>
<pre><code>- Warming: Red/orange
- Cooling: Blue
- Land: Brown/green
- Water: Blue</code></pre>
<p><strong>Medical Imaging:</strong></p>
<pre><code>- PET scans: Rainbow (hot) scale
- MRI: Grayscale
- Functional activation: Hot colors on grayscale</code></pre>
<p><strong>Respecting conventions:</strong></p>
<pre><code>✓ Advantages:
  - Immediate interpretation by experts
  - Consistent with literature
  - Reduces confusion

✗ Breaking conventions:
  - Only if you have strong perceptual/accessibility reason
  - Must explain explicitly in caption
  - Risk confusing your audience</code></pre>
<hr>
</section>
<section id="code-examples-light-theme-with-minimal-color" class="level3">
<h3 class="anchored" data-anchor-id="code-examples-light-theme-with-minimal-color">Code Examples: Light Theme with Minimal Color</h3>
<p><strong>Python Example: Publication-Ready Light Theme</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set publication-ready style</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'seaborn-v0_8-whitegrid'</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">'Arial'</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">10</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: <span class="dv">11</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="dv">12</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelweight'</span>: <span class="st">'bold'</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: <span class="dv">9</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: <span class="dv">9</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.fontsize'</span>: <span class="dv">9</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.titlesize'</span>: <span class="dv">14</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.facecolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.facecolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.edgecolor'</span>: <span class="st">'#333333'</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.linewidth'</span>: <span class="fl">1.2</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.color'</span>: <span class="st">'#D3D3D3'</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.linewidth'</span>: <span class="fl">0.8</span>,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.alpha'</span>: <span class="fl">0.5</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data (treatment comparison)</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">1</span>)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>control <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>treatment_a <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>treatment_b <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.0</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Define consistent color palette (3 colors only)</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>COLOR_CONTROL <span class="op">=</span> <span class="st">'#808080'</span>      <span class="co"># Gray</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_A <span class="op">=</span> <span class="st">'#2E86AB'</span>  <span class="co"># Blue</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_B <span class="op">=</span> <span class="st">'#A23B72'</span>  <span class="co"># Purple-red</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="fl">4.5</span>))</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data with ONLY 3 colors</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>ax.plot(time, control, color<span class="op">=</span>COLOR_CONTROL, linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Control'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">4</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>ax.plot(time, treatment_a, color<span class="op">=</span>COLOR_TREATMENT_A, linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Treatment A'</span>, marker<span class="op">=</span><span class="st">'s'</span>, markersize<span class="op">=</span><span class="dv">4</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>ax.plot(time, treatment_b, color<span class="op">=</span>COLOR_TREATMENT_B, linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Treatment B'</span>, marker<span class="op">=</span><span class="st">'^'</span>, markersize<span class="op">=</span><span class="dv">4</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal, functional styling</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time (hours)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Cell Viability (%)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Effect of Treatments on Cell Viability'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend: simple, unobtrusive</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, facecolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>          edgecolor<span class="op">=</span><span class="st">'#333333'</span>, framealpha<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove top and right spines (cleaner look)</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtle gridlines (not distracting)</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.7</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'light_theme_minimal_color.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Figure saved with:"</span>)</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Background: White"</span>)</span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Colors used: 3 (Gray, Blue, Purple-red)"</span>)</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Text: Black"</span>)</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Grid: Light gray, subtle"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>R Example: Publication-Ready Light Theme</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time, <span class="dv">3</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">viability =</span> <span class="fu">c</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="dv">0</span>, <span class="dv">2</span>)),           <span class="co"># Control</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.5</span>, <span class="dv">2</span>)),         <span class="co"># Treatment A</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.0</span>, <span class="dv">2</span>))          <span class="co"># Treatment B</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>), <span class="at">each=</span><span class="fu">length</span>(time))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Consistent color palette (3 colors only)</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>COLOR_CONTROL <span class="ot">&lt;-</span> <span class="st">'#808080'</span>      <span class="co"># Gray</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_A <span class="ot">&lt;-</span> <span class="st">'#2E86AB'</span>  <span class="co"># Blue</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_B <span class="ot">&lt;-</span> <span class="st">'#A23B72'</span>  <span class="co"># Purple-red</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>colors_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Control'</span> <span class="ot">=</span> COLOR_CONTROL,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Treatment A'</span> <span class="ot">=</span> COLOR_TREATMENT_A,</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Treatment B'</span> <span class="ot">=</span> COLOR_TREATMENT_B)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create publication-ready plot</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> viability, <span class="at">color =</span> group, <span class="at">shape =</span> group)) <span class="sc">+</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">+</span>  <span class="co"># Every 3rd point</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply color palette</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors_palette) <span class="sc">+</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">17</span>)) <span class="sc">+</span>  <span class="co"># Circle, square, triangle</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Time (hours)'</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Cell Viability (%)'</span>,</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Effect of Treatments on Cell Viability'</span>,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="cn">NULL</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme: clean, light background</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>, <span class="at">base_family =</span> <span class="st">'Arial'</span>) <span class="sc">+</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># White background (publication standard)</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subtle grid</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'#D3D3D3'</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>),</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bold axis labels</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">'#333333'</span>),</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legend: simple, unobtrusive</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'#333333'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>),</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>),</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove top/right borders</span></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'#333333'</span>, <span class="at">size =</span> <span class="fl">0.7</span>),</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>()</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Save</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'light_theme_minimal_color.png'</span>, p, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="fl">4.5</span>,</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Figure saved with:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Background: White</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Colors used: 3 (Gray, Blue, Purple-red)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Text: Black</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - Grid: Light gray, subtle</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="dark-theme-when-and-how-presentations-only" class="level3">
<h3 class="anchored" data-anchor-id="dark-theme-when-and-how-presentations-only">Dark Theme: When and How (Presentations Only)</h3>
<p><strong>Python Example: Dark Theme for Presentation</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dark theme settings (for presentations ONLY)</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'dark_background'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">'Arial'</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">12</span>,  <span class="co"># Larger for visibility</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.facecolor'</span>: <span class="st">'#1E1E1E'</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.facecolor'</span>: <span class="st">'#1E1E1E'</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.edgecolor'</span>: <span class="st">'#CCCCCC'</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'text.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelcolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.color'</span>: <span class="st">'#444444'</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.alpha'</span>: <span class="fl">0.5</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Same data as before</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">1</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>control <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>treatment_a <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>treatment_b <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.0</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># LIGHTER colors for dark background (higher saturation/brightness)</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>COLOR_CONTROL_DARK <span class="op">=</span> <span class="st">'#B0B0B0'</span>      <span class="co"># Light gray</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_A_DARK <span class="op">=</span> <span class="st">'#5DADE2'</span>  <span class="co"># Light blue</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_B_DARK <span class="op">=</span> <span class="st">'#EC7063'</span>  <span class="co"># Light red</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))  <span class="co"># Larger for presentations</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>ax.plot(time, control, color<span class="op">=</span>COLOR_CONTROL_DARK, linewidth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Control'</span>, marker<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">6</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>ax.plot(time, treatment_a, color<span class="op">=</span>COLOR_TREATMENT_A_DARK, linewidth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Treatment A'</span>, marker<span class="op">=</span><span class="st">'s'</span>, markersize<span class="op">=</span><span class="dv">6</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>ax.plot(time, treatment_b, color<span class="op">=</span>COLOR_TREATMENT_B_DARK, linewidth<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Treatment B'</span>, marker<span class="op">=</span><span class="st">'^'</span>, markersize<span class="op">=</span><span class="dv">6</span>, markevery<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time (hours)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Cell Viability (%)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Effect of Treatments on Cell Viability</span><span class="ch">\n</span><span class="st">(Presentation Version)'</span>,</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>             fontweight<span class="op">=</span><span class="st">'bold'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'white'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, frameon<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>          facecolor<span class="op">=</span><span class="st">'#2C2C2C'</span>, edgecolor<span class="op">=</span><span class="st">'#CCCCCC'</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'dark_theme_presentation.png'</span>, dpi<span class="op">=</span><span class="dv">150</span>,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'#1E1E1E'</span>)</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dark theme figure (PRESENTATION ONLY) saved"</span>)</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Note: Convert to light theme for publication submission"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>R Example: Dark Theme for Presentation</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Same data</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time, <span class="dv">3</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">viability =</span> <span class="fu">c</span>(</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="dv">0</span>, <span class="dv">2</span>)),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.5</span>, <span class="dv">2</span>)),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.0</span>, <span class="dv">2</span>))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>), <span class="at">each=</span><span class="fu">length</span>(time))</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Lighter colors for dark background</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>COLOR_CONTROL_DARK <span class="ot">&lt;-</span> <span class="st">'#B0B0B0'</span>      <span class="co"># Light gray</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_A_DARK <span class="ot">&lt;-</span> <span class="st">'#5DADE2'</span>  <span class="co"># Light blue</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>COLOR_TREATMENT_B_DARK <span class="ot">&lt;-</span> <span class="st">'#EC7063'</span>  <span class="co"># Light red</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>colors_dark <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Control'</span> <span class="ot">=</span> COLOR_CONTROL_DARK,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Treatment A'</span> <span class="ot">=</span> COLOR_TREATMENT_A_DARK,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Treatment B'</span> <span class="ot">=</span> COLOR_TREATMENT_B_DARK)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Dark theme plot</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>p_dark <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> viability, <span class="at">color =</span> group, <span class="at">shape =</span> group)) <span class="sc">+</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">%%</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors_dark) <span class="sc">+</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Time (hours)'</span>,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Cell Viability (%)'</span>,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Effect of Treatments on Cell Viability</span><span class="sc">\n</span><span class="st">(Presentation Version)'</span>,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NULL</span>,</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="cn">NULL</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dark theme</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>, <span class="at">base_family =</span> <span class="st">'Arial'</span>) <span class="sc">+</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dark background</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#1E1E1E'</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#1E1E1E'</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Light text</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>),</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subtle grid</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'#444444'</span>, <span class="at">size =</span> <span class="fl">0.4</span>),</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legend</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#2C2C2C'</span>, <span class="at">color =</span> <span class="st">'#CCCCCC'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#2C2C2C'</span>)</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'dark_theme_presentation.png'</span>, p_dark, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">150</span>, <span class="at">bg =</span> <span class="st">'#1E1E1E'</span>)</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dark theme figure (PRESENTATION ONLY) saved</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Note: Convert to light theme for publication submission</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="publication-submission-checklist-color-theme" class="level3">
<h3 class="anchored" data-anchor-id="publication-submission-checklist-color-theme">Publication Submission Checklist: Color &amp; Theme</h3>
<p><strong>Before submitting your manuscript, verify:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>Background is white or light gray</strong> (not dark)</label></li>
<li><label><input type="checkbox"><strong>Maximum 3-4 distinct colors</strong> per figure (excluding grayscale)</label></li>
<li><label><input type="checkbox"><strong>Color consistency</strong> across all figures (same concept = same color)</label></li>
<li><label><input type="checkbox"><strong>Semantic logic</strong> (colors match intuitive meanings)</label></li>
<li><label><input type="checkbox"><strong>Field conventions respected</strong> (unless explicitly justified)</label></li>
<li><label><input type="checkbox"><strong>Text is black</strong> or very dark gray (#333333)</label></li>
<li><label><input type="checkbox"><strong>Gridlines are subtle</strong> (light gray, thin, low opacity)</label></li>
<li><label><input type="checkbox"><strong>No decorative colors</strong> (every color has functional purpose)</label></li>
<li><label><input type="checkbox"><strong>Works in grayscale</strong> (test by converting to black &amp; white)</label></li>
<li><label><input type="checkbox"><strong>Colorblind accessible</strong> (test with simulation tools)</label></li>
</ul>
<hr>
</section>
<section id="exercise-2.3.1-color-restraint-practice" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.3.1-color-restraint-practice">Exercise 2.3.1: Color Restraint Practice</h3>
<p><strong>Objective:</strong> Practice creating publication-ready figures with minimal, logical color use</p>
<p><strong>Task:</strong></p>
<ol type="1">
<li><p><strong>Find a figure</strong> from your own work or literature that uses &gt;5 colors</p></li>
<li><p><strong>Redesign it</strong> following these constraints:</p>
<ul>
<li>Maximum 3 distinct colors (plus grayscale)</li>
<li>Light background (white)</li>
<li>Consistent color logic (explain your color choices)</li>
<li>No decorative color</li>
</ul></li>
<li><p><strong>Document your choices:</strong></p>
<p>Original figure: [description, number of colors used]</p>
<p>Redesign:</p>
<ul>
<li>Color 1: [Hex code] - Used for: [data/concept] - Reason: [explain]</li>
<li>Color 2: [Hex code] - Used for: [data/concept] - Reason: [explain]</li>
<li>Color 3: [Hex code] - Used for: [data/concept] - Reason: [explain]</li>
<li>Grayscale: Used for: [supporting elements]</li>
</ul>
<p>Logic: [Explain the semantic consistency of your color choices]</p>
<p>Improvements: [What became clearer with fewer colors]</p></li>
<li><p><strong>Test accessibility:</strong></p>
<ul>
<li>Convert to grayscale: Do distinctions remain clear?</li>
<li>Use colorblind simulator: Is information preserved?</li>
</ul></li>
</ol>
<hr>
<p><strong>End of Section 2.3</strong></p>
<p><strong>Key Takeaways:</strong> - <strong>Default to light themes</strong> for all publications - <strong>Dark themes</strong> only for presentations/posters - <strong>3-color maximum</strong> (excluding grayscale) for clarity - <strong>Every color must have semantic meaning</strong> - <strong>Consistency across manuscript</strong> is mandatory - <strong>Respect field conventions</strong> unless you have strong justification —</p>
</section>
</section>
<section id="light-vs.-deep-colors-saturation-and-intensity" class="level2">
<h2 class="anchored" data-anchor-id="light-vs.-deep-colors-saturation-and-intensity">2.4 Light vs.&nbsp;Deep Colors: Saturation and Intensity</h2>
<section id="understanding-color-intensity-in-scientific-figures" class="level3">
<h3 class="anchored" data-anchor-id="understanding-color-intensity-in-scientific-figures">Understanding Color Intensity in Scientific Figures</h3>
<p>In scientific visualization, the choice between <strong>light (desaturated)</strong> and <strong>deep (saturated)</strong> colors isn’t about aesthetics—it’s about <strong>visual hierarchy</strong>, <strong>emphasis</strong>, and <strong>cognitive processing</strong>. This section addresses when to use vivid, saturated colors versus pale, muted tones.</p>
</section>
<section id="the-saturation-spectrum" class="level3">
<h3 class="anchored" data-anchor-id="the-saturation-spectrum">The Saturation Spectrum</h3>
<p><strong>Color saturation</strong> refers to the intensity or purity of a color:</p>
<ul>
<li><strong>High saturation (deep colors)</strong>: Vivid, pure, intense (e.g., pure red #FF0000)</li>
<li><strong>Low saturation (light colors)</strong>: Pale, muted, washed-out (e.g., light pink #FFB3BA)</li>
<li><strong>Zero saturation</strong>: Grayscale only</li>
</ul>
<p><strong>In HSV/HSB color model:</strong></p>
<pre><code>Saturation = 0%: Pure gray (no color)
Saturation = 50%: Muted, pastel-like
Saturation = 100%: Maximum vividness</code></pre>
<hr>
</section>
<section id="the-visual-hierarchy-principle-deep-colors-for-focus" class="level3">
<h3 class="anchored" data-anchor-id="the-visual-hierarchy-principle-deep-colors-for-focus">The Visual Hierarchy Principle: Deep Colors for Focus</h3>
<p><strong>Rule: Use deep, saturated colors sparingly for PRIMARY focus only</strong></p>
<p><strong>Why this matters:</strong> 1. <strong>Pre-attentive attention</strong>: Saturated colors grab attention immediately 2. <strong>Visual weight</strong>: Deep colors appear “heavier” and more important 3. <strong>Cognitive load</strong>: Too many saturated colors cause visual fatigue 4. <strong>Professional standards</strong>: Scientific figures should be clear, not garish</p>
<p><strong>The Hierarchy Strategy:</strong></p>
<pre><code>LEVEL 1 (Primary focus): Deep, saturated colors
└─ The key finding, most important data
└─ Examples: Significant results, highlighted treatment group

LEVEL 2 (Supporting context): Medium saturation
└─ Important but secondary data
└─ Examples: Reference groups, all experimental conditions

LEVEL 3 (Background/infrastructure): Light, desaturated colors
└─ Supporting elements that shouldn't distract
└─ Examples: Gridlines, reference regions, non-significant data</code></pre>
<hr>
</section>
<section id="practical-application-examples" class="level3">
<h3 class="anchored" data-anchor-id="practical-application-examples">Practical Application Examples</h3>
<section id="example-1-highlighting-significant-results" class="level4">
<h4 class="anchored" data-anchor-id="example-1-highlighting-significant-results">Example 1: Highlighting Significant Results</h4>
<p><strong>Scenario:</strong> Clinical trial with 8 treatment groups, only 2 show significant improvement</p>
<p><strong>Bad Approach (Equal saturation):</strong></p>
<pre><code>✗ All 8 groups in equally bright, saturated colors
  → No visual priority
  → Reader must read legend and statistics to find key results
  → Cognitive overload from too many bright colors</code></pre>
<p><strong>Good Approach (Saturation hierarchy):</strong></p>
<pre><code>✓ 2 significant groups: Deep, saturated colors (e.g., #E63946 red, #2E86AB blue)
✓ 6 non-significant groups: Light, desaturated gray (#CCCCCC)
  → Immediate visual focus on significant findings
  → Clean, uncluttered appearance
  → Professional and publication-ready</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data: 8 treatment groups</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="ss">f'Group </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>)]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">13</span>]  <span class="co"># Groups 3 and 6 are significant</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify significant groups</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>significant <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">5</span>]  <span class="co"># Indices of Group 3 and Group 6</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Deep colors for significant, light for non-significant</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD approach: All equally saturated</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>colors_bad <span class="op">=</span> [<span class="st">'#E63946'</span>, <span class="st">'#F77F00'</span>, <span class="st">'#FCBF49'</span>, <span class="st">'#06A77D'</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>              <span class="st">'#4ECDC4'</span>, <span class="st">'#2E86AB'</span>, <span class="st">'#8338EC'</span>, <span class="st">'#A23B72'</span>]</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar(groups, values, color<span class="op">=</span>colors_bad, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.2</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].errorbar(groups, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>, ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Response (arbitrary units)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'BAD: All Colors Equally Saturated</span><span class="ch">\n</span><span class="st">(No visual priority)'</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD approach: Deep colors only for significant</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>colors_good <span class="op">=</span> [<span class="st">'#D3D3D3'</span>] <span class="op">*</span> <span class="dv">8</span>  <span class="co"># All light gray by default</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>colors_good[<span class="dv">2</span>] <span class="op">=</span> <span class="st">'#E63946'</span>     <span class="co"># Group 3: Deep red</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>colors_good[<span class="dv">5</span>] <span class="op">=</span> <span class="st">'#2E86AB'</span>     <span class="co"># Group 6: Deep blue</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].bar(groups, values, color<span class="op">=</span>colors_good, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.2</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].errorbar(groups, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>, ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Response (arbitrary units)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'GOOD: Deep Colors for Significant Only</span><span class="ch">\n</span><span class="st">(Clear visual hierarchy)'</span>,</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significance markers</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> significant:</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(idx, values[idx] <span class="op">+</span> errors[idx] <span class="op">+</span> <span class="dv">2</span>, <span class="st">'***'</span>,</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'saturation_hierarchy.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Group '</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">25</span>, <span class="dv">11</span>, <span class="dv">13</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>significant <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>)  <span class="co"># Group 3 and 6 are significant</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(groups, <span class="at">levels =</span> groups),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> values,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> errors,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_significant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">%in%</span> significant</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: All equally saturated</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>colors_bad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#E63946'</span>, <span class="st">'#F77F00'</span>, <span class="st">'#FCBF49'</span>, <span class="st">'#06A77D'</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'#4ECDC4'</span>, <span class="st">'#2E86AB'</span>, <span class="st">'#8338EC'</span>, <span class="st">'#A23B72'</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>p_bad <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">fill =</span> group), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> value <span class="sc">-</span> error, <span class="at">ymax =</span> value <span class="sc">+</span> error),</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors_bad) <span class="sc">+</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Response (arbitrary units)'</span>,</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'BAD: All Colors Equally Saturated</span><span class="sc">\n</span><span class="st">(No visual priority)'</span>) <span class="sc">+</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>)</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Deep colors only for significant</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>is_significant,</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(data<span class="sc">$</span>group <span class="sc">==</span> <span class="st">'Group 3'</span>, <span class="st">'#E63946'</span>, <span class="st">'#2E86AB'</span>),</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'#D3D3D3'</span>)</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>p_good <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="fu">aes</span>(<span class="at">fill =</span> color), <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> value <span class="sc">-</span> error, <span class="at">ymax =</span> value <span class="sc">+</span> error),</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Response (arbitrary units)'</span>,</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'GOOD: Deep Colors for Significant Only</span><span class="sc">\n</span><span class="st">(Clear visual hierarchy)'</span>) <span class="sc">+</span></span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>)</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add significance markers</span></span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_significant),</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">'***'</span>, <span class="at">y =</span> value <span class="sc">+</span> error <span class="sc">+</span> <span class="dv">2</span>),</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>)</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p_bad <span class="sc">|</span> p_good</span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'saturation_hierarchy.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="example-2-correlation-strength-visualization" class="level4">
<h4 class="anchored" data-anchor-id="example-2-correlation-strength-visualization">Example 2: Correlation Strength Visualization</h4>
<p><strong>Scenario:</strong> Showing multiple correlations, want to emphasize strongest relationships</p>
<p><strong>Principle:</strong> <strong>Deep colors = Strong/significant, Light colors = Weak/non-significant</strong></p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix data</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="st">'Gene A'</span>, <span class="st">'Gene B'</span>, <span class="st">'Gene C'</span>, <span class="st">'Gene D'</span>, <span class="st">'Gene E'</span>]</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>n_vars <span class="op">=</span> <span class="bu">len</span>(variables)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate correlation matrix with some strong correlations</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> np.random.rand(n_vars, n_vars) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> (corr_matrix <span class="op">+</span> corr_matrix.T) <span class="op">/</span> <span class="dv">2</span>  <span class="co"># Symmetrize</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>np.fill_diagonal(corr_matrix, <span class="fl">1.0</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some strong correlations</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">0</span>, <span class="dv">2</span>] <span class="op">=</span> corr_matrix[<span class="dv">2</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.85</span>  <span class="co"># Strong positive</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">1</span>, <span class="dv">4</span>] <span class="op">=</span> corr_matrix[<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="op">-</span><span class="fl">0.78</span>  <span class="co"># Strong negative</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">3</span>, <span class="dv">4</span>] <span class="op">=</span> corr_matrix[<span class="dv">4</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="fl">0.72</span>  <span class="co"># Moderate-strong</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Significance (p-values) - for demonstration</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>p_values <span class="op">=</span> np.random.rand(n_vars, n_vars) <span class="op">*</span> <span class="fl">0.1</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">0</span>, <span class="dv">2</span>] <span class="op">=</span> p_values[<span class="dv">2</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="fl">0.001</span>  <span class="co"># Highly significant</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">1</span>, <span class="dv">4</span>] <span class="op">=</span> p_values[<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="fl">0.002</span>  <span class="co"># Highly significant</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">3</span>, <span class="dv">4</span>] <span class="op">=</span> p_values[<span class="dv">4</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="fl">0.01</span>   <span class="co"># Significant</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>np.fill_diagonal(p_values, <span class="dv">0</span>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Uniform saturation regardless of significance</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> axes[<span class="dv">0</span>].imshow(corr_matrix, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_yticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(variables, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_yticklabels(variables)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'BAD: All Correlations Equal Saturation</span><span class="ch">\n</span><span class="st">(Significant and non-significant look same)'</span>,</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation values</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].text(j, i, <span class="ss">f'</span><span class="sc">{</span>corr_matrix[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>                    ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> <span class="bu">abs</span>(corr_matrix[i, j]) <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span>)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>axes[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'Correlation coefficient'</span>)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Deep colors for significant, desaturated for non-significant</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom colormap with saturation based on significance</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>corr_colored <span class="op">=</span> np.zeros((n_vars, n_vars, <span class="dv">3</span>))</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> corr_matrix[i, j]</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> p_values[i, j]</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p <span class="op">&lt;</span> <span class="fl">0.05</span>:  <span class="co"># Significant: deep colors</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> r <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Deep red for significant positive</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>                saturation <span class="op">=</span> <span class="bu">min</span>(<span class="bu">abs</span>(r), <span class="fl">1.0</span>)</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>                corr_colored[i, j] <span class="op">=</span> [<span class="fl">0.9</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>]  <span class="co"># Deep red</span></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Deep blue for significant negative</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>                saturation <span class="op">=</span> <span class="bu">min</span>(<span class="bu">abs</span>(r), <span class="fl">1.0</span>)</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>                corr_colored[i, j] <span class="op">=</span> [<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>]  <span class="co"># Deep blue</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Non-significant: light colors</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> r <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Light pink for non-significant positive</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>                corr_colored[i, j] <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">0.85</span>, <span class="fl">0.85</span>]  <span class="co"># Light pink</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Light blue for non-significant negative</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>                corr_colored[i, j] <span class="op">=</span> [<span class="fl">0.85</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>]  <span class="co"># Light blue</span></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].imshow(corr_colored, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_yticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(variables, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_yticklabels(variables)</span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'GOOD: Deep Colors for Significant Only</span><span class="ch">\n</span><span class="st">(p &lt; 0.05 with deep colors, others desaturated)'</span>,</span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>                  fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation values with significance markers</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>        sig_marker <span class="op">=</span> <span class="st">'***'</span> <span class="cf">if</span> p_values[i, j] <span class="op">&lt;</span> <span class="fl">0.01</span> <span class="cf">else</span> (<span class="st">'*'</span> <span class="cf">if</span> p_values[i, j] <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">''</span>)</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].text(j, i, <span class="ss">f'</span><span class="sc">{</span>corr_matrix[i, j]<span class="sc">:.2f}</span><span class="ch">\n</span><span class="sc">{</span>sig_marker<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>                    ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> p_values[i, j] <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="kw">and</span> <span class="bu">abs</span>(corr_matrix[i, j]) <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span>,</span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>                    fontweight<span class="op">=</span><span class="st">'bold'</span> <span class="cf">if</span> sig_marker <span class="cf">else</span> <span class="st">'normal'</span>)</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'correlation_saturation_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate correlation data</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Gene A'</span>, <span class="st">'Gene B'</span>, <span class="st">'Gene C'</span>, <span class="st">'Gene D'</span>, <span class="st">'Gene E'</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>n_vars <span class="ot">&lt;-</span> <span class="fu">length</span>(variables)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_vars<span class="sc">^</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), n_vars, n_vars)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> (corr_matrix <span class="sc">+</span> <span class="fu">t</span>(corr_matrix)) <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Symmetrize</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_matrix) <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add strong correlations</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> corr_matrix[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.85</span>   <span class="co"># Strong positive</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">2</span>, <span class="dv">5</span>] <span class="ot">&lt;-</span> corr_matrix[<span class="dv">5</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.78</span>  <span class="co"># Strong negative</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>corr_matrix[<span class="dv">4</span>, <span class="dv">5</span>] <span class="ot">&lt;-</span> corr_matrix[<span class="dv">5</span>, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fl">0.72</span>   <span class="co"># Moderate-strong</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="co"># P-values</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_vars<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), n_vars, n_vars)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> p_values[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">2</span>, <span class="dv">5</span>] <span class="ot">&lt;-</span> p_values[<span class="dv">5</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.002</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>p_values[<span class="dv">4</span>, <span class="dv">5</span>] <span class="ot">&lt;-</span> p_values[<span class="dv">5</span>, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p_values) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(corr_matrix) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(corr_matrix) <span class="ot">&lt;-</span> variables</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p_values) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(p_values) <span class="ot">&lt;-</span> variables</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>corr_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(corr_matrix, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">'Var1'</span>, <span class="st">'Var2'</span>), <span class="at">value.name =</span> <span class="st">'correlation'</span>)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>p_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(p_values, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">'Var1'</span>, <span class="st">'Var2'</span>), <span class="at">value.name =</span> <span class="st">'p_value'</span>)</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> corr_long <span class="sc">%&gt;%</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(p_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Var1'</span>, <span class="st">'Var2'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">significant =</span> p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_marker =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">'***'</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">'*'</span>,</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">''</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Color logic: deep colors for significant, light for non-significant</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> correlation <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Significant Positive'</span>,</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> correlation <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Significant Negative'</span>,</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>significant <span class="sc">&amp;</span> correlation <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Non-sig Positive'</span>,</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>significant <span class="sc">&amp;</span> correlation <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Non-sig Negative'</span>,</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'Neutral'</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Significant Positive'</span> <span class="ot">=</span> <span class="st">'#E63946'</span>,    <span class="co"># Deep red</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Significant Negative'</span> <span class="ot">=</span> <span class="st">'#2E86AB'</span>,    <span class="co"># Deep blue</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Non-sig Positive'</span> <span class="ot">=</span> <span class="st">'#FFD6D6'</span>,        <span class="co"># Light pink</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Non-sig Negative'</span> <span class="ot">=</span> <span class="st">'#D6E5F2'</span>,        <span class="co"># Light blue</span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Neutral'</span> <span class="ot">=</span> <span class="st">'#FFFFFF'</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD plot: Saturation based on significance</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>p_good <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_combined, <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> Var1, <span class="at">fill =</span> color_category)) <span class="sc">+</span></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">'%.2f'</span>, correlation), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>, sig_marker)),</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="fu">ifelse</span>(data_combined<span class="sc">$</span>significant, <span class="st">'bold'</span>, <span class="st">'plain'</span>)) <span class="sc">+</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_mapping, <span class="at">name =</span> <span class="st">'Correlation Type'</span>) <span class="sc">+</span></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'GOOD: Deep Colors for Significant Correlations</span><span class="sc">\n</span><span class="st">(p &lt; 0.05 with deep colors, others desaturated)'</span>,</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'bottom'</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'correlation_saturation_logic.png'</span>, p_good, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="guidelines-for-saturation-use" class="level3">
<h3 class="anchored" data-anchor-id="guidelines-for-saturation-use">Guidelines for Saturation Use</h3>
<p><strong>DO use deep, saturated colors for:</strong> - <strong>Statistically significant results</strong> (p &lt; 0.05) - <strong>Primary experimental condition</strong> (treatment vs.&nbsp;all controls) - <strong>Key finding</strong> you want to emphasize - <strong>Strong effects</strong> (large effect sizes, high correlations) - <strong>Highlighting outliers</strong> or exceptional cases</p>
<p><strong>DO use light, desaturated colors for:</strong> - <strong>Non-significant results</strong> (p ≥ 0.05) - <strong>Reference/control groups</strong> (when not the focus) - <strong>Background data</strong> (context, not main finding) - <strong>Weak effects</strong> (low correlations, small differences) - <strong>Supporting information</strong> (supplementary analyses)</p>
<p><strong>Color Saturation Decision Matrix:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 35%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Data Type</th>
<th>Primary/Significant</th>
<th>Secondary/Non-significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Positive correlation</strong></td>
<td>Deep red (#E63946)</td>
<td>Light pink (#FFD6D6)</td>
</tr>
<tr class="even">
<td><strong>Negative correlation</strong></td>
<td>Deep blue (#2E86AB)</td>
<td>Light blue (#D6E5F2)</td>
</tr>
<tr class="odd">
<td><strong>Treatment group</strong></td>
<td>Deep color (#9B59B6)</td>
<td>Light gray (#D3D3D3)</td>
</tr>
<tr class="even">
<td><strong>Control group</strong></td>
<td>Medium gray (#808080)</td>
<td>Light gray (#ECECEC)</td>
</tr>
<tr class="odd">
<td><strong>Upregulated genes</strong></td>
<td>Deep red (#C0392B)</td>
<td>Light red (#F5B7B1)</td>
</tr>
<tr class="even">
<td><strong>Downregulated genes</strong></td>
<td>Deep blue (#2874A6)</td>
<td>Light blue (#AED6F1)</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="the-3-color-saturation-strategy" class="level3">
<h3 class="anchored" data-anchor-id="the-3-color-saturation-strategy">The “3-Color + Saturation” Strategy</h3>
<p><strong>Most effective publication approach: 3 base colors, varied saturation</strong></p>
<p><strong>Example: Gene Expression Study</strong></p>
<pre><code>Base Palette (3 colors):
1. Red family: For upregulation
2. Blue family: For downregulation
3. Gray: For no change/control

Saturation levels:
- Deep (S=100%): Significant changes (p &lt; 0.05, |fold-change| &gt; 2)
- Medium (S=60%): Moderate changes (p &lt; 0.05, |fold-change| 1-2)
- Light (S=30%): Non-significant changes (p ≥ 0.05)</code></pre>
<p><strong>Code Example (Python) - Gene Expression Volcano Plot:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression data</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>n_genes <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2 fold change</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>log2fc <span class="op">=</span> np.random.randn(n_genes) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># -log10 p-values</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>neg_log10_p <span class="op">=</span> <span class="op">-</span>np.log10(np.random.uniform(<span class="fl">0.0001</span>, <span class="fl">0.5</span>, n_genes))</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some significant genes</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>sig_up_idx <span class="op">=</span> np.random.choice(n_genes, <span class="dv">50</span>, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>sig_down_idx <span class="op">=</span> np.random.choice(np.setdiff1d(<span class="bu">range</span>(n_genes), sig_up_idx), <span class="dv">50</span>, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>log2fc[sig_up_idx] <span class="op">=</span> np.random.uniform(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">50</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>log2fc[sig_down_idx] <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">50</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>neg_log10_p[sig_up_idx] <span class="op">=</span> np.random.uniform(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">50</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>neg_log10_p[sig_down_idx] <span class="op">=</span> np.random.uniform(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">50</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorize genes by significance and magnitude</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> categorize_gene(fc, p_val):</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    significant <span class="op">=</span> p_val <span class="op">&gt;</span> <span class="op">-</span>np.log10(<span class="fl">0.05</span>)  <span class="co"># p &lt; 0.05</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    strong_change <span class="op">=</span> <span class="bu">abs</span>(fc) <span class="op">&gt;</span> <span class="dv">2</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> significant <span class="kw">and</span> strong_change:</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> fc <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'sig_up_strong'</span>, <span class="st">'#C0392B'</span>, <span class="dv">100</span>  <span class="co"># Deep red</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'sig_down_strong'</span>, <span class="st">'#2874A6'</span>, <span class="dv">100</span>  <span class="co"># Deep blue</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> significant:</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> fc <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'sig_up_mod'</span>, <span class="st">'#E74C3C'</span>, <span class="dv">60</span>  <span class="co"># Medium red</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'sig_down_mod'</span>, <span class="st">'#3498DB'</span>, <span class="dv">60</span>  <span class="co"># Medium blue</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'not_sig'</span>, <span class="st">'#D5D8DC'</span>, <span class="dv">30</span>  <span class="co"># Light gray</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [categorize_gene(fc, p) <span class="cf">for</span> fc, p <span class="kw">in</span> <span class="bu">zip</span>(log2fc, neg_log10_p)]</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>cat_names, colors, sizes <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>categories)</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with saturation hierarchy</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>ax.scatter(log2fc, neg_log10_p, c<span class="op">=</span>colors, s<span class="op">=</span><span class="dv">15</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Add thresholds</span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="op">-</span>np.log10(<span class="fl">0.05</span>), color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'p = 0.05'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>ax.axvline(<span class="op">-</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>ax.axvline(<span class="dv">2</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels and styling</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Log₂ Fold Change'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'-Log₁₀ P-value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Volcano Plot: Saturation Shows Significance &amp; Magnitude'</span>,</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom legend</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#C0392B'</span>, label<span class="op">=</span><span class="st">'Sig. upregulated (|FC| &gt; 2)'</span>),</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#E74C3C'</span>, label<span class="op">=</span><span class="st">'Sig. upregulated (|FC| &lt; 2)'</span>),</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#2874A6'</span>, label<span class="op">=</span><span class="st">'Sig. downregulated (|FC| &gt; 2)'</span>),</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#3498DB'</span>, label<span class="op">=</span><span class="st">'Sig. downregulated (|FC| &lt; 2)'</span>),</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#D5D8DC'</span>, label<span class="op">=</span><span class="st">'Not significant'</span>)</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>ax.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'volcano_saturation_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression data</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>n_genes <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">log2fc =</span> <span class="fu">rnorm</span>(n_genes, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">neg_log10_p =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fu">runif</span>(n_genes, <span class="fl">0.0001</span>, <span class="fl">0.5</span>))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significant genes</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>sig_up_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(n_genes, <span class="dv">50</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>sig_down_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_genes, sig_up_idx), <span class="dv">50</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log2fc[sig_up_idx] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log2fc[sig_down_idx] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>neg_log10_p[sig_up_idx] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>neg_log10_p[sig_down_idx] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorize</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">significant =</span> neg_log10_p <span class="sc">&gt;</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">strong_change =</span> <span class="fu">abs</span>(log2fc) <span class="sc">&gt;</span> <span class="dv">2</span>,</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> strong_change <span class="sc">&amp;</span> log2fc <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Sig. Up (strong)'</span>,</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> strong_change <span class="sc">&amp;</span> log2fc <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Sig. Down (strong)'</span>,</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> log2fc <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Sig. Up (moderate)'</span>,</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">&amp;</span> log2fc <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">'Sig. Down (moderate)'</span>,</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'Not significant'</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>      category <span class="sc">==</span> <span class="st">'Sig. Up (strong)'</span> <span class="sc">~</span> <span class="st">'#C0392B'</span>,      <span class="co"># Deep red</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>      category <span class="sc">==</span> <span class="st">'Sig. Up (moderate)'</span> <span class="sc">~</span> <span class="st">'#E74C3C'</span>,    <span class="co"># Medium red</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>      category <span class="sc">==</span> <span class="st">'Sig. Down (strong)'</span> <span class="sc">~</span> <span class="st">'#2874A6'</span>,    <span class="co"># Deep blue</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>      category <span class="sc">==</span> <span class="st">'Sig. Down (moderate)'</span> <span class="sc">~</span> <span class="st">'#3498DB'</span>,  <span class="co"># Medium blue</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'#D5D8DC'</span>                                  <span class="co"># Light gray</span></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Set factor levels for legend order</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>category, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sig. Up (strong)'</span>, <span class="st">'Sig. Up (moderate)'</span>,</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Sig. Down (strong)'</span>, <span class="st">'Sig. Down (moderate)'</span>,</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Not significant'</span></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log2fc, <span class="at">y =</span> neg_log10_p, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Thresholds</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">'dashed'</span>,</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">'dashed'</span>,</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">'gray50'</span>, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Colors</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sig. Up (strong)'</span> <span class="ot">=</span> <span class="st">'#C0392B'</span>,</span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sig. Up (moderate)'</span> <span class="ot">=</span> <span class="st">'#E74C3C'</span>,</span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sig. Down (strong)'</span> <span class="ot">=</span> <span class="st">'#2874A6'</span>,</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sig. Down (moderate)'</span> <span class="ot">=</span> <span class="st">'#3498DB'</span>,</span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Not significant'</span> <span class="ot">=</span> <span class="st">'#D5D8DC'</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Log₂ Fold Change'</span>,</span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'-Log₁₀ P-value'</span>,</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Volcano Plot: Saturation Shows Significance &amp; Magnitude'</span>,</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'Gene Category'</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme</span></span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'volcano_saturation_logic.png'</span>, p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="publication-checklist-color-saturation" class="level3">
<h3 class="anchored" data-anchor-id="publication-checklist-color-saturation">Publication Checklist: Color Saturation</h3>
<p><strong>Before finalizing figures, verify:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>Deep colors reserved for significant results</strong> (p &lt; 0.05 or key findings)</label></li>
<li><label><input type="checkbox"><strong>Light colors for non-significant</strong> or background data</label></li>
<li><label><input type="checkbox"><strong>Saturation hierarchy matches data importance</strong></label></li>
<li><label><input type="checkbox"><strong>Maximum 3 base colors</strong> (not counting saturation variants)</label></li>
<li><label><input type="checkbox"><strong>Logical semantic meaning</strong> (e.g., red=up, blue=down; maintained across all figures)</label></li>
<li><label><input type="checkbox"><strong>Works in grayscale</strong> (test by converting)</label></li>
<li><label><input type="checkbox"><strong>Colorblind accessible</strong> (test with simulator)</label></li>
</ul>
<hr>
</section>
</section>
<section id="continuous-vs.-discrete-color-scales" class="level2">
<h2 class="anchored" data-anchor-id="continuous-vs.-discrete-color-scales">2.5 Continuous vs.&nbsp;Discrete Color Scales</h2>
<section id="understanding-the-distinction" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-distinction">Understanding the Distinction</h3>
<p>The choice between continuous and discrete color scales is <strong>not aesthetic—it’s determined by your data type</strong>. Using the wrong scale type can fundamentally misrepresent your data and mislead readers.</p>
<hr>
</section>
<section id="continuous-color-scales-sequentialdiverging-gradients" class="level3">
<h3 class="anchored" data-anchor-id="continuous-color-scales-sequentialdiverging-gradients">Continuous Color Scales (Sequential/Diverging Gradients)</h3>
<p><strong>Use for: Truly continuous numerical data</strong></p>
<p><strong>Data types:</strong> - Temperature measurements (15.3°C, 15.4°C, 15.5°C…) - Gene expression levels (FPKM: 0.1, 2.3, 45.8, 123.4…) - Concentration gradients (0.01 μM to 100 μM) - Correlation coefficients (-1.0 to +1.0) - Probability values (0.0 to 1.0) - Any measurement on a continuous scale</p>
<p><strong>Key characteristic:</strong> Values can take <strong>any point along a spectrum</strong>, including intermediate values.</p>
<p><strong>Visual representation:</strong> Smooth gradient with no discrete boundaries</p>
<hr>
</section>
<section id="when-continuous-scales-make-sense" class="level3">
<h3 class="anchored" data-anchor-id="when-continuous-scales-make-sense">When Continuous Scales Make Sense</h3>
<section id="example-1-correlation-matrices" class="level4">
<h4 class="anchored" data-anchor-id="example-1-correlation-matrices">Example 1: Correlation Matrices</h4>
<p><strong>Logical Application:</strong></p>
<pre><code>Correlation coefficient r ranges from -1.0 to +1.0
- Any value in between is possible: -0.87, -0.23, 0.0, 0.45, 0.91
- Smooth gradient shows strength naturally
- Diverging palette: Blue (negative) ← White (zero) → Red (positive)</code></pre>
<p><strong>Why it’s logical:</strong> - <strong>Proportional interpretation</strong>: Darker red = stronger positive correlation - <strong>Continuous nature</strong>: Correlation is genuinely continuous - <strong>Intuitive reading</strong>: Color intensity matches correlation strength</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate correlation matrix</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>n_vars <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="ss">f'Var</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars)]</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create realistic correlation structure</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>base_corr <span class="op">=</span> np.random.randn(n_vars, n_vars) <span class="op">*</span> <span class="fl">0.3</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> base_corr <span class="op">@</span> base_corr.T</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> corr_matrix <span class="op">/</span> np.outer(np.sqrt(np.diag(corr_matrix)),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>                                      np.sqrt(np.diag(corr_matrix)))</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>np.fill_diagonal(corr_matrix, <span class="fl">1.0</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous scale with logical meaning</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">7</span>))</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Use diverging colormap: negative=blue, zero=white, positive=red</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(corr_matrix, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Styling</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(<span class="bu">range</span>(n_vars))</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(variables, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(variables, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation values</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_vars):</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>        text_color <span class="op">=</span> <span class="st">'white'</span> <span class="cf">if</span> <span class="bu">abs</span>(corr_matrix[i, j]) <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>        ax.text(j, i, <span class="ss">f'</span><span class="sc">{</span>corr_matrix[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>text_color, fontweight<span class="op">=</span><span class="st">'bold'</span> <span class="cf">if</span> <span class="bu">abs</span>(corr_matrix[i, j]) <span class="op">&gt;</span> <span class="fl">0.7</span> <span class="cf">else</span> <span class="st">'normal'</span>)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Colorbar with clear interpretation</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>ax, fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>)</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">'Correlation Coefficient (r)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>cbar.ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)  <span class="co"># Highlight zero</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'CONTINUOUS SCALE: Correlation Matrix</span><span class="ch">\n</span><span class="st">(Smooth gradient shows continuous relationship)'</span>,</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'continuous_correlation.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate correlation matrix</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>n_vars <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Var'</span>, <span class="dv">1</span><span class="sc">:</span>n_vars)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>base_corr <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n_vars<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), n_vars, n_vars)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> base_corr <span class="sc">%*%</span> <span class="fu">t</span>(base_corr)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> corr_matrix <span class="sc">/</span> <span class="fu">outer</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(corr_matrix)), <span class="fu">sqrt</span>(<span class="fu">diag</span>(corr_matrix)))</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_matrix) <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(corr_matrix) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(corr_matrix) <span class="ot">&lt;-</span> variables</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>corr_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(corr_matrix, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">'Var1'</span>, <span class="st">'Var2'</span>), <span class="at">value.name =</span> <span class="st">'correlation'</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with continuous scale</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(corr_long, <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> Var1, <span class="at">fill =</span> correlation)) <span class="sc">+</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Continuous diverging scale</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">'#2166AC'</span>,      <span class="co"># Blue (negative)</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">'white'</span>,        <span class="co"># White (zero)</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">'#B2182B'</span>,     <span class="co"># Red (positive)</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Correlation</span><span class="sc">\n</span><span class="st">Coefficient (r)'</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add text labels</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">'%.2f'</span>, correlation)),</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(corr_long<span class="sc">$</span>correlation) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">'white'</span>, <span class="st">'black'</span>),</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(corr_long<span class="sc">$</span>correlation) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">'bold'</span>, <span class="st">'plain'</span>)) <span class="sc">+</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'CONTINUOUS SCALE: Correlation Matrix</span><span class="sc">\n</span><span class="st">(Smooth gradient shows continuous relationship)'</span>) <span class="sc">+</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'continuous_correlation.png'</span>, p, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">7</span>,</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="example-2-gene-expression-heatmaps" class="level4">
<h4 class="anchored" data-anchor-id="example-2-gene-expression-heatmaps">Example 2: Gene Expression Heatmaps</h4>
<p><strong>Logical Application:</strong></p>
<pre><code>Expression level (FPKM/TPM) is genuinely continuous
- Values: 0.1, 1.3, 5.7, 23.4, 156.8...
- Often log-transformed for visualization (log2 or log10)
- Sequential gradient shows intensity naturally</code></pre>
<p><strong>Why continuous scale is appropriate:</strong> - Expression can take any positive value - Smooth transitions reflect biological reality - Color intensity proportional to expression level</p>
<p><strong>Important: Add significance layer with saturation (from 2.3)</strong></p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression data</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>n_genes <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2-transformed expression values (continuous)</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>expression <span class="op">=</span> np.random.lognormal(mean<span class="op">=</span><span class="dv">2</span>, sigma<span class="op">=</span><span class="fl">1.5</span>, size<span class="op">=</span>(n_genes, n_samples))</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>log2_expr <span class="op">=</span> np.log2(expression <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate p-values for differential expression</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>p_values <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="fl">0.15</span>, n_genes)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>significant <span class="op">=</span> p_values <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Gene and sample names</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>genes <span class="op">=</span> [<span class="ss">f'Gene</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes)]</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> [<span class="ss">f'S</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples)]</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Standard continuous heatmap (all genes equal visual weight)</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(log2_expr, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>ax1.set_yticks(<span class="bu">range</span>(n_genes))</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>ax1.set_yticklabels(genes, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'CONTINUOUS: Standard Heatmap</span><span class="ch">\n</span><span class="st">(All genes equal visual weight)'</span>,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(im1, ax<span class="op">=</span>ax1, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Log₂ Expression'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Enhanced with significance (deep colors for significant only)</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom colormap: deep colors for significant, light for non-significant</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>expression_colored <span class="op">=</span> np.zeros((n_genes, n_samples, <span class="dv">3</span>))</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize expression for color mapping</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>expr_norm <span class="op">=</span> (log2_expr <span class="op">-</span> log2_expr.<span class="bu">min</span>()) <span class="op">/</span> (log2_expr.<span class="bu">max</span>() <span class="op">-</span> log2_expr.<span class="bu">min</span>())</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes):</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>        intensity <span class="op">=</span> expr_norm[i, j]</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> significant[i]:  <span class="co"># Significant: deep red gradient</span></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Deep red scale</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>            expression_colored[i, j] <span class="op">=</span> [</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.2</span> <span class="op">+</span> intensity <span class="op">*</span> <span class="fl">0.6</span>,  <span class="co"># R: 0.2 to 0.8</span></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.1</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> intensity),  <span class="co"># G: decrease with intensity</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.1</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> intensity)   <span class="co"># B: decrease with intensity</span></span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># Non-significant: light pink gradient</span></span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Light pink scale</span></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>            expression_colored[i, j] <span class="op">=</span> [</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.95</span>,                    <span class="co"># R: always high (pink)</span></span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.7</span> <span class="op">+</span> intensity <span class="op">*</span> <span class="fl">0.25</span>,  <span class="co"># G: light</span></span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.7</span> <span class="op">+</span> intensity <span class="op">*</span> <span class="fl">0.25</span>   <span class="co"># B: light</span></span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>ax2.imshow(expression_colored, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>ax2.set_yticks(<span class="bu">range</span>(n_genes))</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>ax2.set_yticklabels(genes, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'CONTINUOUS + SIGNIFICANCE:</span><span class="ch">\n</span><span class="st">(Deep colors = p&lt;0.05, Light = non-sig)'</span>,</span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significance markers</span></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes):</span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> significant[i]:</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a>        ax2.text(<span class="op">-</span><span class="fl">1.5</span>, i, <span class="st">'***'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'continuous_expression_heatmap.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression data</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>n_genes <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>expression <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rlnorm</span>(n_genes <span class="sc">*</span> n_samples, <span class="at">meanlog=</span><span class="dv">2</span>, <span class="at">sdlog=</span><span class="fl">1.5</span>),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow=</span>n_genes, <span class="at">ncol=</span>n_samples)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>log2_expr <span class="ot">&lt;-</span> <span class="fu">log2</span>(expression <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-values</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_genes, <span class="dv">0</span>, <span class="fl">0.15</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>significant <span class="ot">&lt;-</span> p_values <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Names</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Gene'</span>, <span class="dv">1</span><span class="sc">:</span>n_genes)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'S'</span>, <span class="dv">1</span><span class="sc">:</span>n_samples)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(log2_expr) <span class="ot">&lt;-</span> samples</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(log2_expr) <span class="ot">&lt;-</span> genes</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>expr_long <span class="ot">&lt;-</span> log2_expr <span class="sc">%&gt;%</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">'Gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">'Gene'</span>, <span class="at">variable.name =</span> <span class="st">'Sample'</span>, <span class="at">value.name =</span> <span class="st">'Expression'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gene =</span> <span class="fu">factor</span>(Gene, <span class="at">levels =</span> genes))</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significance</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>expr_long <span class="ot">&lt;-</span> expr_long <span class="sc">%&gt;%</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Gene =</span> genes, <span class="at">p_value =</span> p_values, <span class="at">significant =</span> significant),</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">'Gene'</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Standard continuous heatmap</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(expr_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FFEDA0'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FEB24C'</span>, <span class="st">'#FD8D3C'</span>, <span class="st">'#FC4E2A'</span>, <span class="st">'#E31A1C'</span>, <span class="st">'#B10026'</span>),</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Log₂</span><span class="sc">\n</span><span class="st">Expression'</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'CONTINUOUS: Standard Heatmap</span><span class="sc">\n</span><span class="st">(All genes equal visual weight)'</span>) <span class="sc">+</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: With significance (deep vs light colors)</span></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>expr_long <span class="ot">&lt;-</span> expr_long <span class="sc">%&gt;%</span></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale expression 0-1</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">expr_norm =</span> (Expression <span class="sc">-</span> <span class="fu">min</span>(Expression)) <span class="sc">/</span> (<span class="fu">max</span>(Expression) <span class="sc">-</span> <span class="fu">min</span>(Expression)),</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Color based on significance</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>      significant <span class="sc">~</span> <span class="fu">rgb</span>(<span class="fl">0.2</span> <span class="sc">+</span> expr_norm <span class="sc">*</span> <span class="fl">0.6</span>, <span class="fl">0.1</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> expr_norm), <span class="fl">0.1</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> expr_norm)),</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">rgb</span>(<span class="fl">0.95</span>, <span class="fl">0.7</span> <span class="sc">+</span> expr_norm <span class="sc">*</span> <span class="fl">0.25</span>, <span class="fl">0.7</span> <span class="sc">+</span> expr_norm <span class="sc">*</span> <span class="fl">0.25</span>)</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(expr_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene)) <span class="sc">+</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> color), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'CONTINUOUS + SIGNIFICANCE</span><span class="sc">\n</span><span class="st">(Deep colors = p&lt;0.05, Light = non-sig)'</span>) <span class="sc">+</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>),</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significance markers</span></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>sig_genes <span class="ot">&lt;-</span> expr_long <span class="sc">%&gt;%</span></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(significant) <span class="sc">%&gt;%</span></span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Gene)</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span></span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> sig_genes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> Gene, <span class="at">label =</span> <span class="st">'***'</span>),</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'continuous_expression_heatmap.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="discrete-color-scales-categorical-palettes" class="level3">
<h3 class="anchored" data-anchor-id="discrete-color-scales-categorical-palettes">Discrete Color Scales (Categorical Palettes)</h3>
<p><strong>Use for: Truly categorical data with distinct, unordered groups</strong></p>
<p><strong>Data types:</strong> - Species names (Homo sapiens, Mus musculus, Drosophila…) - Treatment groups (Control, Drug A, Drug B, Placebo) - Cell types (Neurons, Astrocytes, Microglia, Endothelial) - Geographic regions (North, South, East, West) - Genotypes (Wild-type, Heterozygous, Homozygous mutant)</p>
<p><strong>Key characteristic:</strong> Values are <strong>distinct categories</strong> with no inherent ordering or intermediate states.</p>
<p><strong>Visual representation:</strong> Distinct, non-gradient colors</p>
<hr>
</section>
<section id="when-discrete-scales-make-sense" class="level3">
<h3 class="anchored" data-anchor-id="when-discrete-scales-make-sense">When Discrete Scales Make Sense</h3>
<section id="example-1-cell-type-identification" class="level4">
<h4 class="anchored" data-anchor-id="example-1-cell-type-identification">Example 1: Cell Type Identification</h4>
<p><strong>Logical Application:</strong></p>
<pre><code>Cell types are categorical:
- A cell is a neuron OR an astrocyte, not "half-neuron, half-astrocyte"
- No intermediate states or smooth transitions
- Each type needs a distinct, recognizable color</code></pre>
<p><strong>Why discrete scale is logical:</strong> - Categories are mutually exclusive - No quantitative relationship between categories - Distinct colors prevent false impression of ordering</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate spatial cell type data (e.g., from microscopy or spatial transcriptomics)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>n_cells <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial coordinates</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.rand(n_cells) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.rand(n_cells) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell types (categorical - mutually exclusive)</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>cell_types <span class="op">=</span> np.random.choice([<span class="st">'Neuron'</span>, <span class="st">'Astrocyte'</span>, <span class="st">'Microglia'</span>, <span class="st">'Oligodendrocyte'</span>, <span class="st">'Endothelial'</span>],</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                              size<span class="op">=</span>n_cells, p<span class="op">=</span>[<span class="fl">0.35</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.10</span>])</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># DISCRETE colors for categorical data (Okabe-Ito colorblind-safe palette)</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>color_map <span class="op">=</span> {</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Neuron'</span>: <span class="st">'#E69F00'</span>,         <span class="co"># Orange</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Astrocyte'</span>: <span class="st">'#56B4E9'</span>,      <span class="co"># Sky blue</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Microglia'</span>: <span class="st">'#009E73'</span>,      <span class="co"># Green</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Oligodendrocyte'</span>: <span class="st">'#F0E442'</span>, <span class="co"># Yellow</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Endothelial'</span>: <span class="st">'#CC79A7'</span>     <span class="co"># Pink</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [color_map[ct] <span class="cf">for</span> ct <span class="kw">in</span> cell_types]</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Continuous colormap for categorical data</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>cell_type_numeric <span class="op">=</span> np.array([<span class="bu">list</span>(color_map.keys()).index(ct) <span class="cf">for</span> ct <span class="kw">in</span> cell_types])</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>scatter1 <span class="op">=</span> ax1.scatter(x, y, c<span class="op">=</span>cell_type_numeric, cmap<span class="op">=</span><span class="st">'viridis'</span>, s<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'X Position (μm)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Y Position (μm)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'BAD: Continuous Scale for Categories</span><span class="ch">\n</span><span class="st">(Implies false ordering/gradient)'</span>,</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(scatter1, ax<span class="op">=</span>ax1)</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Cell Type (?)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>ax1.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Discrete colors for categorical data</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cell_type, color <span class="kw">in</span> color_map.items():</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> cell_types <span class="op">==</span> cell_type</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>    ax2.scatter(x[mask], y[mask], c<span class="op">=</span>color, s<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span>cell_type, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'X Position (μm)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Y Position (μm)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'GOOD: Discrete Colors for Categories</span><span class="ch">\n</span><span class="st">(Each type distinct and recognizable)'</span>,</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">9</span>, title<span class="op">=</span><span class="st">'Cell Type'</span>,</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>          title_fontsize<span class="op">=</span><span class="dv">10</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>ax2.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'discrete_cell_types.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate spatial cell type data</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>n_cells <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_cells, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_cells, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cell_type =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'Neuron'</span>, <span class="st">'Astrocyte'</span>, <span class="st">'Microglia'</span>, <span class="st">'Oligodendrocyte'</span>, <span class="st">'Endothelial'</span>),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> n_cells, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.10</span>))</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Discrete colors (Okabe-Ito palette)</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Neuron'</span> <span class="ot">=</span> <span class="st">'#E69F00'</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Astrocyte'</span> <span class="ot">=</span> <span class="st">'#56B4E9'</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Microglia'</span> <span class="ot">=</span> <span class="st">'#009E73'</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Oligodendrocyte'</span> <span class="ot">=</span> <span class="st">'#F0E442'</span>,</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Endothelial'</span> <span class="ot">=</span> <span class="st">'#CC79A7'</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Treating categorical as continuous</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>cell_type_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(data<span class="sc">$</span>cell_type))</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> cell_type_numeric)) <span class="sc">+</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">'Cell Type (?)'</span>) <span class="sc">+</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'X Position (μm)'</span>, <span class="at">y =</span> <span class="st">'Y Position (μm)'</span>,</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'BAD: Continuous Scale for Categories</span><span class="sc">\n</span><span class="st">(Implies false ordering/gradient)'</span>) <span class="sc">+</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">aspect.ratio =</span> <span class="dv">1</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Discrete colors</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> cell_type)) <span class="sc">+</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> color_map, <span class="at">name =</span> <span class="st">'Cell Type'</span>) <span class="sc">+</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'X Position (μm)'</span>, <span class="at">y =</span> <span class="st">'Y Position (μm)'</span>,</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'GOOD: Discrete Colors for Categories</span><span class="sc">\n</span><span class="st">(Each type distinct and recognizable)'</span>) <span class="sc">+</span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.85</span>),</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">aspect.ratio =</span> <span class="dv">1</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'discrete_cell_types.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="common-mistakes-mixing-continuous-and-discrete" class="level3">
<h3 class="anchored" data-anchor-id="common-mistakes-mixing-continuous-and-discrete">Common Mistakes: Mixing Continuous and Discrete</h3>
<p><strong>Mistake 1: Using continuous scale for categories</strong></p>
<pre><code>❌ BAD EXAMPLE:
Treatment groups (A, B, C, D) colored with rainbow gradient
→ Implies ordering: "B is between A and C"
→ Misleading when no such relationship exists

✓ FIX:
Use distinct colors from qualitative palette (Set2, Dark2, Okabe-Ito)</code></pre>
<p><strong>Mistake 2: Using discrete colors for continuous data</strong></p>
<pre><code>❌ BAD EXAMPLE:
Temperature data (15°C, 16°C, 17°C...) with 3 discrete colors (blue, yellow, red)
→ Creates false boundaries: "Below 20°=blue, 20-25°=yellow, above 25°=red"
→ Loses precision of continuous measurement

✓ FIX:
Use continuous gradient (sequential colormap: light blue → dark blue)</code></pre>
<hr>
</section>
<section id="decision-matrix-continuous-vs.-discrete" class="level3">
<h3 class="anchored" data-anchor-id="decision-matrix-continuous-vs.-discrete">Decision Matrix: Continuous vs.&nbsp;Discrete</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 20%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Question</th>
<th>Answer</th>
<th>Scale Type</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Can data take intermediate values?</td>
<td>Yes</td>
<td><strong>Continuous</strong></td>
<td>Temperature: 25.7°C</td>
</tr>
<tr class="even">
<td>Are categories mutually exclusive?</td>
<td>Yes</td>
<td><strong>Discrete</strong></td>
<td>Species: Human OR Mouse</td>
</tr>
<tr class="odd">
<td>Is there natural ordering?</td>
<td>Yes (quantitative)</td>
<td><strong>Continuous</strong></td>
<td>Concentration: 0-100 μM</td>
</tr>
<tr class="even">
<td>Is there natural ordering?</td>
<td>Yes (categorical)</td>
<td><strong>Discrete Sequential</strong></td>
<td>Disease: Mild/Moderate/Severe</td>
</tr>
<tr class="odd">
<td>Is zero/midpoint meaningful?</td>
<td>Yes</td>
<td><strong>Continuous Diverging</strong></td>
<td>Fold change: -2x to +2x</td>
</tr>
<tr class="even">
<td>Do you need exact value reading?</td>
<td>Yes</td>
<td><strong>Continuous</strong></td>
<td>Gene expression levels</td>
</tr>
<tr class="odd">
<td>Do you need category identification?</td>
<td>Yes</td>
<td><strong>Discrete</strong></td>
<td>Treatment groups</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="exercise-2.5.1-scale-type-classification" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.5.1-scale-type-classification">Exercise 2.5.1: Scale Type Classification</h3>
<p><strong>Objective:</strong> Practice identifying appropriate scale types and justifying choices</p>
<p><strong>Instructions:</strong></p>
<p>For each dataset, determine: 1. Is data continuous or categorical? 2. If continuous: sequential or diverging? 3. If categorical: qualitative or ordinal? 4. What colormap would you use? 5. What would happen if you used the wrong scale type?</p>
<p><strong>Datasets:</strong></p>
<p><strong>A. Soil pH measurements</strong> across a field - Values: 4.2, 5.8, 6.1, 6.9, 7.3, 8.1 - Range: 0-14</p>
<p><strong>B. Voting preference</strong> in an election - Categories: Candidate A, Candidate B, Candidate C, Undecided</p>
<p><strong>C. Protein abundance</strong> change after treatment - Values: -3.2x, -1.5x, +0.2x, +2.1x, +4.8x fold-change - Reference: 1x (no change)</p>
<p><strong>D. Animal species</strong> observed in a habitat - Categories: Deer, Rabbit, Fox, Squirrel, Bird</p>
<p><strong>E. Pain scale</strong> reported by patients - Categories: None, Mild, Moderate, Severe, Extreme</p>
<p><strong>Format your answer like this:</strong></p>
<pre><code>Dataset A: Soil pH
- Data type: Continuous numerical
- Scale type: Sequential continuous
- Colormap: Single-hue gradient (e.g., Yellow-Green-Blue for pH)
- Justification: pH is genuinely continuous; any intermediate value possible
- Wrong scale consequences: If discrete → false boundaries (e.g., "acidic" vs "neutral")
  where transition is actually gradual

Dataset E: Pain scale
- Data type: Ordinal categorical
- Scale type: Discrete sequential (ordered categories)
- Colormap: Light → Dark single hue (e.g., light yellow → deep red)
- Justification: Clear ordering but categories are discrete (no "2.5" pain level)
- Wrong scale consequences: If continuous gradient → implies precision that doesn't exist</code></pre>
<hr>
<p><strong>End of Section 2.5</strong></p>
<p><strong>Key Takeaways:</strong> - <strong>Continuous scales</strong> for data that can take any value in a range - <strong>Discrete scales</strong> for mutually exclusive categories - <strong>Never mix types</strong>: Using continuous for categorical (or vice versa) misrepresents data - <strong>Significance matters</strong>: Layer saturation hierarchy onto continuous scales - <strong>Semantic logic</strong>: Color choices must match data meaning (correlation: blue-white-red, categories: distinct hues)</p>
</section>
</section>
<section id="color-in-context-scientific-taste-and-discipline-conventions" class="level2">
<h2 class="anchored" data-anchor-id="color-in-context-scientific-taste-and-discipline-conventions">2.6 Color in Context: Scientific Taste and Discipline Conventions</h2>
<section id="the-unwritten-rules-of-scientific-color-use" class="level3">
<h3 class="anchored" data-anchor-id="the-unwritten-rules-of-scientific-color-use">The Unwritten Rules of Scientific Color Use</h3>
<p>While color theory provides the technical foundation, successful scientific figures must also navigate <strong>field-specific conventions</strong> and <strong>aesthetic expectations</strong> that signal professionalism and credibility. This isn’t about arbitrary preferences—these conventions have evolved to facilitate rapid interpretation within specialized communities.</p>
<hr>
</section>
<section id="what-is-scientific-taste-in-color" class="level3">
<h3 class="anchored" data-anchor-id="what-is-scientific-taste-in-color">What is “Scientific Taste” in Color?</h3>
<p><strong>Scientific taste</strong> refers to the collectively accepted color practices that:</p>
<ol type="1">
<li><strong>Signal competence</strong>: Proper use shows you understand your field</li>
<li><strong>Facilitate communication</strong>: Readers interpret colors according to learned conventions</li>
<li><strong>Convey rigor</strong>: Conservative, purposeful color use suggests careful analysis</li>
<li><strong>Enable comparison</strong>: Consistent schemes across literature allow mental cross-referencing</li>
</ol>
<p><strong>Not scientific taste:</strong> - Personal aesthetic preferences - Trendy design styles - Decorative color choices - Maximum visual impact regardless of clarity</p>
<hr>
</section>
<section id="core-principles-of-scientific-color-taste" class="level3">
<h3 class="anchored" data-anchor-id="core-principles-of-scientific-color-taste">Core Principles of Scientific Color Taste</h3>
<section id="principle-1-conservation-restraint-over-abundance" class="level4">
<h4 class="anchored" data-anchor-id="principle-1-conservation-restraint-over-abundance">Principle 1: Conservation (Restraint Over Abundance)</h4>
<p><strong>The Rule:</strong> Use the <strong>minimum number of colors</strong> necessary to convey information.</p>
<p><strong>Why it signals quality:</strong></p>
<pre><code>Too many colors suggests:
- Lack of focus (unclear message)
- Inexperience (not understanding conventions)
- Trying to impress rather than inform

Restrained color use suggests:
- Clear thinking (one message, one figure)
- Confidence (don't need flashiness)
- Respect for reader's cognitive load</code></pre>
<p><strong>Quantitative Guidelines:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 47%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Figure Type</th>
<th>Recommended Max Colors</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Single plot</strong></td>
<td>3-4 distinct hues</td>
<td>Beyond this, legend becomes confusing</td>
</tr>
<tr class="even">
<td><strong>Multi-panel (related)</strong></td>
<td>3-4 across all panels</td>
<td>Consistency aids interpretation</td>
</tr>
<tr class="odd">
<td><strong>Multi-panel (diverse)</strong></td>
<td>2-3 per panel</td>
<td>Each panel can have its own scheme if data types differ</td>
</tr>
<tr class="even">
<td><strong>Heatmap</strong></td>
<td>1 gradient (sequential or diverging)</td>
<td>Continuous data needs smooth scale</td>
</tr>
</tbody>
</table>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate experimental data</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>n_groups <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Restrained: only 3 groups shown</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span>),</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">0.8</span>),</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">1.5</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Restrained palette (3 colors max, grayscale for non-essential)</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>COLORS_GOOD <span class="op">=</span> {</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'#7F8C8D'</span>,      <span class="co"># Gray (reference)</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="st">'#3498DB'</span>,  <span class="co"># Blue</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="st">'#E74C3C'</span>   <span class="co"># Red</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Excessive colors (trying to show too much at once)</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>data_bad <span class="op">=</span> {<span class="op">**</span>data, <span class="op">**</span>{</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment C'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">0.5</span>),</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment D'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">0.3</span>),</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment E'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">1.0</span>),</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment F'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="fl">0.7</span>)</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>COLORS_BAD <span class="op">=</span> {</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'#7F8C8D'</span>,</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="st">'#3498DB'</span>,</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="st">'#E74C3C'</span>,</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment C'</span>: <span class="st">'#F39C12'</span>,</span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment D'</span>: <span class="st">'#8E44AD'</span>,</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment E'</span>: <span class="st">'#16A085'</span>,</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment F'</span>: <span class="st">'#D35400'</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Too many groups/colors</span></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, values <span class="kw">in</span> data_bad.items():</span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a>    ax1.plot(time, values, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>COLORS_BAD[group], label<span class="op">=</span>group)</span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response (%)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'BAD: Too Many Colors</span><span class="ch">\n</span><span class="st">(Cognitive overload, unclear message)'</span>,</span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">8</span>, ncol<span class="op">=</span><span class="dv">2</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Restrained (3 colors)</span></span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, values <span class="kw">in</span> data.items():</span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a>    ax2.plot(time, values, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, markersize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>COLORS_GOOD[group], label<span class="op">=</span>group)</span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response (%)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'GOOD: Restrained Color Use</span><span class="ch">\n</span><span class="st">(Clear, focused message)'</span>,</span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true" tabindex="-1"></a>ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'color_restraint_principle.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: 3 groups only</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>data_good <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time, <span class="dv">3</span>),</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="dv">0</span>, <span class="dv">3</span>)),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.8</span>, <span class="dv">3</span>)),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.5</span>, <span class="dv">3</span>))</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>), <span class="at">each =</span> <span class="fu">length</span>(time))</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>COLORS_GOOD <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Control'</span> <span class="ot">=</span> <span class="st">'#7F8C8D'</span>,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment A'</span> <span class="ot">=</span> <span class="st">'#3498DB'</span>,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment B'</span> <span class="ot">=</span> <span class="st">'#E74C3C'</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: 7 groups (too many)</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>data_bad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time, <span class="dv">7</span>),</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="dv">0</span>, <span class="dv">3</span>)),</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.8</span>, <span class="dv">3</span>)),</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.5</span>, <span class="dv">3</span>)),</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.5</span>, <span class="dv">3</span>)),</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.3</span>, <span class="dv">3</span>)),</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.0</span>, <span class="dv">3</span>)),</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.7</span>, <span class="dv">3</span>))</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Treatment C'</span>,</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Treatment D'</span>, <span class="st">'Treatment E'</span>, <span class="st">'Treatment F'</span>), <span class="at">each =</span> <span class="fu">length</span>(time))</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>COLORS_BAD <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Control'</span> <span class="ot">=</span> <span class="st">'#7F8C8D'</span>,</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment A'</span> <span class="ot">=</span> <span class="st">'#3498DB'</span>,</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment B'</span> <span class="ot">=</span> <span class="st">'#E74C3C'</span>,</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment C'</span> <span class="ot">=</span> <span class="st">'#F39C12'</span>,</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment D'</span> <span class="ot">=</span> <span class="st">'#8E44AD'</span>,</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment E'</span> <span class="ot">=</span> <span class="st">'#16A085'</span>,</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment F'</span> <span class="ot">=</span> <span class="st">'#D35400'</span></span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD plot</span></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_bad, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> response, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> COLORS_BAD) <span class="sc">+</span></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (hours)'</span>, <span class="at">y =</span> <span class="st">'Response (%)'</span>,</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'BAD: Too Many Colors</span><span class="sc">\n</span><span class="st">(Cognitive overload, unclear message)'</span>,</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD plot</span></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_good, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> response, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> COLORS_GOOD) <span class="sc">+</span></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (hours)'</span>, <span class="at">y =</span> <span class="st">'Response (%)'</span>,</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'GOOD: Restrained Color Use</span><span class="sc">\n</span><span class="st">(Clear, focused message)'</span>,</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2</span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'color_restraint_principle.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="principle-2-semantic-consistency-color-meaning" class="level4">
<h4 class="anchored" data-anchor-id="principle-2-semantic-consistency-color-meaning">Principle 2: Semantic Consistency (Color = Meaning)</h4>
<p><strong>The Rule:</strong> Establish color-concept associations and maintain them <strong>throughout your entire manuscript</strong>.</p>
<p><strong>Why it matters:</strong></p>
<pre><code>Reader mental model:
Figure 1: "Blue = Treatment A"
[Reads text, looks at Figure 2]
Figure 2: "Blue = Treatment A" (same)
→ Instant recognition, no re-learning

Inconsistent approach:
Figure 1: "Blue = Treatment A"
Figure 2: "Red = Treatment A" (changed!)
→ Confusion, constant cross-referencing, error-prone</code></pre>
<p><strong>Semantic Logic Examples:</strong></p>
<p><strong>Temperature-related:</strong></p>
<pre><code>✓ Blue = Cold/Low
✓ Red = Hot/High
✗ Never reverse this (culturally ingrained)</code></pre>
<p><strong>Biological expression:</strong></p>
<pre><code>✓ Red = Upregulated/Increased
✓ Blue/Green = Downregulated/Decreased
✓ Gray = No change/Control</code></pre>
<p><strong>Clinical outcomes:</strong></p>
<pre><code>✓ Green = Healthy/Improved
✓ Red = Disease/Worsened
✓ Gray = Baseline</code></pre>
<p><strong>Statistical significance:</strong></p>
<pre><code>✓ Deep/saturated = Significant (p&lt;0.05)
✓ Light/desaturated = Non-significant
✓ Consistent across all figures</code></pre>
<p><strong>Code Example (Python) - Manuscript-Wide Consistency:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINE COLORS ONCE - USE THROUGHOUT MANUSCRIPT</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Global color scheme for entire paper</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>MANUSCRIPT_COLORS <span class="op">=</span> {</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Treatment groups (consistent across ALL figures)</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'#95A5A6'</span>,        <span class="co"># Gray</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Drug_A'</span>: <span class="st">'#3498DB'</span>,         <span class="co"># Blue</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Drug_B'</span>: <span class="st">'#E74C3C'</span>,         <span class="co"># Red</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Expression levels</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Upregulated'</span>: <span class="st">'#C0392B'</span>,    <span class="co"># Deep red</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Downregulated'</span>: <span class="st">'#2874A6'</span>,  <span class="co"># Deep blue</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Unchanged'</span>: <span class="st">'#D5D8DC'</span>,      <span class="co"># Light gray</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Significance</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Significant'</span>: <span class="st">'#E67E22'</span>,    <span class="co"># Orange (highlights)</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NonSignificant'</span>: <span class="st">'#ECF0F1'</span>  <span class="co"># Very light gray</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURE 1: Time Course</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>data_fig1 <span class="op">=</span> {</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span>),</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Drug_A'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.5</span>),</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Drug_B'</span>: <span class="dv">100</span> <span class="op">+</span> np.cumsum(np.random.randn(<span class="bu">len</span>(time)) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.0</span>)</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, values <span class="kw">in</span> data_fig1.items():</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    ax1.plot(time, values, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, markersize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>MANUSCRIPT_COLORS[group], label<span class="op">=</span>group)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Cell Viability (%)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Figure 1: Time Course Analysis</span><span class="ch">\n</span><span class="st">(Colors: Control=Gray, Drug A=Blue, Drug B=Red)'</span>,</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'manuscript_fig1_consistent_colors.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURE 2: Endpoint Comparison (SAME COLORS)</span></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a>fig2, ax2 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>]</span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a>endpoint_values <span class="op">=</span> [<span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">78</span>]</span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>]</span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Use SAME colors from MANUSCRIPT_COLORS</span></span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a>bar_colors <span class="op">=</span> [MANUSCRIPT_COLORS[g] <span class="cf">for</span> g <span class="kw">in</span> groups]</span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax2.bar(groups, endpoint_values, color<span class="op">=</span>bar_colors,</span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a>              edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a>ax2.errorbar(groups, endpoint_values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a>            ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Final Viability (%)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Figure 2: Endpoint Comparison</span><span class="ch">\n</span><span class="st">(SAME colors as Figure 1 for consistency)'</span>,</span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">110</span>)</span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb78-83"><a href="#cb78-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-84"><a href="#cb78-84" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'manuscript_fig2_consistent_colors.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Colors consistent across Figures 1 and 2"</span>)</span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Control always Gray, Drug_A always Blue, Drug_B always Red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Manuscript-Wide Consistency:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINE COLORS ONCE - USE THROUGHOUT MANUSCRIPT</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>MANUSCRIPT_COLORS <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Treatment groups</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Control =</span> <span class="st">'#95A5A6'</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Drug_A =</span> <span class="st">'#3498DB'</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Drug_B =</span> <span class="st">'#E74C3C'</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Expression</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upregulated =</span> <span class="st">'#C0392B'</span>,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Downregulated =</span> <span class="st">'#2874A6'</span>,</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unchanged =</span> <span class="st">'#D5D8DC'</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Significance</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significant =</span> <span class="st">'#E67E22'</span>,</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">NonSignificant =</span> <span class="st">'#ECF0F1'</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURE 1: Time Course</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>data_fig1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(time, <span class="dv">3</span>),</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">viability =</span> <span class="fu">c</span>(</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="dv">0</span>, <span class="dv">2</span>)),</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">0.5</span>, <span class="dv">2</span>)),</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(time), <span class="fl">1.0</span>, <span class="dv">2</span>))</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>), <span class="at">each =</span> <span class="fu">length</span>(time))</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_fig1, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> viability, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unlist</span>(MANUSCRIPT_COLORS[<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>)])) <span class="sc">+</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (hours)'</span>, <span class="at">y =</span> <span class="st">'Cell Viability (%)'</span>,</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Figure 1: Time Course Analysis</span><span class="sc">\n</span><span class="st">(Colors: Control=Gray, Drug A=Blue, Drug B=Red)'</span>,</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'manuscript_fig1_consistent_colors.png'</span>, p1, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURE 2: Endpoint Comparison (SAME COLORS)</span></span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================</span></span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a>data_fig2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>),</span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>)),</span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">viability =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">78</span>),</span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_fig2, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> viability, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> viability <span class="sc">-</span> error, <span class="at">ymax =</span> viability <span class="sc">+</span> error),</span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unlist</span>(MANUSCRIPT_COLORS[<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Drug_A'</span>, <span class="st">'Drug_B'</span>)])) <span class="sc">+</span></span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Final Viability (%)'</span>,</span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Figure 2: Endpoint Comparison</span><span class="sc">\n</span><span class="st">(SAME colors as Figure 1 for consistency)'</span>) <span class="sc">+</span></span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">110</span>) <span class="sc">+</span></span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'manuscript_fig2_consistent_colors.png'</span>, p2, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Colors consistent across Figures 1 and 2</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Control always Gray, Drug_A always Blue, Drug_B always Red</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="field-specific-color-conventions-1" class="level3">
<h3 class="anchored" data-anchor-id="field-specific-color-conventions-1">Field-Specific Color Conventions</h3>
<p>Different scientific disciplines have evolved distinct color conventions. <strong>Knowing and following these signals domain expertise.</strong></p>
<section id="molecular-biology-genomics" class="level4">
<h4 class="anchored" data-anchor-id="molecular-biology-genomics">Molecular Biology &amp; Genomics</h4>
<p><strong>Standard Conventions:</strong></p>
<pre><code>DNA/RNA/Protein:
✓ DNA: Blue
✓ RNA: Red
✓ Protein: Green or Purple

Gene Expression:
✓ Upregulated: Red spectrum
✓ Downregulated: Blue/Green spectrum
✓ No change: Gray/White

Western Blots:
✓ Grayscale (mimics X-ray film)
✓ Or: Single color gradient (e.g., green for fluorescence)</code></pre>
<p><strong>Why these conventions:</strong> - Historical: DNA gels visualized with UV (blue), RNA with different dyes - Red/green originally from microarray technology (Cy3/Cy5 dyes) - Community agreement for rapid cross-study interpretation</p>
</section>
<section id="neuroscience" class="level4">
<h4 class="anchored" data-anchor-id="neuroscience">Neuroscience</h4>
<p><strong>Standard Conventions:</strong></p>
<pre><code>Cell Types:
✓ Neurons: Often red or orange
✓ Astrocytes: Green or cyan
✓ Microglia: Blue or purple

Activity/Calcium Imaging:
✓ Low activity: Blue/Purple
✓ High activity: Yellow/Red (fire scale)</code></pre>
</section>
<section id="climate-science" class="level4">
<h4 class="anchored" data-anchor-id="climate-science">Climate Science</h4>
<p><strong>Standard Conventions:</strong></p>
<pre><code>Temperature Anomalies:
✓ Cooling: Blue
✓ Neutral: White/Beige
✓ Warming: Red/Orange
(Never reverse this!)

Precipitation:
✓ Drought: Brown/Yellow
✓ Normal: Green
✓ Excess: Blue

Elevation:
✓ Low: Green/Blue
✓ Mid: Yellow/Brown
✓ High: White (snow-capped)</code></pre>
<p><strong>Code Example - Climate Convention (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate temperature anomaly data</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.arange(<span class="dv">1900</span>, <span class="dv">2024</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>temp_anomaly <span class="op">=</span> np.cumsum(np.random.randn(<span class="bu">len</span>(years)) <span class="op">*</span> <span class="fl">0.1</span>) <span class="op">-</span> <span class="fl">0.5</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use climate science convention: blue=cooling, red=warming</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#2166AC'</span> <span class="cf">if</span> t <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'#B2182B'</span> <span class="cf">for</span> t <span class="kw">in</span> temp_anomaly]</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>ax.bar(years, temp_anomaly, color<span class="op">=</span>colors, width<span class="op">=</span><span class="dv">1</span>, edgecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Temperature Anomaly (°C)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Climate Science Convention: Blue=Cooling, Red=Warming</span><span class="ch">\n</span><span class="st">(Never reverse this!)'</span>,</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#2166AC'</span>, label<span class="op">=</span><span class="st">'Below average (cooling)'</span>),</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>    Patch(facecolor<span class="op">=</span><span class="st">'#B2182B'</span>, label<span class="op">=</span><span class="st">'Above average (warming)'</span>)</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'climate_convention_colors.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example - Climate Convention (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1900</span><span class="sc">:</span><span class="dv">2023</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>temp_anomaly <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(years), <span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> years,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">anomaly =</span> temp_anomaly,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">direction =</span> <span class="fu">ifelse</span>(temp_anomaly <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">'Below average (cooling)'</span>, <span class="st">'Above average (warming)'</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> anomaly, <span class="at">fill =</span> direction)) <span class="sc">+</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'Below average (cooling)'</span> <span class="ot">=</span> <span class="st">'#2166AC'</span>,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Above average (warming)'</span> <span class="ot">=</span> <span class="st">'#B2182B'</span>)) <span class="sc">+</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Year'</span>, <span class="at">y =</span> <span class="st">'Temperature Anomaly (°C)'</span>,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Climate Science Convention: Blue=Cooling, Red=Warming</span><span class="sc">\n</span><span class="st">(Never reverse this!)'</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.9</span>),</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'climate_convention_colors.png'</span>, p, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="when-to-break-conventions-rarely" class="level3">
<h3 class="anchored" data-anchor-id="when-to-break-conventions-rarely">When to Break Conventions (Rarely)</h3>
<p><strong>Acceptable reasons to deviate:</strong></p>
<ol type="1">
<li><strong>Accessibility requirement</strong>: Convention uses red-green (colorblind problematic)
<ul>
<li>Solution: Use blue-orange instead, note change in caption</li>
</ul></li>
<li><strong>Technical constraint</strong>: Equipment outputs specific colors
<ul>
<li>Example: Microscope fluorophores are fixed</li>
<li>Solution: State actual fluorophore colors in methods, use convention in schematic</li>
</ul></li>
<li><strong>Conflicting conventions</strong>: Interdisciplinary work where fields disagree
<ul>
<li>Solution: Choose one, state explicitly in caption, be consistent</li>
</ul></li>
</ol>
<p><strong>Unacceptable reasons:</strong></p>
<ul>
<li>“I like purple better than blue”</li>
<li>“This looks cooler/more modern”</li>
<li>“To make my figure stand out”</li>
</ul>
<p><strong>How to break conventions properly:</strong></p>
<pre><code>✓ State explicitly in figure caption:
  "Note: We use blue for upregulation and red for downregulation
   (reverse of typical convention) to match the color scheme
   established in our previous work (Smith et al., 2022)"

✓ Provide justification in methods section

✓ Ensure internal consistency remains absolute</code></pre>
<hr>
</section>
<section id="exercise-2.6.1-convention-recognition-and-application" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.6.1-convention-recognition-and-application">Exercise 2.6.1: Convention Recognition and Application</h3>
<p><strong>Objective:</strong> Identify field conventions and apply them correctly</p>
<p><strong>Part A: Convention Identification</strong></p>
<p>For your field, research and document:</p>
<ol type="1">
<li><strong>Standard color schemes</strong> for common data types (check recent high-impact papers)</li>
<li><strong>Forbidden combinations</strong> (colors that would confuse readers)</li>
<li><strong>Historical reasons</strong> for these conventions (if discoverable)</li>
</ol>
<p><strong>Format:</strong></p>
<pre><code>Field: [Your discipline]

Convention 1:
- Data type: [e.g., Cell viability]
- Standard colors: [e.g., Green=live, Red=dead]
- Source: [e.g., Flow cytometry dye convention]
- Strength: [Strong/Moderate/Weak] (how universal is this?)

Forbidden combination:
- Never use: [e.g., Red for control group in my field]
- Reason: [e.g., Red always means "treatment" or "diseased"]</code></pre>
<p><strong>Part B: Cross-Field Comparison</strong></p>
<p>Find a paper from a different discipline and analyze:</p>
<ol type="1">
<li>What color conventions differ from yours?</li>
<li>Which are universal (e.g., hot=red, cold=blue)?</li>
<li>If you had to present your data to that community, what would you change?</li>
</ol>
<hr>
</section>
<section id="summary-color-taste-checklist" class="level3">
<h3 class="anchored" data-anchor-id="summary-color-taste-checklist">Summary: Color Taste Checklist</h3>
<p><strong>Before finalizing your manuscript’s figures:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>Maximum 3-4 distinct hues</strong> per figure (excluding grayscale)</label></li>
<li><label><input type="checkbox"><strong>Semantic consistency</strong> across all figures (same concept = same color)</label></li>
<li><label><input type="checkbox"><strong>Field conventions respected</strong> (or explicitly justified if broken)</label></li>
<li><label><input type="checkbox"><strong>Color assignments documented</strong> (create a style guide for co-authors)</label></li>
<li><label><input type="checkbox"><strong>No decorative color</strong> (every color has functional meaning)</label></li>
<li><label><input type="checkbox"><strong>Works in context</strong> (looks professional compared to recent papers in target journal)</label></li>
</ul>
<hr>
<p><strong>End of Section 2.6</strong></p>
</section>
</section>
<section id="accessibility-and-integrity-in-color" class="level2">
<h2 class="anchored" data-anchor-id="accessibility-and-integrity-in-color">2.7 Accessibility and Integrity in Color</h2>
<section id="the-ethical-imperative" class="level3">
<h3 class="anchored" data-anchor-id="the-ethical-imperative">The Ethical Imperative</h3>
<p>Color accessibility isn’t a “nice-to-have” feature—it’s an <strong>ethical requirement</strong> and increasingly a <strong>publication mandate</strong>. Approximately <strong>8% of males and 0.5% of females</strong> have some form of color vision deficiency (CVD), meaning 1 in 12 men and 1 in 200 women in your audience may struggle with your figures if you don’t design for accessibility.</p>
<p><strong>Why this matters for scientific communication:</strong></p>
<ol type="1">
<li><strong>Inclusivity</strong>: Exclude 8% of potential readers by default is unacceptable</li>
<li><strong>Information integrity</strong>: Critical findings should be accessible to all</li>
<li><strong>Journal requirements</strong>: Many journals now mandate colorblind-safe figures</li>
<li><strong>Reproducibility</strong>: Accessible figures are clearer for everyone, not just CVD readers</li>
<li><strong>Professional standards</strong>: Signals rigor and attention to detail</li>
</ol>
<hr>
</section>
<section id="types-of-color-vision-deficiency" class="level3">
<h3 class="anchored" data-anchor-id="types-of-color-vision-deficiency">Types of Color Vision Deficiency</h3>
<p>Understanding the types helps you design effectively:</p>
<section id="deuteranopia-green-blind-5-of-males" class="level4">
<h4 class="anchored" data-anchor-id="deuteranopia-green-blind-5-of-males">1. Deuteranopia (Green-Blind, ~5% of males)</h4>
<p><strong>What’s affected:</strong> - Cannot distinguish between red and green - Perceive them as variations of yellow/brown</p>
<p><strong>Problematic combinations:</strong></p>
<pre><code>✗ Red vs. Green (appears as yellow vs. yellow)
✗ Red-green traffic light analogy (both look similar)</code></pre>
<p><strong>Safe alternatives:</strong></p>
<pre><code>✓ Blue vs. Orange
✓ Blue vs. Red (distinguishable by brightness difference)
✓ Purple vs. Yellow</code></pre>
</section>
<section id="protanopia-red-blind-2.5-of-males" class="level4">
<h4 class="anchored" data-anchor-id="protanopia-red-blind-2.5-of-males">2. Protanopia (Red-Blind, ~2.5% of males)</h4>
<p><strong>What’s affected:</strong> - Cannot distinguish between red and green - Red appears darker/brownish - Similar confusion to deuteranopia but with brightness shifts</p>
<p><strong>Problematic combinations:</strong></p>
<pre><code>✗ Red vs. Green
✗ Red vs. Orange (both appear similar)</code></pre>
</section>
<section id="tritanopia-blue-blind-1-of-population-rare" class="level4">
<h4 class="anchored" data-anchor-id="tritanopia-blue-blind-1-of-population-rare">3. Tritanopia (Blue-Blind, &lt;1% of population, rare)</h4>
<p><strong>What’s affected:</strong> - Cannot distinguish between blue and yellow - Blue appears greenish, yellow appears pinkish</p>
<p><strong>Problematic combinations:</strong></p>
<pre><code>✗ Blue vs. Yellow
✗ Blue vs. Green</code></pre>
<p><strong>Note:</strong> Most colorblind-safe palettes focus on deuteranopia/protanopia (most common).</p>
<hr>
</section>
</section>
<section id="designing-for-color-accessibility" class="level3">
<h3 class="anchored" data-anchor-id="designing-for-color-accessibility">Designing for Color Accessibility</h3>
<section id="strategy-1-use-colorblind-safe-palettes" class="level4">
<h4 class="anchored" data-anchor-id="strategy-1-use-colorblind-safe-palettes">Strategy 1: Use Colorblind-Safe Palettes</h4>
<p><strong>Pre-vetted palettes that work for all CVD types:</strong></p>
<p><strong>Okabe-Ito Palette (Recommended):</strong></p>
<pre><code>Designed specifically for universal accessibility
8 colors, distinguishable by all CVD types

Colors:
#E69F00  Orange
#56B4E9  Sky Blue
#009E73  Bluish Green
#F0E442  Yellow
#0072B2  Blue
#D55E00  Vermilion (red-orange)
#CC79A7  Reddish Purple
#000000  Black</code></pre>
<p><strong>ColorBrewer Palettes:</strong></p>
<pre><code>Many ColorBrewer schemes are CVD-friendly
- "Set2" (qualitative, 8 colors)
- "Dark2" (qualitative, 8 colors)
- "RdYlBu" (diverging, if used correctly)

Check: colorbrewer2.org has CVD-safe filter
</code></pre>
<p><strong>Code Example (Python) - Okabe-Ito Implementation:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colorblind-safe palette</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>OKABE_ITO <span class="op">=</span> {</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'orange'</span>: <span class="st">'#E69F00'</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sky_blue'</span>: <span class="st">'#56B4E9'</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bluish_green'</span>: <span class="st">'#009E73'</span>,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'yellow'</span>: <span class="st">'#F0E442'</span>,</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'blue'</span>: <span class="st">'#0072B2'</span>,</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vermilion'</span>: <span class="st">'#D55E00'</span>,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'reddish_purple'</span>: <span class="st">'#CC79A7'</span>,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'black'</span>: <span class="st">'#000000'</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate grouped data</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Treatment C'</span>]</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">35</span>]</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>]</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign Okabe-Ito colors</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>group_colors <span class="op">=</span> [</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    OKABE_ITO[<span class="st">'black'</span>],          <span class="co"># Control: Black</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>    OKABE_ITO[<span class="st">'sky_blue'</span>],       <span class="co"># Treatment A: Sky Blue</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    OKABE_ITO[<span class="st">'vermilion'</span>],      <span class="co"># Treatment B: Vermilion</span></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    OKABE_ITO[<span class="st">'bluish_green'</span>]    <span class="co"># Treatment C: Bluish Green</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard view</span></span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax1.bar(groups, values, color<span class="op">=</span>group_colors, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>ax1.errorbar(groups, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>, ecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>            capsize<span class="op">=</span><span class="dv">8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response (arbitrary units)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Okabe-Ito Palette: Standard View</span><span class="ch">\n</span><span class="st">(Colorblind-safe)'</span>,</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">45</span>)</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated deuteranopia view (approximation)</span></span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to grayscale perception weights for deuteranopia</span></span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_deuteranopia(hex_color):</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Rough approximation of deuteranopia perception"""</span></span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert hex to RGB</span></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>    rgb <span class="op">=</span> <span class="bu">tuple</span>(<span class="bu">int</span>(hex_color[i:i<span class="op">+</span><span class="dv">2</span>], <span class="dv">16</span>)<span class="op">/</span><span class="dv">255</span> <span class="cf">for</span> i <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Deuteranopia: red and green channels affected</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simplified transformation (not exact)</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>    gray <span class="op">=</span> <span class="fl">0.3</span> <span class="op">*</span> rgb[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> rgb[<span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> rgb[<span class="dv">2</span>]</span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>    adjusted <span class="op">=</span> (rgb[<span class="dv">2</span>], gray, rgb[<span class="dv">1</span>])  <span class="co"># Shift perception</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(<span class="bu">min</span>(<span class="dv">1</span>, <span class="bu">max</span>(<span class="dv">0</span>, c)) <span class="cf">for</span> c <span class="kw">in</span> adjusted)</span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>cvd_colors <span class="op">=</span> [simulate_deuteranopia(c) <span class="cf">for</span> c <span class="kw">in</span> group_colors]</span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax2.bar(groups, values, color<span class="op">=</span>cvd_colors, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>ax2.errorbar(groups, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>, ecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a>            capsize<span class="op">=</span><span class="dv">8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response (arbitrary units)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Simulated Deuteranopia View</span><span class="ch">\n</span><span class="st">(Colors still distinguishable)'</span>,</span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">45</span>)</span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'okabe_ito_accessibility.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb93-73"><a href="#cb93-73" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb93-74"><a href="#cb93-74" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Okabe-Ito palette used"</span>)</span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Distinguishable by all color vision types"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Okabe-Ito Implementation:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colorblind-safe palette</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>OKABE_ITO <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">orange =</span> <span class="st">'#E69F00'</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sky_blue =</span> <span class="st">'#56B4E9'</span>,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bluish_green =</span> <span class="st">'#009E73'</span>,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">yellow =</span> <span class="st">'#F0E442'</span>,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">blue =</span> <span class="st">'#0072B2'</span>,</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">vermilion =</span> <span class="st">'#D55E00'</span>,</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">reddish_purple =</span> <span class="st">'#CC79A7'</span>,</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">black =</span> <span class="st">'#000000'</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Treatment C'</span>),</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Treatment C'</span>)),</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">35</span>),</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>)</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign colors</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>group_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Control'</span> <span class="ot">=</span> OKABE_ITO[<span class="st">'black'</span>],</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment A'</span> <span class="ot">=</span> OKABE_ITO[<span class="st">'sky_blue'</span>],</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment B'</span> <span class="ot">=</span> OKABE_ITO[<span class="st">'vermilion'</span>],</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment C'</span> <span class="ot">=</span> OKABE_ITO[<span class="st">'bluish_green'</span>]</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> value <span class="sc">-</span> error, <span class="at">ymax =</span> value <span class="sc">+</span> error),</span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> group_colors) <span class="sc">+</span></span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Response (arbitrary units)'</span>,</span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Okabe-Ito Palette: Colorblind-Safe</span><span class="sc">\n</span><span class="st">(Distinguishable by all color vision types)'</span>) <span class="sc">+</span></span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb94-46"><a href="#cb94-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb94-47"><a href="#cb94-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb94-48"><a href="#cb94-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-49"><a href="#cb94-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-50"><a href="#cb94-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'okabe_ito_accessibility.png'</span>, p, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb94-51"><a href="#cb94-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb94-52"><a href="#cb94-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-53"><a href="#cb94-53" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Okabe-Ito palette used</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb94-54"><a href="#cb94-54" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Distinguishable by all color vision types</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="strategy-2-redundant-encoding-color-something-else" class="level4">
<h4 class="anchored" data-anchor-id="strategy-2-redundant-encoding-color-something-else">Strategy 2: Redundant Encoding (Color + Something Else)</h4>
<p><strong>The most robust approach: Never rely on color alone</strong></p>
<p><strong>Redundant channels:</strong> - <strong>Color + Shape</strong> (circles vs.&nbsp;squares vs.&nbsp;triangles) - <strong>Color + Line style</strong> (solid vs.&nbsp;dashed vs.&nbsp;dotted) - <strong>Color + Pattern/Texture</strong> (for bar charts: solid, striped, dotted) - <strong>Color + Position</strong> (separate panels/facets) - <strong>Color + Text labels</strong> (direct labeling on plot)</p>
<p><strong>Code Example (Python) - Redundant Encoding:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Three treatment groups</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: (x, <span class="dv">5</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="fl">0.5</span>),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: (x, <span class="dv">5</span> <span class="op">+</span> <span class="fl">1.2</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="fl">0.5</span>),</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: (x, <span class="dv">5</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="fl">0.5</span>)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colors</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> {</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'#000000'</span>,      <span class="co"># Black</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="st">'#56B4E9'</span>,  <span class="co"># Sky Blue</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="st">'#D55E00'</span>   <span class="co"># Vermilion</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Different markers (redundant encoding with shape)</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>markers <span class="op">=</span> {</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'o'</span>,        <span class="co"># Circle</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="st">'s'</span>,    <span class="co"># Square</span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="st">'^'</span>     <span class="co"># Triangle</span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Different line styles (additional redundancy)</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>linestyles <span class="op">=</span> {</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'-'</span>,         <span class="co"># Solid</span></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment A'</span>: <span class="st">'--'</span>,    <span class="co"># Dashed</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment B'</span>: <span class="st">'-.'</span>     <span class="co"># Dash-dot</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Color only (vulnerable to CVD)</span></span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, (x_data, y_data) <span class="kw">in</span> data.items():</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>    ax1.plot(x_data, y_data, color<span class="op">=</span>colors[group], linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span>group)</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'COLOR ONLY</span><span class="ch">\n</span><span class="st">(Vulnerable if colors indistinguishable)'</span>,</span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Color + Shape + Line style (robust, redundant)</span></span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, (x_data, y_data) <span class="kw">in</span> data.items():</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>    ax2.plot(x_data, y_data,</span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colors[group],</span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span>linestyles[group],</span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>            marker<span class="op">=</span>markers[group],</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a>            markersize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>            markevery<span class="op">=</span><span class="dv">5</span>,  <span class="co"># Show marker every 5th point</span></span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>group)</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'COLOR + SHAPE + LINE STYLE</span><span class="ch">\n</span><span class="st">(Accessible: multiple redundant cues)'</span>,</span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'redundant_encoding_accessibility.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Redundant encoding: Color + Shape + Line style"</span>)</span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Information preserved even if color is lost"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Redundant Encoding:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>), <span class="at">each =</span> <span class="dv">50</span>)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colors</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Control'</span> <span class="ot">=</span> <span class="st">'#000000'</span>,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment A'</span> <span class="ot">=</span> <span class="st">'#56B4E9'</span>,</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Treatment B'</span> <span class="ot">=</span> <span class="st">'#D55E00'</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Color only</span></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (hours)'</span>, <span class="at">y =</span> <span class="st">'Response'</span>,</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'COLOR ONLY</span><span class="sc">\n</span><span class="st">(Vulnerable if colors indistinguishable)'</span>,</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.85</span>),</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Color + Shape + Line style (redundant)</span></span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> group, <span class="at">linetype =</span> group, <span class="at">shape =</span> group)) <span class="sc">+</span></span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%%</span> <span class="dv">5</span> <span class="sc">==</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'Control'</span> <span class="ot">=</span> <span class="st">'solid'</span>,</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'Treatment A'</span> <span class="ot">=</span> <span class="st">'dashed'</span>,</span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'Treatment B'</span> <span class="ot">=</span> <span class="st">'dotdash'</span>)) <span class="sc">+</span></span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'Control'</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">'Treatment A'</span> <span class="ot">=</span> <span class="dv">15</span>, <span class="st">'Treatment B'</span> <span class="ot">=</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (hours)'</span>, <span class="at">y =</span> <span class="st">'Response'</span>,</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'COLOR + SHAPE + LINE STYLE</span><span class="sc">\n</span><span class="st">(Accessible: multiple redundant cues)'</span>,</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">linetype =</span> <span class="cn">NULL</span>, <span class="at">shape =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.85</span>),</span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2</span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'redundant_encoding_accessibility.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Redundant encoding: Color + Shape + Line style</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Information preserved even if color is lost</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="strategy-3-test-your-figures" class="level4">
<h4 class="anchored" data-anchor-id="strategy-3-test-your-figures">Strategy 3: Test Your Figures</h4>
<p><strong>Don’t guess—simulate how your figures appear to CVD readers</strong></p>
<p><strong>Tools for testing:</strong></p>
<p><strong>1. Color Oracle (Free, Desktop App)</strong></p>
<pre><code>- Windows, Mac, Linux
- Real-time simulation overlay
- Shows Deuteranopia, Protanopia, Tritanopia views
- Download: colororacle.org</code></pre>
<p><strong>2. Coblis (Web-based)</strong></p>
<pre><code>- Upload image, see CVD simulations
- coblis.blogspot.com</code></pre>
<p><strong>3. R Package: colorblindcheck</strong></p>
<pre><code>library(colorblindcheck)

# Test your palette
palette_check(colors, plot = TRUE)</code></pre>
<p><strong>4. Python: colorspacious</strong></p>
<pre><code>from colorspacious import cspace_converter

# Test color pairs for distinguishability</code></pre>
<p><strong>Testing workflow:</strong></p>
<pre><code>1. Create figure with your colors
2. Export as PNG/PDF
3. Open in Color Oracle → Toggle CVD simulation
4. Check: Can you still distinguish all elements?
5. If not: Revise colors or add redundant encoding
6. Repeat until all CVD types are accessible</code></pre>
<hr>
</section>
</section>
<section id="color-integrity-ethical-use-of-color" class="level3">
<h3 class="anchored" data-anchor-id="color-integrity-ethical-use-of-color">Color Integrity: Ethical Use of Color</h3>
<p>Beyond accessibility, <strong>color integrity</strong> means using color honestly—not to mislead or manipulate interpretation.</p>
<section id="integrity-principle-1-no-manipulation-of-color-scales" class="level4">
<h4 class="anchored" data-anchor-id="integrity-principle-1-no-manipulation-of-color-scales">Integrity Principle 1: No Manipulation of Color Scales</h4>
<p><strong>Common manipulations (unethical):</strong></p>
<p><strong>Misleading Technique 1: Non-linear color scales</strong></p>
<pre><code>❌ DISHONEST:
Heatmap where:
- 0-50: Gentle blue gradient (subtle)
- 50-51: Sudden jump to deep red (dramatic)
→ Exaggerates small difference near threshold

✓ HONEST:
Linear or perceptually uniform scale
- Each color step = equal data step</code></pre>
<p><strong>Misleading Technique 2: Asymmetric diverging scales</strong></p>
<pre><code>❌ DISHONEST:
Fold-change heatmap:
- Downregulation: -10x to 0 (wide blue range)
- Upregulation: 0 to +2x (narrow red range)
→ Visually minimizes upregulation

✓ HONEST:
Symmetric scale: -10x to +10x
OR log-transform to make symmetric: log2(-10 to +10)</code></pre>
<p><strong>Code Example (Python) - Honest vs.&nbsp;Dishonest Scales:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression data with range -3 to +3 log2 fold change</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>) <span class="op">*</span> <span class="fl">1.5</span>  <span class="co"># Symmetric around zero</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># DISHONEST: Asymmetric scale (manipulated to emphasize positive)</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(data, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=-</span><span class="dv">3</span>, vmax<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Asymmetric!</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'DISHONEST: Asymmetric Scale</span><span class="ch">\n</span><span class="st">(vmin=-3, vmax=1: exaggerates positives)'</span>,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks([])</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>ax1.set_yticks([])</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(im1, ax<span class="op">=</span>ax1)</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Log2 Fold Change'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>cbar1.ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="co"># HONEST: Symmetric scale</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> np.<span class="bu">abs</span>(data).<span class="bu">max</span>()  <span class="co"># Symmetric limit</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(data, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=-</span>vmax, vmax<span class="op">=</span>vmax)  <span class="co"># Symmetric</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'HONEST: Symmetric Scale</span><span class="ch">\n</span><span class="st">(Equal range for up/down regulation)'</span>,</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks([])</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>ax2.set_yticks([])</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2)</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>cbar2.set_label(<span class="st">'Log2 Fold Change'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>cbar2.ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'color_scale_integrity.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Honest vs.&nbsp;Dishonest Scales:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_matrix)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Row'</span>, <span class="st">'Col'</span>, <span class="st">'FoldChange'</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># DISHONEST: Asymmetric</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> FoldChange)) <span class="sc">+</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'#2166AC'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'#B2182B'</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>),  <span class="co"># Asymmetric!</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Log2</span><span class="sc">\n</span><span class="st">Fold Change'</span>) <span class="sc">+</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'DISHONEST: Asymmetric Scale</span><span class="sc">\n</span><span class="st">(vmin=-3, vmax=1: exaggerates positives)'</span>) <span class="sc">+</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co"># HONEST: Symmetric</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>vmax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(data_long<span class="sc">$</span>FoldChange))</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> FoldChange)) <span class="sc">+</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'#2166AC'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'#B2182B'</span>,</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>vmax, vmax),  <span class="co"># Symmetric</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Log2</span><span class="sc">\n</span><span class="st">Fold Change'</span>) <span class="sc">+</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'HONEST: Symmetric Scale</span><span class="sc">\n</span><span class="st">(Equal range for up/down regulation)'</span>) <span class="sc">+</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">|</span> p2</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'color_scale_integrity.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="integrity-principle-2-consistent-processing-across-groups" class="level4">
<h4 class="anchored" data-anchor-id="integrity-principle-2-consistent-processing-across-groups">Integrity Principle 2: Consistent Processing Across Groups</h4>
<p><strong>The rule:</strong> If you adjust color/contrast/brightness for one image, apply <strong>identical</strong> adjustments to ALL comparison images.</p>
<p><strong>Common violation in microscopy:</strong></p>
<pre><code>❌ DISHONEST:
Control image: Default exposure
Treated image: Increased brightness + contrast → looks more impressive

This is IMAGE MANIPULATION and grounds for retraction

✓ HONEST:
Same exposure settings for all images
Same post-processing (if any) applied uniformly
Document all adjustments in methods</code></pre>
<p><strong>Journal requirements (e.g., Nature, Science, Cell):</strong></p>
<ul>
<li>No manipulation that obscures, eliminates, or misrepresents information</li>
<li>Adjustments (brightness, contrast) must be linear and applied to entire image</li>
<li>Must apply identically to controls and experimental groups</li>
<li>Must disclose all adjustments in methods section</li>
<li>Must provide original, unprocessed images if requested</li>
</ul>
<hr>
</section>
<section id="integrity-principle-3-report-colormap-choices" class="level4">
<h4 class="anchored" data-anchor-id="integrity-principle-3-report-colormap-choices">Integrity Principle 3: Report Colormap Choices</h4>
<p><strong>Transparency requirement:</strong> State your colormap explicitly, especially if non-standard.</p>
<p><strong>In figure caption:</strong></p>
<pre><code>"Heatmap colors represent correlation coefficients (blue = negative,
white = zero, red = positive) using the RdBu diverging colormap."</code></pre>
<p><strong>In methods section:</strong></p>
<pre><code>"All heatmaps were generated using the 'viridis' perceptually uniform
colormap to ensure accessibility for colorblind readers."</code></pre>
<hr>
</section>
</section>
<section id="complete-accessibility-checklist" class="level3">
<h3 class="anchored" data-anchor-id="complete-accessibility-checklist">Complete Accessibility Checklist</h3>
<p><strong>Before submitting your manuscript:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>Colorblind-safe palette</strong> used (Okabe-Ito, ColorBrewer CVD-safe, or tested)</label></li>
<li><label><input type="checkbox"><strong>Redundant encoding</strong> employed (color + shape/line/texture for categories)</label></li>
<li><label><input type="checkbox"><strong>Tested with CVD simulator</strong> (Color Oracle, Coblis, or similar)</label></li>
<li><label><input type="checkbox"><strong>Works in grayscale</strong> (print figure in black &amp; white—still interpretable?)</label></li>
<li><label><input type="checkbox"><strong>Symmetric scales</strong> for diverging data (no manipulation)</label></li>
<li><label><input type="checkbox"><strong>Consistent processing</strong> across comparison groups (microscopy, gels, etc.)</label></li>
<li><label><input type="checkbox"><strong>Colormap documented</strong> in caption or methods</label></li>
<li><label><input type="checkbox"><strong>High contrast</strong> (sufficient for low-vision readers)</label></li>
<li><label><input type="checkbox"><strong>No color-only legends</strong> (combine with labels or patterns)</label></li>
<li><label><input type="checkbox"><strong>Field conventions respected</strong> (unless accessibility requires deviation—state explicitly)</label></li>
</ul>
<hr>
</section>
<section id="exercise-2.7.1-accessibility-audit" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.7.1-accessibility-audit">Exercise 2.7.1: Accessibility Audit</h3>
<p><strong>Objective:</strong> Evaluate and improve accessibility of existing figures</p>
<p><strong>Part A: CVD Testing</strong></p>
<ol type="1">
<li>Find 3 figures from your recent work or literature</li>
<li>Run each through Color Oracle (or Coblis)</li>
<li>For each CVD type (Deuteranopia, Protanopia, Tritanopia), document:
<ul>
<li>Which elements become indistinguishable?</li>
<li>Is critical information lost?</li>
<li>How would you fix it?</li>
</ul></li>
</ol>
<p><strong>Format:</strong></p>
<pre><code>Figure: [Description]
Original colors: [List]

Deuteranopia simulation:
- Problem: "Red and green bars look identical"
- Information lost: "Cannot distinguish Treatment A vs B"
- Fix: "Use blue vs. orange instead" OR "Add patterns to bars"

Accessibility score: [1-5, 5=perfect]
Recommended changes: [List specific actions]</code></pre>
<p><strong>Part B: Redundant Encoding Practice</strong></p>
<p>Take one figure that relies solely on color distinction and redesign it with redundant encoding:</p>
<ol type="1">
<li><strong>Original:</strong> Color only</li>
<li><strong>Redesign:</strong> Color + Shape/Line/Pattern</li>
<li><strong>Test:</strong> Works in grayscale?</li>
<li><strong>Compare:</strong> Side-by-side screenshots</li>
</ol>
<hr>
</section>
<section id="summary-accessibility-integrity-principles" class="level3">
<h3 class="anchored" data-anchor-id="summary-accessibility-integrity-principles">Summary: Accessibility &amp; Integrity Principles</h3>
<p><strong>Accessibility:</strong> - Use colorblind-safe palettes (Okabe-Ito recommended) - Employ redundant encoding (never color alone) - Test with CVD simulators before submission - Ensure grayscale compatibility</p>
<p><strong>Integrity:</strong> - No manipulated color scales (symmetric for diverging data) - Consistent processing across comparison groups - Transparent reporting of colormap choices - Adherence to journal guidelines for image processing</p>
<p><strong>These are not optional—they are ethical requirements for responsible scientific communication.</strong></p>
<hr>
<p><strong>The Language of Color</strong></p>
<p><strong>Key Takeaways:</strong> - <strong>Color theory</strong> provides technical foundation (RGB, CIELAB, perceptual uniformity) - <strong>Palette types</strong> match data types (sequential, diverging, qualitative) - <strong>Saturation hierarchy</strong> directs attention (deep=significant, light=background) - <strong>Restraint and consistency</strong> signal professionalism (3-color max, semantic meaning) - <strong>Field conventions</strong> facilitate interpretation (know and follow or justify deviations) - <strong>Accessibility</strong> is mandatory (CVD-safe palettes, redundant encoding, testing) - <strong>Integrity</strong> is ethical (no manipulation, symmetric scales, transparency)</p>
</section>
</section>
<section id="logical-color-mapping-special-cases-and-edge-scenarios" class="level2">
<h2 class="anchored" data-anchor-id="logical-color-mapping-special-cases-and-edge-scenarios">2.8 Logical Color Mapping: Special Cases and Edge Scenarios</h2>
<section id="the-critical-principle-color-logic-must-match-data-reality" class="level3">
<h3 class="anchored" data-anchor-id="the-critical-principle-color-logic-must-match-data-reality">The Critical Principle: Color Logic Must Match Data Reality</h3>
<p>A common error in scientific figures is applying color schemes that create <strong>false distinctions</strong> or <strong>hide meaningful patterns</strong>. This section addresses edge cases where standard color choices fail logical tests.</p>
<hr>
</section>
<section id="scenario-1-all-values-are-significant" class="level3">
<h3 class="anchored" data-anchor-id="scenario-1-all-values-are-significant">Scenario 1: All Values Are Significant</h3>
<p><strong>The Problem:</strong> When <strong>every data point meets your significance threshold</strong>, using a two-color saturation scheme (deep=significant, light=non-significant) becomes meaningless and misleading.</p>
<section id="case-study-genome-wide-significance" class="level4">
<h4 class="anchored" data-anchor-id="case-study-genome-wide-significance">Case Study: Genome-Wide Significance</h4>
<pre><code>RNA-seq experiment:
- 500 genes tested
- All 500 show p &lt; 0.05 (all significant)
- Fold changes range from +1.2x to +8.5x

❌ WRONG approach:
Use deep red for all genes (because all are "significant")
→ Loses information about magnitude differences
→ Visually monotonous, no hierarchy

✓ CORRECT approach:
Use continuous gradient based on effect size (fold change)
- Light red: Small but significant changes (+1.2x to +2x)
- Medium red: Moderate changes (+2x to +4x)
- Deep red: Large changes (+4x to +8.5x)
→ Color now represents biological importance, not statistical threshold</code></pre>
<p><strong>Logical Reasoning:</strong></p>
<p>When the binary distinction (significant vs.&nbsp;non-significant) provides <strong>no information</strong> (all are significant), you must shift to encoding the <strong>continuous quantitative variable</strong> (effect size, correlation strength, etc.).</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gene expression: ALL significant, varying magnitudes</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>n_genes <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># All genes have significant fold changes (1.2x to 8.5x)</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>fold_changes <span class="op">=</span> np.random.uniform(<span class="fl">1.2</span>, <span class="fl">8.5</span>, (n_genes, n_samples))</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>log2_fc <span class="op">=</span> np.log2(fold_changes)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co"># All p-values &lt; 0.05 (all significant)</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>p_values <span class="op">=</span> np.random.uniform(<span class="fl">0.0001</span>, <span class="fl">0.049</span>, n_genes)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>genes <span class="op">=</span> [<span class="ss">f'Gene</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes)]</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> [<span class="ss">f'S</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples)]</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: Binary coloring (all one color because all significant)</span></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a><span class="co"># All get same deep red (useless)</span></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(log2_fc, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="fl">3.1</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ WRONG: All Significant → All Same Deep Color</span><span class="ch">\n</span><span class="st">(Loses magnitude information)'</span>,</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>ax1.set_yticks(<span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">10</span>))</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>ax1.set_yticklabels([genes[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">10</span>)], fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add misleading note</span></span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">0.5</span>, <span class="fl">1.05</span>, <span class="st">'All genes p &lt; 0.05 → All deep red (uninformative)'</span>,</span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>         transform<span class="op">=</span>ax1.transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a>         style<span class="op">=</span><span class="st">'italic'</span>, color<span class="op">=</span><span class="st">'red'</span>, weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(im1, ax<span class="op">=</span>ax1, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Log₂ Fold Change</span><span class="ch">\n</span><span class="st">(binary: all "significant")'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Continuous gradient based on magnitude</span></span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(log2_fc, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span>np.log2(<span class="fl">1.2</span>), vmax<span class="op">=</span>np.log2(<span class="fl">8.5</span>), aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ CORRECT: Continuous Gradient by Magnitude</span><span class="ch">\n</span><span class="st">(Shows biological importance)'</span>,</span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a>ax2.set_yticks(<span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">10</span>))</span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true" tabindex="-1"></a>ax2.set_yticklabels([genes[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">10</span>)], fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Add explanatory note</span></span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.5</span>, <span class="fl">1.05</span>, <span class="st">'All genes p &lt; 0.05 → Color = effect size (informative)'</span>,</span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true" tabindex="-1"></a>         transform<span class="op">=</span>ax2.transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb111-57"><a href="#cb111-57" aria-hidden="true" tabindex="-1"></a>         style<span class="op">=</span><span class="st">'italic'</span>, color<span class="op">=</span><span class="st">'green'</span>, weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-58"><a href="#cb111-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-59"><a href="#cb111-59" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb111-60"><a href="#cb111-60" aria-hidden="true" tabindex="-1"></a>cbar2.set_label(<span class="st">'Log₂ Fold Change</span><span class="ch">\n</span><span class="st">(continuous magnitude)'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb111-61"><a href="#cb111-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-62"><a href="#cb111-62" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb111-63"><a href="#cb111-63" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'all_significant_color_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb111-64"><a href="#cb111-64" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb111-65"><a href="#cb111-65" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb111-66"><a href="#cb111-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-67"><a href="#cb111-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ When all values significant: encode magnitude, not binary threshold"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data: ALL significant</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>n_genes <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>fold_changes <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_genes <span class="sc">*</span> n_samples, <span class="fl">1.2</span>, <span class="fl">8.5</span>), n_genes, n_samples)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>log2_fc <span class="ot">&lt;-</span> <span class="fu">log2</span>(fold_changes)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co"># All p &lt; 0.05</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_genes, <span class="fl">0.0001</span>, <span class="fl">0.049</span>)</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Gene'</span>, <span class="dv">1</span><span class="sc">:</span>n_genes)</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'S'</span>, <span class="dv">1</span><span class="sc">:</span>n_samples)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(log2_fc) <span class="ot">&lt;-</span> samples</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(log2_fc) <span class="ot">&lt;-</span> genes</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(log2_fc, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">'Gene'</span>, <span class="st">'Sample'</span>), <span class="at">value.name =</span> <span class="st">'Log2FC'</span>)</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: All same deep color (uninformative)</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Log2FC)) <span class="sc">+</span></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'#FEE5D9'</span>, <span class="at">high =</span> <span class="st">'#A50F15'</span>,  <span class="co"># Fixed deep red for "all significant"</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.1</span>),</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Log₂ FC</span><span class="sc">\n</span><span class="st">(binary)'</span>) <span class="sc">+</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ WRONG: All Significant → All Same Deep Color</span><span class="sc">\n</span><span class="st">(Loses magnitude information)'</span>,</span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Samples'</span>, <span class="at">y =</span> <span class="st">'Genes'</span>) <span class="sc">+</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> <span class="fl">4.5</span>, <span class="at">y =</span> <span class="dv">52</span>, <span class="at">label =</span> <span class="st">'All genes p &lt; 0.05 → All deep red (uninformative)'</span>,</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">'italic'</span>, <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Continuous gradient</span></span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Log2FC)) <span class="sc">+</span></span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FFEDA0'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FEB24C'</span>,</span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">'#FD8D3C'</span>, <span class="st">'#FC4E2A'</span>, <span class="st">'#E31A1C'</span>, <span class="st">'#BD0026'</span>),</span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">log2</span>(<span class="fl">1.2</span>), <span class="fu">log2</span>(<span class="fl">8.5</span>)),</span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Log₂ FC</span><span class="sc">\n</span><span class="st">(magnitude)'</span>) <span class="sc">+</span></span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ CORRECT: Continuous Gradient by Magnitude</span><span class="sc">\n</span><span class="st">(Shows biological importance)'</span>,</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Samples'</span>, <span class="at">y =</span> <span class="st">'Genes'</span>) <span class="sc">+</span></span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb112-58"><a href="#cb112-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb112-59"><a href="#cb112-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb112-60"><a href="#cb112-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb112-61"><a href="#cb112-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb112-62"><a href="#cb112-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb112-63"><a href="#cb112-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> <span class="fl">4.5</span>, <span class="at">y =</span> <span class="dv">52</span>, <span class="at">label =</span> <span class="st">'All genes p &lt; 0.05 → Color = effect size (informative)'</span>,</span>
<span id="cb112-64"><a href="#cb112-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">'italic'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>)</span>
<span id="cb112-65"><a href="#cb112-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-66"><a href="#cb112-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb112-67"><a href="#cb112-67" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2</span>
<span id="cb112-68"><a href="#cb112-68" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'all_significant_color_logic.png'</span>, combined, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">12</span>,</span>
<span id="cb112-69"><a href="#cb112-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb112-70"><a href="#cb112-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-71"><a href="#cb112-71" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ When all values significant: encode magnitude, not binary threshold</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="scenario-2-missing-data-in-heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="scenario-2-missing-data-in-heatmaps">Scenario 2: Missing Data in Heatmaps</h3>
<p><strong>The Problem:</strong> Missing values (NA, not measured, failed QC) require a <strong>distinct visual treatment</strong> that doesn’t interfere with your continuous colormap.</p>
<section id="the-logical-rules" class="level4">
<h4 class="anchored" data-anchor-id="the-logical-rules">The Logical Rules:</h4>
<ol type="1">
<li><strong>Never use a color from your gradient</strong> for missing data
<ul>
<li>If gradient is blue-white-red, don’t use gray (looks like “low value”)</li>
<li>Missing ≠ Zero ≠ Low value</li>
</ul></li>
<li><strong>Use a visually distinct, non-data color</strong>
<ul>
<li><strong>Best: Crosshatch/pattern</strong> (universally understood as “no data”)</li>
<li><strong>Good: Distinct color outside gradient</strong> (e.g., black, white with border)</li>
<li><strong>Acceptable: Very light gray with clear border</strong> (if pattern not possible)</li>
</ul></li>
<li><strong>Label explicitly in legend</strong>
<ul>
<li>“Missing/Not measured” with example patch</li>
</ul></li>
</ol>
</section>
<section id="common-mistakes" class="level4">
<h4 class="anchored" data-anchor-id="common-mistakes">Common Mistakes:</h4>
<pre><code>❌ MISTAKE 1: Using gradient color for NA
Gradient: Light blue → Dark blue
Missing data: Light blue or white
→ Looks like "low value" not "absent"

❌ MISTAKE 2: Using zero for NA
Substituting NA with 0 in data
→ Falsely implies measurement of zero

❌ MISTAKE 3: No visual distinction
Leaving cells blank (white) when background is white
→ Invisible, looks like data omission error</code></pre>
<p><strong>Code Example (Python) - Missing Data:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate expression data with missing values</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>n_genes <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randn(n_genes, n_samples) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>  <span class="co"># Mean ~5</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce random missing values (20%)</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>missing_mask <span class="op">=</span> np.random.rand(n_genes, n_samples) <span class="op">&lt;</span> <span class="fl">0.2</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>data_with_na <span class="op">=</span> data.copy()</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>data_with_na[missing_mask] <span class="op">=</span> np.nan</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>genes <span class="op">=</span> [<span class="ss">f'Gene</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes)]</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> [<span class="ss">f'S</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples)]</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD 1: Missing data shown in gradient color (looks like low value)</span></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>data_bad1 <span class="op">=</span> np.nan_to_num(data_with_na, nan<span class="op">=</span><span class="dv">0</span>)  <span class="co"># Replace NA with 0</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(data_bad1, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">10</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: NA → 0 (Looks like real low value)'</span>,</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>ax1.set_yticks(<span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>))</span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>ax1.set_yticklabels([genes[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>)], fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(im1, ax<span class="op">=</span>ax1, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Expression'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD 2: Missing data in white (invisible on white background)</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(data_with_na, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">10</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'❌ BAD: NA → White (Invisible/ambiguous)'</span>,</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>ax2.set_yticks(<span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>))</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>ax2.set_yticklabels([genes[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>)], fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>cbar2.set_label(<span class="st">'Expression'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Missing data with distinct visual (gray + border)</span></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">2</span>]</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data normally</span></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> ax3.imshow(data_with_na, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">10</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay missing data with distinct color + pattern</span></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_genes):</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing_mask[i, j]:</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Draw rectangle with distinct color (gray) and thick black border</span></span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>            rect <span class="op">=</span> Rectangle((j<span class="op">-</span><span class="fl">0.5</span>, i<span class="op">-</span><span class="fl">0.5</span>), <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>                            facecolor<span class="op">=</span><span class="st">'#CCCCCC'</span>,</span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>                            edgecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a>                            linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a>                            hatch<span class="op">=</span><span class="st">'///'</span>)  <span class="co"># Crosshatch pattern</span></span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a>            ax3.add_patch(rect)</span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'✓ GOOD: NA → Distinct Color + Pattern'</span>,</span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a>ax3.set_xticks(<span class="bu">range</span>(n_samples))</span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels(samples, fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a>ax3.set_yticks(<span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>))</span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a>ax3.set_yticklabels([genes[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_genes, <span class="dv">5</span>)], fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom colorbar with NA indicator</span></span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a>cbar3 <span class="op">=</span> plt.colorbar(im3, ax<span class="op">=</span>ax3, fraction<span class="op">=</span><span class="fl">0.046</span>)</span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a>cbar3.set_label(<span class="st">'Expression'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend for missing data</span></span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a>missing_patch <span class="op">=</span> mpatches.Patch(facecolor<span class="op">=</span><span class="st">'#CCCCCC'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>                               hatch<span class="op">=</span><span class="st">'///'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Missing/NA'</span>)</span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a>ax3.legend(handles<span class="op">=</span>[missing_patch], loc<span class="op">=</span><span class="st">'upper right'</span>, fontsize<span class="op">=</span><span class="dv">8</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'missing_data_color_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Missing data requires distinct visual treatment"</span>)</span>
<span id="cb114-93"><a href="#cb114-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Never use gradient colors for NA values"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Missing Data:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data with missing values</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>n_genes <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n_genes <span class="sc">*</span> n_samples, <span class="dv">5</span>, <span class="dv">2</span>), n_genes, n_samples)</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce missing values</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>missing_mask <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_genes <span class="sc">*</span> n_samples) <span class="sc">&lt;</span> <span class="fl">0.2</span>, n_genes, n_samples)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>data_with_na <span class="ot">&lt;-</span> data_matrix</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>data_with_na[missing_mask] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Gene'</span>, <span class="dv">1</span><span class="sc">:</span>n_genes)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'S'</span>, <span class="dv">1</span><span class="sc">:</span>n_samples)</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_with_na) <span class="ot">&lt;-</span> samples</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data_with_na) <span class="ot">&lt;-</span> genes</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_with_na, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">'Gene'</span>, <span class="st">'Sample'</span>), <span class="at">value.name =</span> <span class="st">'Expression'</span>)</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>is_missing <span class="ot">&lt;-</span> <span class="fu">is.na</span>(data_long<span class="sc">$</span>Expression)</span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD 1: Replace NA with 0 (misleading)</span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>data_bad1 <span class="ot">&lt;-</span> data_long</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>data_bad1<span class="sc">$</span>Expression[<span class="fu">is.na</span>(data_bad1<span class="sc">$</span>Expression)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_bad1, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FD8D3C'</span>, <span class="st">'#E31A1C'</span>),</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Expression'</span>) <span class="sc">+</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ BAD: NA → 0 (Looks like real low value)'</span>) <span class="sc">+</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD 2: Missing data invisible (white on white)</span></span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FD8D3C'</span>, <span class="st">'#E31A1C'</span>),</span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Expression'</span>,</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span> <span class="st">'white'</span>) <span class="sc">+</span>  <span class="co"># NA = white (invisible)</span></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ BAD: NA → White (Invisible/ambiguous)'</span>) <span class="sc">+</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Distinct color + pattern for NA</span></span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FD8D3C'</span>, <span class="st">'#E31A1C'</span>),</span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Expression'</span>,</span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na.value =</span> <span class="st">'#CCCCCC'</span>) <span class="sc">+</span>  <span class="co"># NA = distinct gray</span></span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add border for missing cells</span></span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_missing),</span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene),</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">'#CCCCCC'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ GOOD: NA → Distinct Color + Border'</span>,</span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">'Gray cells with black border = Missing/Not measured'</span>) <span class="sc">+</span></span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'italic'</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> (p1 <span class="sc">|</span> p2) <span class="sc">/</span> p3</span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'missing_data_color_logic.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">12</span>,</span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Missing data requires distinct visual treatment</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Never use gradient colors for NA values</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="scenario-3-zero-is-meaningful-vs.-zero-is-arbitrary" class="level3">
<h3 class="anchored" data-anchor-id="scenario-3-zero-is-meaningful-vs.-zero-is-arbitrary">Scenario 3: Zero is Meaningful vs.&nbsp;Zero is Arbitrary</h3>
<p><strong>The Logical Distinction:</strong></p>
<p>Some datasets have a <strong>meaningful zero point</strong> (requires diverging colormap), while others have <strong>arbitrary zero</strong> (requires sequential colormap).</p>
<section id="case-a-meaningful-zero-use-diverging" class="level4">
<h4 class="anchored" data-anchor-id="case-a-meaningful-zero-use-diverging">Case A: Meaningful Zero (Use Diverging)</h4>
<pre><code>Examples where zero has special meaning:
- Fold change: 0 = no change (negative = decrease, positive = increase)
- Temperature anomaly: 0 = average (negative = below, positive = above)
- Financial profit/loss: 0 = break-even
- pH: 7 = neutral (&lt; 7 acidic, &gt; 7 basic)
- Correlation: 0 = no relationship

✓ CORRECT: Diverging colormap (Blue ← White (zero) → Red)</code></pre>
</section>
<section id="case-b-arbitrary-zero-use-sequential" class="level4">
<h4 class="anchored" data-anchor-id="case-b-arbitrary-zero-use-sequential">Case B: Arbitrary Zero (Use Sequential)</h4>
<pre><code>Examples where zero is just lower bound:
- Gene expression (FPKM): 0 = not expressed, but not "negative expression"
- Temperature in Kelvin: 0K is absolute zero, but no "negative temp"
- Count data: 0 = none detected, but no "negative counts"
- Distance: 0 = here, but no "negative distance"

✓ CORRECT: Sequential colormap (Light → Dark single hue)
❌ WRONG: Diverging colormap (implies negative values exist)</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Case A: Fold change (meaningful zero)</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>fold_change_data <span class="op">=</span> np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>) <span class="op">*</span> <span class="dv">2</span>  <span class="co"># Centered at 0</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Case B: Gene expression counts (arbitrary zero, all positive)</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>expression_data <span class="op">=</span> np.<span class="bu">abs</span>(np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>) <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># All positive</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE A - WRONG: Sequential for data with meaningful zero</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(fold_change_data, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=-</span><span class="dv">4</span>, vmax<span class="op">=</span><span class="dv">4</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ WRONG: Sequential for Fold Change</span><span class="ch">\n</span><span class="st">(Zero is meaningful midpoint!)'</span>,</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>ax1, label<span class="op">=</span><span class="st">'Fold Change'</span>)</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks([])</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>ax1.set_yticks([])</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE A - CORRECT: Diverging for data with meaningful zero</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(fold_change_data, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=-</span><span class="dv">4</span>, vmax<span class="op">=</span><span class="dv">4</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ CORRECT: Diverging for Fold Change</span><span class="ch">\n</span><span class="st">(White = no change)'</span>,</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2, label<span class="op">=</span><span class="st">'Fold Change'</span>)</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>cbar2.ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks([])</span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>ax2.set_yticks([])</span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE B - WRONG: Diverging for all-positive data</span></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> ax3.imshow(expression_data, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">6</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'❌ WRONG: Diverging for Expression</span><span class="ch">\n</span><span class="st">(Implies negative values exist)'</span>,</span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im3, ax<span class="op">=</span>ax3, label<span class="op">=</span><span class="st">'Expression (FPKM)'</span>)</span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>ax3.set_xticks([])</span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>ax3.set_yticks([])</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE B - CORRECT: Sequential for all-positive data</span></span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>im4 <span class="op">=</span> ax4.imshow(expression_data, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">6</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'✓ CORRECT: Sequential for Expression</span><span class="ch">\n</span><span class="st">(Zero = lower bound)'</span>,</span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im4, ax<span class="op">=</span>ax4, label<span class="op">=</span><span class="st">'Expression (FPKM)'</span>)</span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>ax4.set_xticks([])</span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>ax4.set_yticks([])</span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'meaningful_zero_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Meaningful zero → Diverging colormap"</span>)</span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Arbitrary zero → Sequential colormap"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Case A: Fold change (meaningful zero)</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>fold_change <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Case B: Expression (arbitrary zero, all positive)</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>expression <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span> <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>fc_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(fold_change)</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fc_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Row'</span>, <span class="st">'Col'</span>, <span class="st">'FoldChange'</span>)</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>expr_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(expression)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(expr_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Row'</span>, <span class="st">'Col'</span>, <span class="st">'Expression'</span>)</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE A - WRONG</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fc_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> FoldChange)) <span class="sc">+</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Fold</span><span class="sc">\n</span><span class="st">Change'</span>) <span class="sc">+</span></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ WRONG: Sequential for Fold Change</span><span class="sc">\n</span><span class="st">(Zero is meaningful midpoint!)'</span>) <span class="sc">+</span></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE A - CORRECT</span></span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fc_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> FoldChange)) <span class="sc">+</span></span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'#2166AC'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'#B2182B'</span>,</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Fold</span><span class="sc">\n</span><span class="st">Change'</span>) <span class="sc">+</span></span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ CORRECT: Diverging for Fold Change</span><span class="sc">\n</span><span class="st">(White = no change)'</span>) <span class="sc">+</span></span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE B - WRONG</span></span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(expr_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'blue'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">3</span>,</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Expression</span><span class="sc">\n</span><span class="st">(FPKM)'</span>) <span class="sc">+</span></span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ WRONG: Diverging for Expression</span><span class="sc">\n</span><span class="st">(Implies negative values exist)'</span>) <span class="sc">+</span></span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a><span class="co"># CASE B - CORRECT</span></span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(expr_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#FFFFCC'</span>, <span class="st">'#FED976'</span>, <span class="st">'#FD8D3C'</span>, <span class="st">'#E31A1C'</span>),</span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">'Expression</span><span class="sc">\n</span><span class="st">(FPKM)'</span>) <span class="sc">+</span></span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ CORRECT: Sequential for Expression</span><span class="sc">\n</span><span class="st">(Zero = lower bound)'</span>) <span class="sc">+</span></span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> (p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4)</span>
<span id="cb119-63"><a href="#cb119-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'meaningful_zero_logic.png'</span>, combined, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb119-64"><a href="#cb119-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb119-65"><a href="#cb119-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-66"><a href="#cb119-66" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Meaningful zero → Diverging colormap</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb119-67"><a href="#cb119-67" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Arbitrary zero → Sequential colormap</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="summary-logical-color-mapping-rules" class="level3">
<h3 class="anchored" data-anchor-id="summary-logical-color-mapping-rules">Summary: Logical Color Mapping Rules</h3>
<p><strong>Rule 1: When significance is universal</strong></p>
<pre><code>If ALL values meet threshold (all p &lt; 0.05):
→ Encode magnitude/effect size with continuous gradient
→ Binary distinction provides no information</code></pre>
<p><strong>Rule 2: Missing data treatment</strong></p>
<pre><code>Missing values require:
→ Color OUTSIDE your gradient (not gray if gradient uses gray)
→ Visual distinction (pattern, border, or unique color)
→ Explicit legend entry: "Missing/Not measured"</code></pre>
<p><strong>Rule 3: Zero point semantics</strong></p>
<pre><code>Meaningful zero (fold change, anomaly):
→ Diverging colormap (blue ← white (zero) → red)

Arbitrary zero (counts, absolute scale):
→ Sequential colormap (light → dark single hue)</code></pre>
<hr>
</section>
<section id="exercise-2.8.1-logical-color-mapping-audit" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2.8.1-logical-color-mapping-audit">Exercise 2.8.1: Logical Color Mapping Audit</h3>
<p><strong>Objective:</strong> Identify and fix logical color mapping errors</p>
<p><strong>Instructions:</strong></p>
<p>For each scenario, determine: 1. What is wrong with the current color scheme? 2. What does the data actually represent? 3. What colormap would be logically correct? 4. Why does the logical choice matter for interpretation?</p>
<p><strong>Scenarios:</strong></p>
<p><strong>A. RNA-seq heatmap</strong> - Data: All 1000 genes have p &lt; 0.01 (all highly significant) - Current coloring: Deep red for all (because all significant) - Fold changes: Range from +1.5x to +12x</p>
<p><strong>B. Spatial temperature map</strong> - Data: Average January temperatures across cities (range: -15°C to +25°C) - Current coloring: Diverging blue-white-red with white at 0°C - Question: Is 0°C meaningful here?</p>
<p><strong>C. Correlation heatmap with missing data</strong> - Data: Pearson correlations (-1 to +1), 15% cells have insufficient data - Current coloring: RdBu diverging, missing cells shown as light blue - Question: What’s the problem?</p>
<p><strong>D. Western blot quantification</strong> - Data: Protein band intensities (arbitrary units, 0-255) - Current coloring: Diverging colormap centered at 128 - Question: Does 128 have special biological meaning?</p>
<p><strong>E. Clinical trial with mixed significance</strong> - Data: 20 endpoints measured, 3 show p&lt;0.05, 17 show p&gt;0.05 - Current coloring: All bars in shades of blue gradient - Question: How should significance be encoded?</p>
<p><strong>Your answers should include:</strong></p>
<pre><code>Scenario [Letter]:

Current approach:
[Describe what they're doing wrong]

Data reality:
[What the numbers actually represent]

Logical issue:
[Why current approach is misleading/uninformative]

Correct solution:
[Specific colormap + justification]

Example:
Scenario A: All significant genes

Current: Deep red for all (binary: significant=red)
Data reality: All p&lt;0.01, fold changes vary 1.5x-12x
Logical issue: Binary coloring loses magnitude information
Correct solution: Continuous yellow-orange-red gradient encoding fold change
  → Light yellow: +1.5x, Deep red: +12x
  → Reader sees biological importance, not just statistical threshold</code></pre>
<hr>
</section>
<section id="scenario-4-cyclic-data-time-of-day-angles-compass-directions" class="level3">
<h3 class="anchored" data-anchor-id="scenario-4-cyclic-data-time-of-day-angles-compass-directions">Scenario 4: Cyclic Data (Time of Day, Angles, Compass Directions)</h3>
<p><strong>The Special Case:</strong> Some data is <strong>cyclic</strong>—the end wraps back to the beginning (e.g., 23:59 wraps to 00:00).</p>
<section id="logical-requirement-cyclic-colormap" class="level4">
<h4 class="anchored" data-anchor-id="logical-requirement-cyclic-colormap">Logical Requirement: Cyclic Colormap</h4>
<p><strong>Data types needing cyclic colormaps:</strong> - Time of day (24-hour clock) - Day of year (Dec 31 → Jan 1) - Compass directions (359° → 0°) - Phase angles (2π → 0) - Seasonal patterns</p>
<p><strong>Standard colormap FAILS:</strong></p>
<pre><code>❌ Sequential colormap (light blue → dark blue):
  - 23:00 appears dark blue (high value)
  - 00:00 appears light blue (low value)
  → False discontinuity! These times are adjacent

✓ Cyclic colormap (e.g., 'twilight', 'hsv'):
  - Start and end colors are perceptually similar
  - Smooth transition across wraparound point</code></pre>
<p><strong>Code Example (Python) - Cyclic Data:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate circadian gene expression (24-hour cycle)</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.5</span>)  <span class="co"># Every 30 min</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>expression <span class="op">=</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> (hours <span class="op">-</span> <span class="dv">6</span>) <span class="op">/</span> <span class="dv">24</span>) <span class="op">+</span> np.random.randn(<span class="bu">len</span>(hours)) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create circular heatmap data (genes x time)</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>n_genes <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>circular_data <span class="op">=</span> np.array([</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> (hours <span class="op">-</span> np.random.randint(<span class="dv">0</span>, <span class="dv">24</span>)) <span class="op">/</span> <span class="dv">24</span>) <span class="op">+</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    np.random.randn(<span class="bu">len</span>(hours)) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_genes)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: Sequential colormap (creates false discontinuity)</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(circular_data, cmap<span class="op">=</span><span class="st">'viridis'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>                 extent<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">0</span>, n_genes])</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time of Day (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Gene'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ WRONG: Sequential for Cyclic Data</span><span class="ch">\n</span><span class="st">(23:00 and 00:00 look unrelated)'</span>,</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'white'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="dv">24</span>, color<span class="op">=</span><span class="st">'white'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="dv">12</span>, n_genes <span class="op">+</span> <span class="fl">0.5</span>, <span class="st">'False boundary at midnight'</span>,</span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(im1, ax<span class="op">=</span>ax1)</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Expression'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Cyclic colormap (twilight - perceptually uniform cyclic)</span></span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(circular_data, cmap<span class="op">=</span><span class="st">'twilight'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>                 extent<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">0</span>, n_genes])</span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Time of Day (hours)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Gene'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ CORRECT: Cyclic Colormap</span><span class="ch">\n</span><span class="st">(Smooth across midnight)'</span>,</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>ax2.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'white'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>ax2.axvline(<span class="dv">24</span>, color<span class="op">=</span><span class="st">'white'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">12</span>, n_genes <span class="op">+</span> <span class="fl">0.5</span>, <span class="st">'Continuous across midnight'</span>,</span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2)</span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>cbar2.set_label(<span class="st">'Expression'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'cyclic_data_colormap.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Cyclic data requires cyclic colormap (twilight, hsv)"</span>)</span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Start and end colors must be perceptually similar"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Cyclic Data:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate circadian data</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>hours <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>n_genes <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>circular_data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n_genes, <span class="cf">function</span>(i) {</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  phase <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">24</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> (hours <span class="sc">-</span> phase) <span class="sc">/</span> <span class="dv">24</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(hours), <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(circular_data)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Time'</span>, <span class="st">'Gene'</span>, <span class="st">'Expression'</span>)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>Time <span class="ot">&lt;-</span> hours[data_long<span class="sc">$</span>Time]</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: Sequential colormap</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">'viridis'</span>, <span class="at">name =</span> <span class="st">'Expression'</span>) <span class="sc">+</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time of Day (hours)'</span>, <span class="at">y =</span> <span class="st">'Gene'</span>,</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'❌ WRONG: Sequential for Cyclic Data</span><span class="sc">\n</span><span class="st">(23:00 and 00:00 look unrelated)'</span>,</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">'False boundary at midnight'</span>) <span class="sc">+</span></span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">face =</span> <span class="st">'italic'</span>),</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Create cyclic palette manually (R doesn't have built-in twilight)</span></span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Using HSV color space for cyclic effect</span></span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>cyclic_colors <span class="ot">&lt;-</span> <span class="fu">hsv</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="at">s =</span> <span class="fl">0.7</span>, <span class="at">v =</span> <span class="fl">0.8</span>)</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> cyclic_colors, <span class="at">name =</span> <span class="st">'Expression'</span>) <span class="sc">+</span></span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>), <span class="at">color =</span> <span class="st">'white'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time of Day (hours)'</span>, <span class="at">y =</span> <span class="st">'Gene'</span>,</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'✓ CORRECT: Cyclic Colormap</span><span class="sc">\n</span><span class="st">(Smooth across midnight)'</span>,</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">'Continuous across midnight'</span>) <span class="sc">+</span></span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">face =</span> <span class="st">'italic'</span>),</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'cyclic_data_colormap.png'</span>, combined, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Cyclic data requires cyclic colormap</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Start and end colors must be perceptually similar</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="scenario-5-multiple-scales-in-one-figure" class="level3">
<h3 class="anchored" data-anchor-id="scenario-5-multiple-scales-in-one-figure">Scenario 5: Multiple Scales in One Figure</h3>
<p><strong>The Problem:</strong> When showing multiple datasets with <strong>different value ranges</strong> in the same figure, color scales must be handled carefully.</p>
<section id="case-a-shared-scale-when-appropriate" class="level4">
<h4 class="anchored" data-anchor-id="case-a-shared-scale-when-appropriate">Case A: Shared Scale (When Appropriate)</h4>
<p><strong>Use when:</strong> - Data types are directly comparable (same units, same meaning) - Relative magnitudes matter - Example: Same gene measured across conditions</p>
<pre><code>✓ CORRECT: Shared color scale
Gene expression (FPKM) in 3 tissues
- All use same scale: 0-100 FPKM
- Direct visual comparison valid</code></pre>
</section>
<section id="case-b-independent-scales-when-necessary" class="level4">
<h4 class="anchored" data-anchor-id="case-b-independent-scales-when-necessary">Case B: Independent Scales (When Necessary)</h4>
<p><strong>Use when:</strong> - Different data types (e.g., temperature vs.&nbsp;precipitation) - Vastly different ranges would obscure one dataset - Example: Gene A (range 1-10) vs.&nbsp;Gene B (range 100-1000)</p>
<pre><code>✓ CORRECT: Independent scales, clearly labeled
- Gene A: 0-10 scale
- Gene B: 0-1000 scale
- State explicitly in caption or on colorbars</code></pre>
<p><strong>Critical Rule:</strong> <strong>Never use same colormap for different scales without explicit labeling</strong></p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Two genes with very different expression ranges</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>gene_low <span class="op">=</span> np.random.uniform(<span class="dv">1</span>, <span class="dv">10</span>, (<span class="dv">10</span>, <span class="dv">10</span>))  <span class="co"># Low expression</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>gene_high <span class="op">=</span> np.random.uniform(<span class="dv">100</span>, <span class="dv">1000</span>, (<span class="dv">10</span>, <span class="dv">10</span>))  <span class="co"># High expression</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co"># MISLEADING: Same colormap, not labeled properly</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(gene_low, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1000</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Gene A (Low Range)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>ax1, label<span class="op">=</span><span class="st">'Expression'</span>)</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(gene_high, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1000</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Gene B (High Range)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im2, ax<span class="op">=</span>ax2, label<span class="op">=</span><span class="st">'Expression'</span>)</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].text(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.15</span>, <span class="st">'❌ MISLEADING: Same scale (Gene A looks uniformly low)'</span>,</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>                transform<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>].transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Independent scales, clearly labeled</span></span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> ax3.imshow(gene_low, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">10</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Gene A (Independent Scale)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>cbar3 <span class="op">=</span> plt.colorbar(im3, ax<span class="op">=</span>ax3)</span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>cbar3.set_label(<span class="st">'Expression</span><span class="ch">\n</span><span class="st">(1-10 FPKM)'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>im4 <span class="op">=</span> ax4.imshow(gene_high, cmap<span class="op">=</span><span class="st">'Reds'</span>, vmin<span class="op">=</span><span class="dv">100</span>, vmax<span class="op">=</span><span class="dv">1000</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Gene B (Independent Scale)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>cbar4 <span class="op">=</span> plt.colorbar(im4, ax<span class="op">=</span>ax4)</span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>cbar4.set_label(<span class="st">'Expression</span><span class="ch">\n</span><span class="st">(100-1000 FPKM)'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].text(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.15</span>, <span class="st">'✓ CORRECT: Independent scales, clearly labeled'</span>,</span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a>                transform<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>].transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flat:</span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'multiple_scales_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Multiple scales require explicit labeling"</span>)</span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ State ranges clearly in captions and colorbars"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Two genes with different ranges</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>gene_low <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>gene_high <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">1000</span>), <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>low_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(gene_low)</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(low_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Row'</span>, <span class="st">'Col'</span>, <span class="st">'Expression'</span>)</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>low_long<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="st">'Gene A'</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>high_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(gene_high)</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(high_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Row'</span>, <span class="st">'Col'</span>, <span class="st">'Expression'</span>)</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>high_long<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="st">'Gene B'</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="co"># MISLEADING: Same scale</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>p1_low <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(low_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Expression'</span>) <span class="sc">+</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Gene A (Low Range)'</span>,</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'❌ MISLEADING: Same scale'</span>) <span class="sc">+</span></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>p2_high <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(high_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Expression'</span>) <span class="sc">+</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Gene B (High Range)'</span>,</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'(Gene A looks uniformly low)'</span>) <span class="sc">+</span></span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">'italic'</span>))</span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Independent scales</span></span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>p3_low <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(low_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Expression</span><span class="sc">\n</span><span class="st">(1-10 FPKM)'</span>) <span class="sc">+</span></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Gene A (Independent Scale)'</span>,</span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'✓ CORRECT: Scale optimized'</span>) <span class="sc">+</span></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a>p4_high <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(high_long, <span class="fu">aes</span>(<span class="at">x =</span> Col, <span class="at">y =</span> Row, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'red'</span>,</span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>),</span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Expression</span><span class="sc">\n</span><span class="st">(100-1000 FPKM)'</span>) <span class="sc">+</span></span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Gene B (Independent Scale)'</span>,</span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">'(Clearly labeled)'</span>) <span class="sc">+</span></span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">'italic'</span>))</span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> (p1_low <span class="sc">|</span> p2_high) <span class="sc">/</span> (p3_low <span class="sc">|</span> p4_high)</span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'multiple_scales_logic.png'</span>, combined, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Multiple scales require explicit labeling</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ State ranges clearly in captions and colorbars</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="complete-logical-color-mapping-checklist" class="level3">
<h3 class="anchored" data-anchor-id="complete-logical-color-mapping-checklist">Complete Logical Color Mapping Checklist</h3>
<p><strong>Before finalizing figures with complex color schemes:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>If all values meet threshold</strong> (e.g., all significant): Encode magnitude, not binary</label></li>
<li><label><input type="checkbox"><strong>Missing data</strong> uses color OUTSIDE gradient + clear visual distinction</label></li>
<li><label><input type="checkbox"><strong>Zero point checked</strong>: Meaningful zero → Diverging; Arbitrary zero → Sequential</label></li>
<li><label><input type="checkbox"><strong>Cyclic data</strong> (time, angles): Use cyclic colormap (twilight, hsv)</label></li>
<li><label><input type="checkbox"><strong>Multiple scales</strong>: Each clearly labeled or use shared scale if appropriate</label></li>
<li><label><input type="checkbox"><strong>Asymmetric scales</strong> avoided (unless data truly asymmetric)</label></li>
<li><label><input type="checkbox"><strong>Legend explicitly states</strong> what each color represents</label></li>
<li><label><input type="checkbox"><strong>Figure caption documents</strong> colormap choice and scale ranges</label></li>
</ul>
<hr>
</section>
<section id="summary-advanced-color-logic" class="level3">
<h3 class="anchored" data-anchor-id="summary-advanced-color-logic">Summary: Advanced Color Logic</h3>
<p><strong>The Core Principle:</strong> Color mapping must reflect data structure, not override it</p>
<p><strong>Common Violations:</strong> 1. Binary coloring when all values are in same category 2. Using gradient colors for missing data 3. Diverging colormap for data without meaningful center 4. Sequential colormap for cyclic data 5. Identical colormaps for vastly different scales without labeling</p>
<p><strong>The Solution:</strong> - Match colormap type to data structure - Explicitly handle edge cases (NA, all significant, etc.) - Label everything clearly - Test interpretation: Can reader understand without reading caption?</p>
<hr>
</section>
<section id="color-palette-design-principles" class="level3">
<h3 class="anchored" data-anchor-id="color-palette-design-principles"><strong>2.8 Color Palette Design Principles</strong></h3>
<p><strong>Core Principle:</strong> One figure page should contain <strong>3 colors ideally, maximum 5 colors</strong> (excluding specialized plots like UMAPs where categorical distinctions require more).</p>
</section>
<section id="rule-1-the-3-5-color-maximum" class="level3">
<h3 class="anchored" data-anchor-id="rule-1-the-3-5-color-maximum"><strong>Rule 1: The 3-5 Color Maximum</strong></h3>
<p><strong>Scientific Principle:</strong> Human working memory effectively tracks 3-5 distinct categories simultaneously. Beyond this, cognitive load increases exponentially.</p>
<p><strong>Application:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: 3-color palette (ideal)</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>IDEAL_PALETTE <span class="op">=</span> {</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WT'</span>: <span class="st">'#7F8C8D'</span>,        <span class="co"># Wild-type: neutral gray</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KO'</span>: <span class="st">'#E74C3C'</span>,        <span class="co"># Knockout: red (problem/loss)</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rescue'</span>: <span class="st">'#3498DB'</span>     <span class="co"># Rescue: blue (restoration)</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Gene expression comparison</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [<span class="st">'WT'</span>, <span class="st">'KO'</span>, <span class="st">'Rescue'</span>]</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">45</span>, <span class="dv">92</span>]  <span class="co"># Relative expression</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>]</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Good example (3 colors)</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>colors_good <span class="op">=</span> [IDEAL_PALETTE[c] <span class="cf">for</span> c <span class="kw">in</span> conditions]</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax1.bar(conditions, values, yerr<span class="op">=</span>errors, capsize<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>colors_good, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Relative Expression (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'✓ GOOD: 3 Colors</span><span class="ch">\n</span><span class="st">(Clear, memorable)'</span>,</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add interpretation annotations</span></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>ax1.annotate(<span class="st">''</span>, xy<span class="op">=</span>(<span class="dv">0</span>, values[<span class="dv">0</span>]), xytext<span class="op">=</span>(<span class="dv">1</span>, values[<span class="dv">1</span>]),</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'&lt;-&gt;'</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">0.5</span>, (values[<span class="dv">0</span>]<span class="op">+</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">10</span>, <span class="st">'Loss of</span><span class="ch">\n</span><span class="st">function'</span>,</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>        ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, style<span class="op">=</span><span class="st">'italic'</span>)</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Too many colors example</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>conditions_bad <span class="op">=</span> [<span class="st">'WT'</span>, <span class="st">'KO1'</span>, <span class="st">'KO2'</span>, <span class="st">'Rescue1'</span>, <span class="st">'Rescue2'</span>,</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Combination'</span>]</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>values_bad <span class="op">=</span> np.random.randint(<span class="dv">40</span>, <span class="dv">100</span>, <span class="bu">len</span>(conditions_bad))</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>colors_bad <span class="op">=</span> plt.cm.tab10(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(conditions_bad)))</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax2.bar(<span class="bu">range</span>(<span class="bu">len</span>(conditions_bad)), values_bad,</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>colors_bad, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, width<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(conditions_bad)))</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(conditions_bad, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Relative Expression (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'❌ BAD: 8 Colors</span><span class="ch">\n</span><span class="st">(Overwhelming, hard to distinguish)'</span>,</span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'color_rule_3to5.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ 3-5 color rule demonstrated"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>When you MUST use &gt;5 colors (e.g., UMAP clustering):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution: Use numbers/labels instead of relying solely on color</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Circle</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate UMAP with 15 clusters</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>n_cells <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>umap1 <span class="op">=</span> np.random.randn(n_cells) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>umap2 <span class="op">=</span> np.random.randn(n_cells) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>clusters <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">15</span>, n_cells)</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Color only (hard to distinguish)</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>scatter1 <span class="op">=</span> ax1.scatter(umap1, umap2, c<span class="op">=</span>clusters, cmap<span class="op">=</span><span class="st">'tab20'</span>,</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>                       s<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'UMAP 1'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'UMAP 2'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ 15 Clusters: Color Only</span><span class="ch">\n</span><span class="st">(Hard to match legend)'</span>,</span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>cbar1 <span class="op">=</span> plt.colorbar(scatter1, ax<span class="op">=</span>ax1)</span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>cbar1.set_label(<span class="st">'Cluster ID'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Color + numbered labels (clear)</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>scatter2 <span class="op">=</span> ax2.scatter(umap1, umap2, c<span class="op">=</span>clusters, cmap<span class="op">=</span><span class="st">'tab20'</span>,</span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>                       s<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster number labels at centroids</span></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> clusters <span class="op">==</span> cluster_id</span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.<span class="bu">sum</span>(mask) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>        centroid_x <span class="op">=</span> umap1[mask].mean()</span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>        centroid_y <span class="op">=</span> umap2[mask].mean()</span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># White circle background for visibility</span></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>        circle <span class="op">=</span> Circle((centroid_x, centroid_y), radius<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>                       facecolor<span class="op">=</span><span class="st">'white'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>                       linewidth<span class="op">=</span><span class="dv">2</span>, zorder<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>        ax2.add_patch(circle)</span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cluster number</span></span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>        ax2.text(centroid_x, centroid_y, <span class="bu">str</span>(cluster_id),</span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>                fontweight<span class="op">=</span><span class="st">'bold'</span>, zorder<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'UMAP 1'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'UMAP 2'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ BETTER: Color + Numbers</span><span class="ch">\n</span><span class="st">(Easy to reference)'</span>,</span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'many_clusters_solution.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="rule-2-color-harmony---avoid-deep-light-mixing" class="level3">
<h3 class="anchored" data-anchor-id="rule-2-color-harmony---avoid-deep-light-mixing"><strong>Rule 2: Color Harmony - Avoid Deep + Light Mixing</strong></h3>
<p><strong>Principle:</strong> Mixing very dark and very light colors creates harsh, unbalanced contrast that looks unprofessional.</p>
<p><strong>Solution:</strong> Keep colors within similar lightness ranges, or balance proportions intentionally.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> colors <span class="im">as</span> mcolors</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD Example: Deep + Light mixing (unbalanced)</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>bad_colors <span class="op">=</span> [<span class="st">'#1A1A1A'</span>, <span class="st">'#EFEFEF'</span>, <span class="st">'#2C3E50'</span>, <span class="st">'#ECF0F1'</span>]  <span class="co"># Very dark + very light</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>bad_labels <span class="op">=</span> [<span class="st">'Very Dark'</span>, <span class="st">'Very Light'</span>, <span class="st">'Dark'</span>, <span class="st">'Light'</span>]</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (c, label) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bad_colors, bad_labels)):</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i<span class="op">*</span><span class="fl">2.5</span>, <span class="dv">0</span>), <span class="dv">2</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>c,</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>                             edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    ax1.add_patch(rect)</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate lightness</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>    rgb <span class="op">=</span> mcolors.hex2color(c)</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>    lightness <span class="op">=</span> <span class="fl">0.299</span><span class="op">*</span>rgb[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.587</span><span class="op">*</span>rgb[<span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.114</span><span class="op">*</span>rgb[<span class="dv">2</span>]</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>    ax1.text(i<span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="ss">f'</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">L=</span><span class="sc">{</span>lightness<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> lightness <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span>)</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>ax1.set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: Deep + Light Mixing (Harsh Contrast, L range: 0.07-0.94)'</span>,</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>ax1.axis(<span class="st">'off'</span>)</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD Example: Balanced lightness</span></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>good_colors <span class="op">=</span> [<span class="st">'#7F8C8D'</span>, <span class="st">'#3498DB'</span>, <span class="st">'#E74C3C'</span>, <span class="st">'#27AE60'</span>]  <span class="co"># Balanced</span></span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>good_labels <span class="op">=</span> [<span class="st">'Gray'</span>, <span class="st">'Blue'</span>, <span class="st">'Red'</span>, <span class="st">'Green'</span>]</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (c, label) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(good_colors, good_labels)):</span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i<span class="op">*</span><span class="fl">2.5</span>, <span class="dv">0</span>), <span class="dv">2</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>c,</span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>                             edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a>    ax2.add_patch(rect)</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a>    rgb <span class="op">=</span> mcolors.hex2color(c)</span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a>    lightness <span class="op">=</span> <span class="fl">0.299</span><span class="op">*</span>rgb[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.587</span><span class="op">*</span>rgb[<span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.114</span><span class="op">*</span>rgb[<span class="dv">2</span>]</span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a>    ax2.text(i<span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="ss">f'</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">L=</span><span class="sc">{</span>lightness<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: Balanced Lightness (L range: 0.35-0.55)'</span>,</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a>ax2.axis(<span class="st">'off'</span>)</span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a><span class="co"># ACCEPTABLE: Intentional gradient (if needed)</span></span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">2</span>]</span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a>gradient_colors <span class="op">=</span> [<span class="st">'#D6EAF8'</span>, <span class="st">'#85C1E9'</span>, <span class="st">'#3498DB'</span>, <span class="st">'#21618C'</span>, <span class="st">'#1B4F72'</span>]  <span class="co"># Blue gradient</span></span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a>gradient_labels <span class="op">=</span> [<span class="st">'Very Light'</span>, <span class="st">'Light'</span>, <span class="st">'Medium'</span>, <span class="st">'Dark'</span>, <span class="st">'Very Dark'</span>]</span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (c, label) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(gradient_colors, gradient_labels)):</span>
<span id="cb133-61"><a href="#cb133-61" aria-hidden="true" tabindex="-1"></a>    rect <span class="op">=</span> mpatches.Rectangle((i<span class="op">*</span><span class="dv">2</span>, <span class="dv">0</span>), <span class="fl">1.8</span>, <span class="dv">1</span>, facecolor<span class="op">=</span>c,</span>
<span id="cb133-62"><a href="#cb133-62" aria-hidden="true" tabindex="-1"></a>                             edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb133-63"><a href="#cb133-63" aria-hidden="true" tabindex="-1"></a>    ax3.add_patch(rect)</span>
<span id="cb133-64"><a href="#cb133-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-65"><a href="#cb133-65" aria-hidden="true" tabindex="-1"></a>    rgb <span class="op">=</span> mcolors.hex2color(c)</span>
<span id="cb133-66"><a href="#cb133-66" aria-hidden="true" tabindex="-1"></a>    lightness <span class="op">=</span> <span class="fl">0.299</span><span class="op">*</span>rgb[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.587</span><span class="op">*</span>rgb[<span class="dv">1</span>] <span class="op">+</span> <span class="fl">0.114</span><span class="op">*</span>rgb[<span class="dv">2</span>]</span>
<span id="cb133-67"><a href="#cb133-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-68"><a href="#cb133-68" aria-hidden="true" tabindex="-1"></a>    ax3.text(i<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="ss">f'</span><span class="sc">{</span>label<span class="sc">}</span><span class="ch">\n</span><span class="ss">L=</span><span class="sc">{</span>lightness<span class="sc">:.2f}</span><span class="ss">'</span>,</span>
<span id="cb133-69"><a href="#cb133-69" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb133-70"><a href="#cb133-70" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">'white'</span> <span class="cf">if</span> lightness <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'black'</span>)</span>
<span id="cb133-71"><a href="#cb133-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-72"><a href="#cb133-72" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb133-73"><a href="#cb133-73" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb133-74"><a href="#cb133-74" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'✓ ACCEPTABLE: Intentional Gradient (Single Hue Family, Smooth Transition)'</span>,</span>
<span id="cb133-75"><a href="#cb133-75" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb133-76"><a href="#cb133-76" aria-hidden="true" tabindex="-1"></a>ax3.axis(<span class="st">'off'</span>)</span>
<span id="cb133-77"><a href="#cb133-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-78"><a href="#cb133-78" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb133-79"><a href="#cb133-79" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'color_balance_lightness.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb133-80"><a href="#cb133-80" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="rule-3-biological-logic-in-color-assignment" class="level3">
<h3 class="anchored" data-anchor-id="rule-3-biological-logic-in-color-assignment"><strong>Rule 3: Biological Logic in Color Assignment</strong></h3>
<p><strong>Principle:</strong> Colors should follow scientific conventions and intuitive associations.</p>
<p><strong>Examples:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. WT, KO, Rescue: Color proximity reflects biological relationship</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>BIOLOGICAL_LOGIC <span class="op">=</span> {</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WT'</span>: <span class="st">'#7F8C8D'</span>,      <span class="co"># Wild-type: neutral gray (baseline)</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rescue'</span>: <span class="st">'#5D6D7E'</span>,  <span class="co"># Rescue: similar gray (close to WT) ← KEY POINT</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KO'</span>: <span class="st">'#E74C3C'</span>       <span class="co"># Knockout: red (different/problem)</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># → WT and Rescue should have SIMILAR colors (both are functional states)</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Disease severity: Darker = more severe (intuitive)</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>DISEASE_SEVERITY <span class="op">=</span> {</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Healthy'</span>: <span class="st">'#D5F4E6'</span>,      <span class="co"># Very light green</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mild'</span>: <span class="st">'#82E0AA'</span>,         <span class="co"># Light green</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Moderate'</span>: <span class="st">'#F39C12'</span>,     <span class="co"># Orange (warning)</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Severe'</span>: <span class="st">'#E67E22'</span>,       <span class="co"># Dark orange</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Critical'</span>: <span class="st">'#C0392B'</span>      <span class="co"># Dark red (danger)</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Traffic light convention: Red=stop/problem, Green=go/healthy</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>INTUITIVE_ASSOCIATIONS <span class="op">=</span> {</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Control'</span>: <span class="st">'#27AE60'</span>,      <span class="co"># Green = healthy/baseline</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Disease'</span>: <span class="st">'#E74C3C'</span>,      <span class="co"># Red = problem</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment'</span>: <span class="st">'#3498DB'</span>     <span class="co"># Blue = intervention</span></span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Temperature: Blue=cold, Red=hot</span></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>TEMPERATURE_SCALE <span class="op">=</span> {</span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cold'</span>: <span class="st">'#3498DB'</span>,</span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'warm'</span>: <span class="st">'#F39C12'</span>,</span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hot'</span>: <span class="st">'#E74C3C'</span></span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example: WT-KO-Rescue Color Logic</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: KO and Rescue have similar colors (confusing relationship)</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>conditions_bad <span class="op">=</span> [<span class="st">'WT'</span>, <span class="st">'KO'</span>, <span class="st">'Rescue'</span>]</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>values_bad <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">45</span>, <span class="dv">95</span>]</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>colors_bad <span class="op">=</span> [<span class="st">'#7F8C8D'</span>, <span class="st">'#E74C3C'</span>, <span class="st">'#C0392B'</span>]  <span class="co"># KO and Rescue both reddish!</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax1.bar(conditions_bad, values_bad, color<span class="op">=</span>colors_bad,</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>               edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Function (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: KO and Rescue Look Similar</span><span class="ch">\n</span><span class="st">(Implies they are related states)'</span>,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>ax1.axhline(<span class="dv">100</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">2.5</span>, <span class="dv">102</span>, <span class="st">'WT baseline'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, style<span class="op">=</span><span class="st">'italic'</span>)</span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: WT and Rescue similar (both functional), KO different</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>conditions_good <span class="op">=</span> [<span class="st">'WT'</span>, <span class="st">'KO'</span>, <span class="st">'Rescue'</span>]</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>values_good <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">45</span>, <span class="dv">95</span>]</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>colors_good <span class="op">=</span> [<span class="st">'#7F8C8D'</span>, <span class="st">'#E74C3C'</span>, <span class="st">'#5D6D7E'</span>]  <span class="co"># WT and Rescue similar grays!</span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax2.bar(conditions_good, values_good, color<span class="op">=</span>colors_good,</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>               edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Function (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: WT and Rescue Similar Colors</span><span class="ch">\n</span><span class="st">(Correctly shows functional relationship)'</span>,</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>ax2.axhline(<span class="dv">100</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotations showing color logic</span></span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a>ax2.annotate(<span class="st">''</span>, xy<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">110</span>), xytext<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">110</span>),</span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'&lt;-&gt;'</span>, color<span class="op">=</span><span class="st">'green'</span>, lw<span class="op">=</span><span class="dv">3</span>))</span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">1</span>, <span class="dv">113</span>, <span class="st">'Similar colors =</span><span class="ch">\n</span><span class="st">Similar function'</span>, ha<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>,</span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightgreen'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a>ax2.annotate(<span class="st">''</span>, xy<span class="op">=</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">8</span>), xytext<span class="op">=</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">8</span>),</span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">1</span>, <span class="op">-</span><span class="dv">12</span>, <span class="st">'Different color =</span><span class="ch">\n</span><span class="st">Loss of function'</span>, ha<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#FFCCCC'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'wt_ko_rescue_color_logic.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="rule-4-namissing-data-color-strategy" class="level3">
<h3 class="anchored" data-anchor-id="rule-4-namissing-data-color-strategy"><strong>Rule 4: NA/Missing Data Color Strategy</strong></h3>
<p><strong>Principle:</strong> NA colors must be distinguishable and EXCLUDED from the main color scheme.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data with missing values</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Gene'</span>: [<span class="ss">f'Gene</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">26</span>)],</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample1'</span>: np.random.randn(<span class="dv">25</span>),</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample2'</span>: np.random.randn(<span class="dv">25</span>),</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample3'</span>: np.random.randn(<span class="dv">25</span>),</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sample4'</span>: np.random.randn(<span class="dv">25</span>)</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data).set_index(<span class="st">'Gene'</span>)</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce NA values</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">3</span>:<span class="dv">6</span>, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">10</span>:<span class="dv">12</span>, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">18</span>, <span class="dv">3</span>] <span class="op">=</span> np.nan</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: NA color within main palette (confusing)</span></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>data_for_plot <span class="op">=</span> df.fillna(<span class="op">-</span><span class="dv">999</span>)  <span class="co"># Sentinel value</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(data_for_plot, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>                 vmin<span class="op">=-</span><span class="dv">2</span>, vmax<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: NA Blends with Data</span><span class="ch">\n</span><span class="st">(Can</span><span class="ch">\'</span><span class="st">t distinguish missing values)'</span>,</span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(<span class="bu">range</span>(<span class="dv">4</span>))</span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels([<span class="st">'Sample1'</span>, <span class="st">'Sample2'</span>, <span class="st">'Sample3'</span>, <span class="st">'Sample4'</span>], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>ax1, label<span class="op">=</span><span class="st">'Expression (Z-score)'</span>)</span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: NA in distinct color (crosshatch or gray)</span></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create masked array</span></span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a>data_masked <span class="op">=</span> np.ma.masked_where(np.isnan(df.values), df.values)</span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(data_masked, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>                 vmin<span class="op">=-</span><span class="dv">2</span>, vmax<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add gray rectangles for NA values</span></span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(df.shape[<span class="dv">0</span>]):</span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(df.shape[<span class="dv">1</span>]):</span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.isnan(df.values[i, j]):</span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>            ax2.add_patch(plt.Rectangle((j<span class="op">-</span><span class="fl">0.5</span>, i<span class="op">-</span><span class="fl">0.5</span>), <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a>                                       facecolor<span class="op">=</span><span class="st">'#D3D3D3'</span>,</span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a>                                       edgecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a>                                       linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a>                                       hatch<span class="op">=</span><span class="st">'///'</span>,</span>
<span id="cb136-56"><a href="#cb136-56" aria-hidden="true" tabindex="-1"></a>                                       fill<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb136-57"><a href="#cb136-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-58"><a href="#cb136-58" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: NA in Distinct Color</span><span class="ch">\n</span><span class="st">(Crosshatch pattern, separate from scale)'</span>,</span>
<span id="cb136-59"><a href="#cb136-59" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb136-60"><a href="#cb136-60" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb136-61"><a href="#cb136-61" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Genes'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb136-62"><a href="#cb136-62" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(<span class="bu">range</span>(<span class="dv">4</span>))</span>
<span id="cb136-63"><a href="#cb136-63" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels([<span class="st">'Sample1'</span>, <span class="st">'Sample2'</span>, <span class="st">'Sample3'</span>, <span class="st">'Sample4'</span>], rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb136-64"><a href="#cb136-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-65"><a href="#cb136-65" aria-hidden="true" tabindex="-1"></a>cbar2 <span class="op">=</span> plt.colorbar(im2, ax<span class="op">=</span>ax2, label<span class="op">=</span><span class="st">'Expression (Z-score)'</span>)</span>
<span id="cb136-66"><a href="#cb136-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-67"><a href="#cb136-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Add NA legend</span></span>
<span id="cb136-68"><a href="#cb136-68" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb136-69"><a href="#cb136-69" aria-hidden="true" tabindex="-1"></a>na_patch <span class="op">=</span> Patch(facecolor<span class="op">=</span><span class="st">'#D3D3D3'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb136-70"><a href="#cb136-70" aria-hidden="true" tabindex="-1"></a>                hatch<span class="op">=</span><span class="st">'///'</span>, label<span class="op">=</span><span class="st">'NA / Missing'</span>)</span>
<span id="cb136-71"><a href="#cb136-71" aria-hidden="true" tabindex="-1"></a>ax2.legend(handles<span class="op">=</span>[na_patch], loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb136-72"><a href="#cb136-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-73"><a href="#cb136-73" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb136-74"><a href="#cb136-74" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'na_color_strategy.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb136-75"><a href="#cb136-75" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R Equivalent:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with NAs</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gene =</span> <span class="fu">paste0</span>(<span class="st">'Gene'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>),</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> <span class="fu">paste0</span>(<span class="st">'Sample'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expression =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>()))</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce NAs</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Expression[<span class="dv">30</span><span class="sc">:</span><span class="dv">35</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Expression[<span class="dv">60</span><span class="sc">:</span><span class="dv">62</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with distinct NA handling</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Sample, <span class="at">y =</span> Gene, <span class="at">fill =</span> Expression)) <span class="sc">+</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main color scale (for non-NA values)</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'#3498DB'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'#E74C3C'</span>,</span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">na.value =</span> <span class="st">'#D3D3D3'</span>,  <span class="co"># Gray for NA</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">'Expression</span><span class="sc">\n</span><span class="st">(Z-score)'</span>) <span class="sc">+</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add pattern to NA tiles (requires ggpattern package)</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># library(ggpattern)</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_tile_pattern(data = filter(data, is.na(Expression)),</span></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                   pattern = 'crosshatch', pattern_density = 0.5,</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                   fill = '#D3D3D3', color = 'black', size = 1) +</span></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ NA Values in Distinct Gray (Separate from Scale)'</span>,</span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Samples'</span>, <span class="at">y =</span> <span class="st">'Genes'</span>) <span class="sc">+</span></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>),</span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'right'</span></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'na_color_strategy_r.png'</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="rule-5-sequential-colors---single-hue-families" class="level3">
<h3 class="anchored" data-anchor-id="rule-5-sequential-colors---single-hue-families"><strong>Rule 5: Sequential Colors - Single Hue Families</strong></h3>
<p><strong>When to use:</strong> Continuous data (e.g., expression levels, concentrations, counts)</p>
<p><strong>Principle:</strong> Use gradations of a <strong>single hue</strong> to show magnitude, not rainbow colors.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> LinearSegmentedColormap</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate continuous data (e.g., gene expression)</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">10</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">5</span>))</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Rainbow (not perceptually uniform, no clear magnitude)</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(data, cmap<span class="op">=</span><span class="st">'jet'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: Rainbow</span><span class="ch">\n</span><span class="st">(Unclear magnitude progression)'</span>,</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>ax1, label<span class="op">=</span><span class="st">'Expression'</span>)</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Single hue gradient (clear magnitude)</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(data, cmap<span class="op">=</span><span class="st">'Blues'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: Single Hue (Blue)</span><span class="ch">\n</span><span class="st">(Clear: Light → Dark = Low → High)'</span>,</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im2, ax<span class="op">=</span>ax2, label<span class="op">=</span><span class="st">'Expression'</span>)</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ALSO GOOD: Custom single-hue gradient</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">2</span>]</span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>colors_custom <span class="op">=</span> [<span class="st">'#FFFFFF'</span>, <span class="st">'#EBF5FB'</span>, <span class="st">'#D6EAF8'</span>, <span class="st">'#AED6F1'</span>,</span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">'#85C1E9'</span>, <span class="st">'#5DADE2'</span>, <span class="st">'#3498DB'</span>, <span class="st">'#2E86C1'</span>,</span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">'#2874A6'</span>, <span class="st">'#21618C'</span>]</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>cmap_custom <span class="op">=</span> LinearSegmentedColormap.from_list(<span class="st">'custom_blues'</span>, colors_custom)</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> ax3.imshow(data, cmap<span class="op">=</span>cmap_custom, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'✓ ALSO GOOD: Custom Blue Gradient</span><span class="ch">\n</span><span class="st">(Smooth progression)'</span>,</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im3, ax<span class="op">=</span>ax3, label<span class="op">=</span><span class="st">'Expression'</span>)</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'sequential_color_single_hue.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="shape-selection-and-usage-new-section" class="level2">
<h2 class="anchored" data-anchor-id="shape-selection-and-usage-new-section"><strong>2.9 Shape Selection and Usage (NEW SECTION)</strong></h2>
<section id="rule-shape-must-provide-clear-contrast" class="level3">
<h3 class="anchored" data-anchor-id="rule-shape-must-provide-clear-contrast"><strong>Rule: Shape Must Provide Clear Contrast</strong></h3>
<p><strong>Principle:</strong> Regular vs.&nbsp;irregular shapes, filled vs.&nbsp;open - use contrast to distinguish groups.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for different conditions</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Treatment A'</span>, <span class="st">'Treatment B'</span>, <span class="st">'Treatment C'</span>]</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>n_points <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Similar shapes (hard to distinguish)</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>shapes_bad <span class="op">=</span> [<span class="st">'o'</span>, <span class="st">'s'</span>, <span class="st">'^'</span>, <span class="st">'v'</span>]  <span class="co"># All filled, similar sizes</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (cond, marker) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(conditions, shapes_bad)):</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.random.randn(n_points) <span class="op">+</span> i<span class="op">*</span><span class="dv">2</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.randn(n_points)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>    ax1.scatter(x, y, s<span class="op">=</span><span class="dv">80</span>, marker<span class="op">=</span>marker, color<span class="op">=</span><span class="st">'#3498DB'</span>,</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>               alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span>cond)</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Variable X'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Variable Y'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: Subtle Shape Differences</span><span class="ch">\n</span><span class="st">(Hard to distinguish quickly)'</span>,</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Contrasting shapes (easy to distinguish)</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>shapes_good <span class="op">=</span> [<span class="st">'o'</span>, <span class="st">'s'</span>, <span class="st">'^'</span>, <span class="st">'D'</span>]  <span class="co"># Mix of regular shapes</span></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>fills <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>]  <span class="co"># Alternate filled/open</span></span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a>colors_contrast <span class="op">=</span> [<span class="st">'#3498DB'</span>, <span class="st">'#3498DB'</span>, <span class="st">'#E74C3C'</span>, <span class="st">'#E74C3C'</span>]</span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (cond, marker, filled, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(conditions, shapes_good, fills, colors_contrast)):</span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.random.randn(n_points) <span class="op">+</span> i<span class="op">*</span><span class="dv">2</span></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.randn(n_points)</span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filled:</span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a>        ax2.scatter(x, y, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span>marker, color<span class="op">=</span>color,</span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>cond)</span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a>        ax2.scatter(x, y, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span>marker, facecolors<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a>                   edgecolors<span class="op">=</span>color, linewidths<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>cond)</span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Variable X'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Variable Y'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: High Contrast Shapes</span><span class="ch">\n</span><span class="st">(Filled/Open + Color + Shape)'</span>,</span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a>ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'shape_contrast.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Shape Palette Recommendations:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessible shape combinations (easily distinguishable)</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>SHAPE_PALETTE_GOOD <span class="op">=</span> {</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group1'</span>: {<span class="st">'marker'</span>: <span class="st">'o'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">80</span>},    <span class="co"># Filled circle</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group2'</span>: {<span class="st">'marker'</span>: <span class="st">'s'</span>, <span class="st">'fill'</span>: <span class="va">False</span>, <span class="st">'size'</span>: <span class="dv">80</span>},   <span class="co"># Open square</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group3'</span>: {<span class="st">'marker'</span>: <span class="st">'^'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">100</span>},   <span class="co"># Filled triangle</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group4'</span>: {<span class="st">'marker'</span>: <span class="st">'D'</span>, <span class="st">'fill'</span>: <span class="va">False</span>, <span class="st">'size'</span>: <span class="dv">70</span>}    <span class="co"># Open diamond</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bad: Too subtle differences</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>SHAPE_PALETTE_BAD <span class="op">=</span> {</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group1'</span>: {<span class="st">'marker'</span>: <span class="st">'o'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">80</span>},    <span class="co"># Filled circle</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group2'</span>: {<span class="st">'marker'</span>: <span class="st">'o'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">90</span>},    <span class="co"># Slightly larger circle (!)</span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group3'</span>: {<span class="st">'marker'</span>: <span class="st">'o'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">70</span>},    <span class="co"># Slightly smaller circle (!)</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group4'</span>: {<span class="st">'marker'</span>: <span class="st">'s'</span>, <span class="st">'fill'</span>: <span class="va">True</span>, <span class="st">'size'</span>: <span class="dv">80</span>}     <span class="co"># Square (finally different)</span></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Chapter 2 Complete Summary:</strong></p>
<p>You now understand: - <strong>Color theory</strong> (RGB, HSV, CIELAB) and perceptual uniformity - <strong>Palette types</strong> (sequential, diverging, qualitative) matched to data types - <strong>Saturation logic</strong> (deep=important/significant, light=background) - <strong>Restraint</strong> (3-color maximum) and <strong>consistency</strong> (same concept=same color) - <strong>Field conventions</strong> and when/how to deviate - <strong>Accessibility</strong> (colorblind-safe, redundant encoding, testing) - <strong>Integrity</strong> (no manipulation, symmetric scales, transparency) - <strong>Logical edge cases</strong> (all significant, missing data, meaningful zero, cyclic data, multiple scales)</p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter 1.html" class="pagination-link" aria-label="Chapter 1: Foundations of Visual Perception">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter 3.html" class="pagination-link" aria-label="Chapter 3: Typography, Annotation &amp; Labels">
        <span class="nav-page-text"><span class="chapter-title">Chapter 3: Typography, Annotation &amp; Labels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>