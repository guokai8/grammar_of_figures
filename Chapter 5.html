<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 5: Layout, Composition &amp; Figure Assembly – The Complete Guide to Bash Errors: From Beginner to Expert</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter 6.html" rel="next">
<link href="./Chapter 4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter 5.html"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Complete Guide to Bash Errors: From Beginner to Expert</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Grammar of Figures: The Art &amp; Science of Visualizing Data for Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 0.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>Grammar of Figures: The Art and Science of Visualizing Data for Publication</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: The Language of Color</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Typography, Annotation &amp; Labels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: Data Encoding &amp; Graph Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 5.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: Technical Specifications &amp; Publication Requirements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Common Figure Types Deep Dive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Specialized Field Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Interactive and Dynamic Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-gestalt-principles-applied-to-scientific-figures" id="toc-the-gestalt-principles-applied-to-scientific-figures" class="nav-link active" data-scroll-target="#the-gestalt-principles-applied-to-scientific-figures">5.1 The Gestalt Principles Applied to Scientific Figures</a>
  <ul class="collapse">
  <li><a href="#visual-perception-fundamentals" id="toc-visual-perception-fundamentals" class="nav-link" data-scroll-target="#visual-perception-fundamentals">Visual Perception Fundamentals</a></li>
  <li><a href="#principle-1-proximity-nearness-implies-relatedness" id="toc-principle-1-proximity-nearness-implies-relatedness" class="nav-link" data-scroll-target="#principle-1-proximity-nearness-implies-relatedness">Principle 1: Proximity (Nearness Implies Relatedness)</a></li>
  <li><a href="#principle-2-similarity-like-elements-group-together" id="toc-principle-2-similarity-like-elements-group-together" class="nav-link" data-scroll-target="#principle-2-similarity-like-elements-group-together">Principle 2: Similarity (Like Elements Group Together)</a></li>
  <li><a href="#principle-3-closure-mind-completes-incomplete-shapes" id="toc-principle-3-closure-mind-completes-incomplete-shapes" class="nav-link" data-scroll-target="#principle-3-closure-mind-completes-incomplete-shapes">Principle 3: Closure (Mind Completes Incomplete Shapes)</a></li>
  <li><a href="#principle-4-continuity-eyes-follow-paths" id="toc-principle-4-continuity-eyes-follow-paths" class="nav-link" data-scroll-target="#principle-4-continuity-eyes-follow-paths">Principle 4: Continuity (Eyes Follow Paths)</a></li>
  <li><a href="#principle-5-figure-ground-foreground-vs.-background" id="toc-principle-5-figure-ground-foreground-vs.-background" class="nav-link" data-scroll-target="#principle-5-figure-ground-foreground-vs.-background">Principle 5: Figure-Ground (Foreground vs.&nbsp;Background)</a></li>
  </ul></li>
  <li><a href="#the-grid-system-for-scientific-figures" id="toc-the-grid-system-for-scientific-figures" class="nav-link" data-scroll-target="#the-grid-system-for-scientific-figures">5.2 The Grid System for Scientific Figures</a>
  <ul class="collapse">
  <li><a href="#why-grids-matter" id="toc-why-grids-matter" class="nav-link" data-scroll-target="#why-grids-matter">Why Grids Matter</a></li>
  <li><a href="#layout-strategy-1-equal-weight-panels" id="toc-layout-strategy-1-equal-weight-panels" class="nav-link" data-scroll-target="#layout-strategy-1-equal-weight-panels">Layout Strategy 1: Equal Weight Panels</a></li>
  <li><a href="#layout-strategy-2-dominant-panel-supporting-panels" id="toc-layout-strategy-2-dominant-panel-supporting-panels" class="nav-link" data-scroll-target="#layout-strategy-2-dominant-panel-supporting-panels">Layout Strategy 2: Dominant Panel + Supporting Panels</a></li>
  <li><a href="#layout-strategy-3-sequentialnarrative-flow" id="toc-layout-strategy-3-sequentialnarrative-flow" class="nav-link" data-scroll-target="#layout-strategy-3-sequentialnarrative-flow">Layout Strategy 3: Sequential/Narrative Flow</a></li>
  </ul></li>
  <li><a href="#aspect-ratios-and-panel-sizing" id="toc-aspect-ratios-and-panel-sizing" class="nav-link" data-scroll-target="#aspect-ratios-and-panel-sizing">5.3 Aspect Ratios and Panel Sizing</a>
  <ul class="collapse">
  <li><a href="#the-golden-ratio-and-practical-aspect-ratios" id="toc-the-golden-ratio-and-practical-aspect-ratios" class="nav-link" data-scroll-target="#the-golden-ratio-and-practical-aspect-ratios">The Golden Ratio and Practical Aspect Ratios</a></li>
  <li><a href="#matching-aspect-ratio-to-data-structure" id="toc-matching-aspect-ratio-to-data-structure" class="nav-link" data-scroll-target="#matching-aspect-ratio-to-data-structure">Matching Aspect Ratio to Data Structure</a></li>
  <li><a href="#panel-size-consistency-rules" id="toc-panel-size-consistency-rules" class="nav-link" data-scroll-target="#panel-size-consistency-rules">Panel Size Consistency Rules</a></li>
  </ul></li>
  <li><a href="#white-space-the-unsung-hero" id="toc-white-space-the-unsung-hero" class="nav-link" data-scroll-target="#white-space-the-unsung-hero">5.4 White Space: The Unsung Hero</a>
  <ul class="collapse">
  <li><a href="#the-power-of-negative-space" id="toc-the-power-of-negative-space" class="nav-link" data-scroll-target="#the-power-of-negative-space">The Power of Negative Space</a></li>
  <li><a href="#the-density-principle" id="toc-the-density-principle" class="nav-link" data-scroll-target="#the-density-principle">The Density Principle</a></li>
  <li><a href="#margin-and-padding-guidelines" id="toc-margin-and-padding-guidelines" class="nav-link" data-scroll-target="#margin-and-padding-guidelines">Margin and Padding Guidelines</a></li>
  </ul></li>
  <li><a href="#multi-figure-consistency-across-a-manuscript" id="toc-multi-figure-consistency-across-a-manuscript" class="nav-link" data-scroll-target="#multi-figure-consistency-across-a-manuscript">5.5 Multi-Figure Consistency Across a Manuscript</a>
  <ul class="collapse">
  <li><a href="#the-style-guide-approach" id="toc-the-style-guide-approach" class="nav-link" data-scroll-target="#the-style-guide-approach">The Style Guide Approach</a></li>
  <li><a href="#template-system-implementation" id="toc-template-system-implementation" class="nav-link" data-scroll-target="#template-system-implementation">Template System Implementation</a></li>
  <li><a href="#cross-figure-checklist" id="toc-cross-figure-checklist" class="nav-link" data-scroll-target="#cross-figure-checklist">Cross-Figure Checklist</a></li>
  <li><a href="#version-control-for-figures" id="toc-version-control-for-figures" class="nav-link" data-scroll-target="#version-control-for-figures">Version Control for Figures</a></li>
  <li><a href="#irregular-shapes-in-regular-frames" id="toc-irregular-shapes-in-regular-frames" class="nav-link" data-scroll-target="#irregular-shapes-in-regular-frames"><strong>5.6 Irregular Shapes in Regular Frames</strong></a></li>
  <li><a href="#layout-logic-reading-direction-and-narrative-flow" id="toc-layout-logic-reading-direction-and-narrative-flow" class="nav-link" data-scroll-target="#layout-logic-reading-direction-and-narrative-flow"><strong>5.7 Layout Logic: Reading Direction and Narrative Flow</strong></a></li>
  <li><a href="#panel-size-considerations-the-a4-paper-test" id="toc-panel-size-considerations-the-a4-paper-test" class="nav-link" data-scroll-target="#panel-size-considerations-the-a4-paper-test"><strong>5.8 Panel Size Considerations: The A4 Paper Test</strong></a></li>
  </ul></li>
  <li><a href="#scientific-figure-design-comprehensive-quick-reference-guide" id="toc-scientific-figure-design-comprehensive-quick-reference-guide" class="nav-link" data-scroll-target="#scientific-figure-design-comprehensive-quick-reference-guide">Scientific Figure Design: Comprehensive Quick Reference Guide</a>
  <ul class="collapse">
  <li><a href="#part-i-pre-design-decision-framework" id="toc-part-i-pre-design-decision-framework" class="nav-link" data-scroll-target="#part-i-pre-design-decision-framework">Part I: Pre-Design Decision Framework</a>
  <ul class="collapse">
  <li><a href="#step-1-define-your-message" id="toc-step-1-define-your-message" class="nav-link" data-scroll-target="#step-1-define-your-message">Step 1: Define Your Message</a></li>
  <li><a href="#step-2-assess-your-data-structure" id="toc-step-2-assess-your-data-structure" class="nav-link" data-scroll-target="#step-2-assess-your-data-structure">Step 2: Assess Your Data Structure</a></li>
  <li><a href="#step-3-choose-plot-type" id="toc-step-3-choose-plot-type" class="nav-link" data-scroll-target="#step-3-choose-plot-type">Step 3: Choose Plot Type</a></li>
  <li><a href="#step-4-establish-style-specifications" id="toc-step-4-establish-style-specifications" class="nav-link" data-scroll-target="#step-4-establish-style-specifications">Step 4: Establish Style Specifications</a></li>
  </ul></li>
  <li><a href="#part-ii-plot-type-selection-matrix" id="toc-part-ii-plot-type-selection-matrix" class="nav-link" data-scroll-target="#part-ii-plot-type-selection-matrix">Part II: Plot Type Selection Matrix</a>
  <ul class="collapse">
  <li><a href="#for-comparing-groups" id="toc-for-comparing-groups" class="nav-link" data-scroll-target="#for-comparing-groups">For Comparing Groups</a></li>
  <li><a href="#for-showing-distributions" id="toc-for-showing-distributions" class="nav-link" data-scroll-target="#for-showing-distributions">For Showing Distributions</a></li>
  <li><a href="#for-relationships" id="toc-for-relationships" class="nav-link" data-scroll-target="#for-relationships">For Relationships</a></li>
  <li><a href="#for-temporal-data" id="toc-for-temporal-data" class="nav-link" data-scroll-target="#for-temporal-data">For Temporal Data</a></li>
  <li><a href="#what-to-avoid" id="toc-what-to-avoid" class="nav-link" data-scroll-target="#what-to-avoid">What to AVOID</a></li>
  </ul></li>
  <li><a href="#part-iii-color-decision-framework" id="toc-part-iii-color-decision-framework" class="nav-link" data-scroll-target="#part-iii-color-decision-framework">Part III: Color Decision Framework</a>
  <ul class="collapse">
  <li><a href="#step-1-identify-data-type" id="toc-step-1-identify-data-type" class="nav-link" data-scroll-target="#step-1-identify-data-type">Step 1: Identify Data Type</a></li>
  <li><a href="#step-2-apply-semantic-color-logic" id="toc-step-2-apply-semantic-color-logic" class="nav-link" data-scroll-target="#step-2-apply-semantic-color-logic">Step 2: Apply Semantic Color Logic</a></li>
  <li><a href="#step-3-accessibility-check" id="toc-step-3-accessibility-check" class="nav-link" data-scroll-target="#step-3-accessibility-check">Step 3: Accessibility Check</a></li>
  <li><a href="#step-4-special-cases" id="toc-step-4-special-cases" class="nav-link" data-scroll-target="#step-4-special-cases">Step 4: Special Cases</a></li>
  </ul></li>
  <li><a href="#part-iv-typography-annotation-checklist" id="toc-part-iv-typography-annotation-checklist" class="nav-link" data-scroll-target="#part-iv-typography-annotation-checklist">Part IV: Typography &amp; Annotation Checklist</a>
  <ul class="collapse">
  <li><a href="#font-specifications" id="toc-font-specifications" class="nav-link" data-scroll-target="#font-specifications">Font Specifications</a></li>
  <li><a href="#axis-label-requirements" id="toc-axis-label-requirements" class="nav-link" data-scroll-target="#axis-label-requirements">Axis Label Requirements</a></li>
  <li><a href="#statistical-annotations" id="toc-statistical-annotations" class="nav-link" data-scroll-target="#statistical-annotations">Statistical Annotations</a></li>
  <li><a href="#caption-structure" id="toc-caption-structure" class="nav-link" data-scroll-target="#caption-structure">Caption Structure</a></li>
  </ul></li>
  <li><a href="#part-v-layout-composition-checklist" id="toc-part-v-layout-composition-checklist" class="nav-link" data-scroll-target="#part-v-layout-composition-checklist">Part V: Layout &amp; Composition Checklist</a>
  <ul class="collapse">
  <li><a href="#panel-arrangement" id="toc-panel-arrangement" class="nav-link" data-scroll-target="#panel-arrangement">Panel Arrangement</a></li>
  <li><a href="#aspect-ratio-selection" id="toc-aspect-ratio-selection" class="nav-link" data-scroll-target="#aspect-ratio-selection">Aspect Ratio Selection</a></li>
  <li><a href="#white-space-guidelines" id="toc-white-space-guidelines" class="nav-link" data-scroll-target="#white-space-guidelines">White Space Guidelines</a></li>
  </ul></li>
  <li><a href="#part-vi-pre-submission-quality-control" id="toc-part-vi-pre-submission-quality-control" class="nav-link" data-scroll-target="#part-vi-pre-submission-quality-control">Part VI: Pre-Submission Quality Control</a>
  <ul class="collapse">
  <li><a href="#technical-specifications" id="toc-technical-specifications" class="nav-link" data-scroll-target="#technical-specifications">Technical Specifications</a></li>
  <li><a href="#cross-figure-consistency-check" id="toc-cross-figure-consistency-check" class="nav-link" data-scroll-target="#cross-figure-consistency-check">Cross-Figure Consistency Check</a></li>
  <li><a href="#accessibility-verification" id="toc-accessibility-verification" class="nav-link" data-scroll-target="#accessibility-verification">Accessibility Verification</a></li>
  <li><a href="#ethical-compliance" id="toc-ethical-compliance" class="nav-link" data-scroll-target="#ethical-compliance">Ethical Compliance</a></li>
  </ul></li>
  <li><a href="#part-vii-common-mistakes-quick-reference" id="toc-part-vii-common-mistakes-quick-reference" class="nav-link" data-scroll-target="#part-vii-common-mistakes-quick-reference">Part VII: Common Mistakes Quick Reference</a>
  <ul class="collapse">
  <li><a href="#top-10-errors-to-avoid" id="toc-top-10-errors-to-avoid" class="nav-link" data-scroll-target="#top-10-errors-to-avoid">Top 10 Errors to Avoid</a></li>
  </ul></li>
  <li><a href="#part-viii-software-specific-quick-commands" id="toc-part-viii-software-specific-quick-commands" class="nav-link" data-scroll-target="#part-viii-software-specific-quick-commands">Part VIII: Software-Specific Quick Commands</a>
  <ul class="collapse">
  <li><a href="#python-matplotlib-essential-commands" id="toc-python-matplotlib-essential-commands" class="nav-link" data-scroll-target="#python-matplotlib-essential-commands">Python (Matplotlib) Essential Commands</a></li>
  <li><a href="#r-ggplot2-essential-commands" id="toc-r-ggplot2-essential-commands" class="nav-link" data-scroll-target="#r-ggplot2-essential-commands">R (ggplot2) Essential Commands</a></li>
  </ul></li>
  <li><a href="#part-ix-journal-specific-considerations" id="toc-part-ix-journal-specific-considerations" class="nav-link" data-scroll-target="#part-ix-journal-specific-considerations">Part IX: Journal-Specific Considerations</a>
  <ul class="collapse">
  <li><a href="#nature-family" id="toc-nature-family" class="nav-link" data-scroll-target="#nature-family">Nature Family</a></li>
  <li><a href="#cell-family" id="toc-cell-family" class="nav-link" data-scroll-target="#cell-family">Cell Family</a></li>
  <li><a href="#plos-family" id="toc-plos-family" class="nav-link" data-scroll-target="#plos-family">PLOS Family</a></li>
  </ul></li>
  <li><a href="#part-x-emergency-troubleshooting" id="toc-part-x-emergency-troubleshooting" class="nav-link" data-scroll-target="#part-x-emergency-troubleshooting">Part X: Emergency Troubleshooting</a>
  <ul class="collapse">
  <li><a href="#my-figure-looks-cluttered" id="toc-my-figure-looks-cluttered" class="nav-link" data-scroll-target="#my-figure-looks-cluttered">“My figure looks cluttered”</a></li>
  <li><a href="#colors-dont-distinguish-well" id="toc-colors-dont-distinguish-well" class="nav-link" data-scroll-target="#colors-dont-distinguish-well">“Colors don’t distinguish well”</a></li>
  <li><a href="#text-is-illegible" id="toc-text-is-illegible" class="nav-link" data-scroll-target="#text-is-illegible">“Text is illegible”</a></li>
  <li><a href="#figure-doesnt-fit-journal-specifications" id="toc-figure-doesnt-fit-journal-specifications" class="nav-link" data-scroll-target="#figure-doesnt-fit-journal-specifications">“Figure doesn’t fit journal specifications”</a></li>
  </ul></li>
  <li><a href="#part-xi-final-submission-checklist" id="toc-part-xi-final-submission-checklist" class="nav-link" data-scroll-target="#part-xi-final-submission-checklist">Part XI: Final Submission Checklist</a></li>
  <li><a href="#part-xii-resources-and-tools" id="toc-part-xii-resources-and-tools" class="nav-link" data-scroll-target="#part-xii-resources-and-tools">Part XII: Resources and Tools</a>
  <ul class="collapse">
  <li><a href="#color-tools" id="toc-color-tools" class="nav-link" data-scroll-target="#color-tools">Color Tools</a></li>
  <li><a href="#layout-and-design-references" id="toc-layout-and-design-references" class="nav-link" data-scroll-target="#layout-and-design-references">Layout and Design References</a></li>
  <li><a href="#software-documentation" id="toc-software-documentation" class="nav-link" data-scroll-target="#software-documentation">Software Documentation</a></li>
  </ul></li>
  <li><a href="#conclusion-the-path-to-publication-quality-figures" id="toc-conclusion-the-path-to-publication-quality-figures" class="nav-link" data-scroll-target="#conclusion-the-path-to-publication-quality-figures">Conclusion: The Path to Publication-Quality Figures</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-gestalt-principles-applied-to-scientific-figures" class="level2">
<h2 class="anchored" data-anchor-id="the-gestalt-principles-applied-to-scientific-figures">5.1 The Gestalt Principles Applied to Scientific Figures</h2>
<section id="visual-perception-fundamentals" class="level3">
<h3 class="anchored" data-anchor-id="visual-perception-fundamentals">Visual Perception Fundamentals</h3>
<p>The human visual system automatically organizes visual information according to <strong>Gestalt principles</strong>—innate perceptual patterns that emerged from evolutionary psychology. Understanding these principles allows you to design figures that are instantly interpretable.</p>
<p><strong>The Core Insight:</strong> &gt; Readers perceive relationships between elements <strong>before</strong> conscious analysis. Poor layout creates false groupings; good layout guides interpretation effortlessly.</p>
<hr>
</section>
<section id="principle-1-proximity-nearness-implies-relatedness" class="level3">
<h3 class="anchored" data-anchor-id="principle-1-proximity-nearness-implies-relatedness">Principle 1: Proximity (Nearness Implies Relatedness)</h3>
<p><strong>The Rule:</strong> Elements placed close together are perceived as belonging to the same group.</p>
<p><strong>Application in Figures:</strong></p>
<pre><code>✓ CORRECT spacing:
- Panels within a figure: Close together (related)
- Figures in manuscript: Separated (distinct)
- Axis label + axis: Immediate proximity (clear association)
- Legend + plot: Adjacent (functional relationship)

❌ INCORRECT spacing:
- Equal spacing between all panels (loses grouping information)
- Legend far from plot (requires search)
- Caption separated from figure by page break</code></pre>
<p><strong>Code Example (Python) - Proximity in Multi-Panel Layouts:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data for 6 panels</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data_sets <span class="op">=</span> [np.random.randn(<span class="dv">50</span>) <span class="op">+</span> i<span class="op">*</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>)]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">10</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Equal spacing (no grouping information)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.25</span>, <span class="fl">0.95</span>, <span class="st">'❌ BAD: Equal Spacing (No Visual Grouping)'</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>gs_bad <span class="op">=</span> fig.add_gridspec(<span class="dv">3</span>, <span class="dv">2</span>, left<span class="op">=</span><span class="fl">0.05</span>, right<span class="op">=</span><span class="fl">0.45</span>, top<span class="op">=</span><span class="fl">0.85</span>, bottom<span class="op">=</span><span class="fl">0.55</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                          wspace<span class="op">=</span><span class="fl">0.3</span>, hspace<span class="op">=</span><span class="fl">0.4</span>)  <span class="co"># Equal spacing</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(gs_bad[i<span class="op">//</span><span class="dv">2</span>, i<span class="op">%</span><span class="dv">2</span>])</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    ax.hist(data_sets[i], bins<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Panel </span><span class="sc">{</span><span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>i)<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frequency'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add misleading text</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.25</span>, <span class="fl">0.52</span>, <span class="st">'All panels equally spaced</span><span class="ch">\n</span><span class="st">→ No visual hierarchy or grouping'</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, style<span class="op">=</span><span class="st">'italic'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Grouped spacing (proximity shows relationship)</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.75</span>, <span class="fl">0.95</span>, <span class="st">'✓ GOOD: Grouped Spacing (Clear Relationship)'</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two groups: Control (A-C) and Treatment (D-F)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 1: Tighter spacing within group</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>gs_good_ctrl <span class="op">=</span> fig.add_gridspec(<span class="dv">3</span>, <span class="dv">1</span>, left<span class="op">=</span><span class="fl">0.55</span>, right<span class="op">=</span><span class="fl">0.68</span>, top<span class="op">=</span><span class="fl">0.85</span>, bottom<span class="op">=</span><span class="fl">0.55</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                                hspace<span class="op">=</span><span class="fl">0.15</span>)  <span class="co"># Tight spacing</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 2: Separated from group 1</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>gs_good_trt <span class="op">=</span> fig.add_gridspec(<span class="dv">3</span>, <span class="dv">1</span>, left<span class="op">=</span><span class="fl">0.77</span>, right<span class="op">=</span><span class="fl">0.90</span>, top<span class="op">=</span><span class="fl">0.85</span>, bottom<span class="op">=</span><span class="fl">0.55</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                               hspace<span class="op">=</span><span class="fl">0.15</span>)  <span class="co"># Tight spacing</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Control group</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(gs_good_ctrl[i])</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    ax.hist(data_sets[i], bins<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'#7F8C8D'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Panel </span><span class="sc">{</span><span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>i)<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frequency'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="fl">0.5</span>, <span class="fl">1.15</span>, <span class="st">'CONTROL'</span>, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>               ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>               bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#7F8C8D'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>))</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Treatment group</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">6</span>):</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(gs_good_trt[i<span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    ax.hist(data_sets[i], bins<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'#E74C3C'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Panel </span><span class="sc">{</span><span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>i)<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frequency'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="fl">0.5</span>, <span class="fl">1.15</span>, <span class="st">'TREATMENT'</span>, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>               ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>               bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#E74C3C'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>))</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Add explanatory text</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.725</span>, <span class="fl">0.52</span>, <span class="st">'Tight spacing within groups</span><span class="ch">\n</span><span class="st">→ Clear visual grouping'</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, style<span class="op">=</span><span class="st">'italic'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'proximity_principle.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Proximity in Multi-Panel Layouts:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="cf">function</span>(i) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> i<span class="sc">*</span><span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="cf">function</span>(i) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_list[[i]], <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">'#3498DB'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">'Panel '</span>, LETTERS[i]), <span class="at">y =</span> <span class="st">'Frequency'</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Equal spacing</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>p_bad <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(plots, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'❌ BAD: Equal Spacing (No Visual Grouping)'</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'All panels equally spaced → No visual hierarchy or grouping'</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'italic'</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Grouped spacing</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Control group (gray)</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>plots_ctrl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) {</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_list[[i]], <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">'#7F8C8D'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">'Panel '</span>, LETTERS[i]), <span class="at">y =</span> <span class="st">'Frequency'</span>) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment group (red)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>plots_trt <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="cf">function</span>(i) {</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_list[[i]], <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">'#E74C3C'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">'Panel '</span>, LETTERS[i]), <span class="at">y =</span> <span class="st">'Frequency'</span>) <span class="sc">+</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with tight spacing within groups</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>ctrl_combined <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(plots_ctrl, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'CONTROL'</span>,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)))</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>trt_combined <span class="ot">&lt;-</span> <span class="fu">wrap_plots</span>(plots_trt, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'TREATMENT'</span>,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)))</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>p_good <span class="ot">&lt;-</span> (ctrl_combined <span class="sc">|</span> trt_combined) <span class="sc">+</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'✓ GOOD: Grouped Spacing (Clear Relationship)'</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Tight spacing within groups → Clear visual grouping'</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'italic'</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">'darkgreen'</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Save (since we can't easily combine bad and good in one figure with patchwork,</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll save separately or use grid)</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="co"># For demonstration, save good example</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'proximity_principle_good.png'</span>, p_good, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="principle-2-similarity-like-elements-group-together" class="level3">
<h3 class="anchored" data-anchor-id="principle-2-similarity-like-elements-group-together">Principle 2: Similarity (Like Elements Group Together)</h3>
<p><strong>The Rule:</strong> Elements that share visual properties (color, shape, size, orientation) are perceived as related.</p>
<p><strong>Application:</strong></p>
<pre><code>✓ CORRECT use:
- Same color for same experimental group across all panels
- Same marker shape for same variable type
- Consistent line styles for same condition

❌ INCORRECT:
- Different colors for same group in different panels
- Inconsistent symbols without semantic reason</code></pre>
<p><strong>Example from Section 2.5:</strong></p>
<pre><code>If "Drug A" is blue in Figure 1, it MUST be blue in Figures 2, 3, 4...
→ Similarity creates immediate recognition
→ Inconsistency forces mental translation (cognitive load)</code></pre>
<hr>
</section>
<section id="principle-3-closure-mind-completes-incomplete-shapes" class="level3">
<h3 class="anchored" data-anchor-id="principle-3-closure-mind-completes-incomplete-shapes">Principle 3: Closure (Mind Completes Incomplete Shapes)</h3>
<p><strong>Application in Figure Layout:</strong></p>
<pre><code>Use closure to create implied groupings:
- Boxes/borders around related panels (creates enclosure)
- Aligned edges create implicit boundaries
- White space separates groups (implicit border)</code></pre>
<p><strong>Code Example (Python) - Using Enclosure for Grouping:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> FancyBboxPatch</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axes.flat):</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.random.randn(<span class="dv">100</span>) <span class="op">+</span> i</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    ax.hist(data, bins<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Panel </span><span class="sc">{</span><span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>i)<span class="sc">}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frequency'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add enclosure boxes to create visual groups</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 1: Panels A, B, C (top row - Method 1)</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>bbox1 <span class="op">=</span> FancyBboxPatch((<span class="fl">0.08</span>, <span class="fl">0.55</span>), <span class="fl">0.85</span>, <span class="fl">0.38</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                       boxstyle<span class="op">=</span><span class="st">"round,pad=0.01"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                       edgecolor<span class="op">=</span><span class="st">'#27AE60'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                       linewidth<span class="op">=</span><span class="dv">3</span>, transform<span class="op">=</span>fig.transFigure,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                       clip_on<span class="op">=</span><span class="va">False</span>, zorder<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>fig.patches.append(bbox1)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.5</span>, <span class="fl">0.94</span>, <span class="st">'Method 1 Results'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 2: Panels D, E, F (bottom row - Method 2)</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>bbox2 <span class="op">=</span> FancyBboxPatch((<span class="fl">0.08</span>, <span class="fl">0.08</span>), <span class="fl">0.85</span>, <span class="fl">0.38</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                       boxstyle<span class="op">=</span><span class="st">"round,pad=0.01"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>                       edgecolor<span class="op">=</span><span class="st">'#E67E22'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>                       linewidth<span class="op">=</span><span class="dv">3</span>, transform<span class="op">=</span>fig.transFigure,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                       clip_on<span class="op">=</span><span class="va">False</span>, zorder<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>fig.patches.append(bbox2)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>fig.text(<span class="fl">0.5</span>, <span class="fl">0.47</span>, <span class="st">'Method 2 Results'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'#E67E22'</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Using Enclosure to Create Visual Grouping</span><span class="ch">\n</span><span class="st">(Closure Principle)'</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.96</span>])</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'closure_principle_grouping.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="principle-4-continuity-eyes-follow-paths" class="level3">
<h3 class="anchored" data-anchor-id="principle-4-continuity-eyes-follow-paths">Principle 4: Continuity (Eyes Follow Paths)</h3>
<p><strong>Application:</strong></p>
<pre><code>Alignment creates visual flow:
✓ Align panel edges (creates reading path)
✓ Align axis limits when comparing (facilitates comparison)
✓ Use consistent panel sizes (smooth visual scanning)

❌ AVOID:
- Misaligned panels (jagged, disorganized)
- Different aspect ratios without justification
- Inconsistent spacing (disrupts flow)</code></pre>
<hr>
</section>
<section id="principle-5-figure-ground-foreground-vs.-background" class="level3">
<h3 class="anchored" data-anchor-id="principle-5-figure-ground-foreground-vs.-background">Principle 5: Figure-Ground (Foreground vs.&nbsp;Background)</h3>
<p><strong>Application:</strong></p>
<pre><code>Create clear hierarchy:
✓ Data elements (foreground): Bold, saturated colors
✓ Grid/axes (background): Light gray, thin lines
✓ Annotations (mid-ground): Medium contrast

Visual hierarchy = Information hierarchy</code></pre>
<hr>
</section>
</section>
<section id="the-grid-system-for-scientific-figures" class="level2">
<h2 class="anchored" data-anchor-id="the-grid-system-for-scientific-figures">5.2 The Grid System for Scientific Figures</h2>
<section id="why-grids-matter" class="level3">
<h3 class="anchored" data-anchor-id="why-grids-matter">Why Grids Matter</h3>
<p>A <strong>grid system</strong> provides invisible structure that: - Ensures consistent alignment - Creates visual rhythm - Facilitates comparison across panels - Signals professionalism</p>
<p><strong>The Standard: Column-Based Grid</strong></p>
<pre><code>Common layouts:
- 1-column: Full width (simple figures)
- 2-column: Split left/right (comparisons)
- 3-column: Triptych (sequential processes)
- 2×2 grid: Four related panels
- Mixed: Large main + smaller supporting panels</code></pre>
<hr>
</section>
<section id="layout-strategy-1-equal-weight-panels" class="level3">
<h3 class="anchored" data-anchor-id="layout-strategy-1-equal-weight-panels">Layout Strategy 1: Equal Weight Panels</h3>
<p><strong>When to use:</strong> All panels equally important, same data type</p>
<p><strong>Code Example (Python) - Balanced 2×2 Grid:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate different plot types</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plot_types <span class="op">=</span> [</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Scatter'</span>, <span class="st">'scatter'</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Line'</span>, <span class="st">'line'</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Bar'</span>, <span class="st">'bar'</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Box'</span>, <span class="st">'box'</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (title, ptype) <span class="kw">in</span> <span class="bu">enumerate</span>(plot_types):</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes.flat[idx]</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ptype <span class="op">==</span> <span class="st">'scatter'</span>:</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.random.randn(<span class="dv">50</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        ax.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Variable X'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Variable Y'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ptype <span class="op">==</span> <span class="st">'line'</span>:</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        time <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        signal <span class="op">=</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>np.sin(time) <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        ax.plot(time, signal, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Time (s)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Signal (mV)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ptype <span class="op">==</span> <span class="st">'bar'</span>:</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>]</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        values <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">35</span>]</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        ax.bar(categories, values, color<span class="op">=</span><span class="st">'#E74C3C'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ptype <span class="op">==</span> <span class="st">'box'</span>:</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> [np.random.normal(<span class="dv">20</span><span class="op">+</span>i<span class="op">*</span><span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">50</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)]</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        bp <span class="op">=</span> ax.boxplot(data, labels<span class="op">=</span>[<span class="st">'G1'</span>, <span class="st">'G2'</span>, <span class="st">'G3'</span>, <span class="st">'G4'</span>], patch_artist<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> patch <span class="kw">in</span> bp[<span class="st">'boxes'</span>]:</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>            patch.set_facecolor(<span class="st">'#F39C12'</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Measurement'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Panel label</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.15</span>, <span class="fl">1.05</span>, <span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>idx), transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>           fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> Plot'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    ax.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Equal Weight Grid Layout (2×2)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.96</span>])</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'equal_weight_grid.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="layout-strategy-2-dominant-panel-supporting-panels" class="level3">
<h3 class="anchored" data-anchor-id="layout-strategy-2-dominant-panel-supporting-panels">Layout Strategy 2: Dominant Panel + Supporting Panels</h3>
<p><strong>When to use:</strong> One main finding + supporting evidence or details</p>
<p><strong>Structure:</strong></p>
<pre><code>┌─────────────┬─────┐
│             │  B  │
│      A      ├─────┤
│  (main)     │  C  │
│             ├─────┤
└─────────────┴─────┘

A: Large (60-70% of space) - Main result
B, C: Small (15-20% each) - Supporting/methods</code></pre>
<p><strong>Code Example (Python) - Dominant Layout:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grid: 2 rows, 2 columns with different sizes</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">2</span>, <span class="dv">2</span>, width_ratios<span class="op">=</span>[<span class="dv">3</span>, <span class="dv">1</span>], height_ratios<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                      hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Main result (large, spans 2 rows)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ax_main <span class="op">=</span> fig.add_subplot(gs[:, <span class="dv">0</span>])</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randn(<span class="dv">200</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fl">2.5</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">200</span>)<span class="op">*</span><span class="fl">1.5</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>ax_main.scatter(x, y, s<span class="op">=</span><span class="dv">60</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.polyfit(x, y, <span class="dv">1</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>x_line <span class="op">=</span> np.linspace(x.<span class="bu">min</span>(), x.<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>ax_main.plot(x_line, p(x_line), <span class="st">'r--'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="ss">f'y = </span><span class="sc">{</span>z[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>z[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">x'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>ax_main.set_xlabel(<span class="st">'Treatment Dose (μM)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>ax_main.set_ylabel(<span class="st">'Cell Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>ax_main.set_title(<span class="st">'Main Result: Dose-Response Relationship'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ax_main.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>ax_main.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>ax_main.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.05</span>, <span class="st">'A'</span>, transform<span class="op">=</span>ax_main.transAxes,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">18</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Supporting (top right)</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>ax_b <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Treated'</span>]</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">35</span>]</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>ax_b.bar(categories, values, color<span class="op">=</span>[<span class="st">'#7F8C8D'</span>, <span class="st">'#E74C3C'</span>],</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, width<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>ax_b.errorbar(categories, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>             ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">6</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>ax_b.set_ylabel(<span class="st">'Viability (%)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>ax_b.set_title(<span class="st">'Endpoint Viability'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>ax_b.set_ylim(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>ax_b.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>ax_b.text(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.1</span>, <span class="st">'B'</span>, transform<span class="op">=</span>ax_b.transAxes,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Supporting (bottom right)</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>ax_c <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">50</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> <span class="dv">20</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>time<span class="op">/</span><span class="dv">24</span>) <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="dv">3</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>ax_c.plot(time, signal, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>ax_c.set_xlabel(<span class="st">'Time (h)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>ax_c.set_ylabel(<span class="st">'Signal'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>ax_c.set_title(<span class="st">'Temporal Control'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>ax_c.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>ax_c.text(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.1</span>, <span class="st">'C'</span>, transform<span class="op">=</span>ax_c.transAxes,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Dominant Layout: Main Result + Supporting Evidence'</span>,</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'dominant_panel_layout.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Code Example (R) - Dominant Layout:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Main result (large)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>data_main <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dose =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fl">2.5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>p_main <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_main, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'#3498DB'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Treatment Dose (μM)'</span>, <span class="at">y =</span> <span class="st">'Cell Response (AU)'</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Main Result: Dose-Response Relationship'</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Supporting</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>data_b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treated'</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Control'</span>, <span class="st">'Treated'</span>)),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">35</span>),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_b, <span class="fu">aes</span>(<span class="at">x =</span> category, <span class="at">y =</span> value, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> value <span class="sc">-</span> error, <span class="at">ymax =</span> value <span class="sc">+</span> error),</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'Control'</span> <span class="ot">=</span> <span class="st">'#7F8C8D'</span>, <span class="st">'Treated'</span> <span class="ot">=</span> <span class="st">'#E74C3C'</span>)) <span class="sc">+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Viability (%)'</span>, <span class="at">title =</span> <span class="st">'Endpoint Viability'</span>) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Supporting</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>data_c <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">signal =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">20</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">length.out =</span> <span class="dv">50</span>)<span class="sc">/</span><span class="dv">24</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_c, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">'#27AE60'</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'#27AE60'</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (h)'</span>, <span class="at">y =</span> <span class="st">'Signal'</span>, <span class="at">title =</span> <span class="st">'Temporal Control'</span>) <span class="sc">+</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with dominant layout</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a><span class="st">AAB</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="st">AAC</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> p_main <span class="sc">+</span> p_b <span class="sc">+</span> p_c <span class="sc">+</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">+</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Dominant Layout: Main Result + Supporting Evidence'</span>,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">'bold'</span>)</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'dominant_panel_layout.png'</span>, combined, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="layout-strategy-3-sequentialnarrative-flow" class="level3">
<h3 class="anchored" data-anchor-id="layout-strategy-3-sequentialnarrative-flow">Layout Strategy 3: Sequential/Narrative Flow</h3>
<p><strong>When to use:</strong> Showing a process, temporal sequence, or methodological pipeline</p>
<p><strong>Structure:</strong> Left-to-right or top-to-bottom progression</p>
<pre><code>Time 0 → Time 1 → Time 2 → Time 3
  OR
Step 1 ↓
Step 2 ↓
Step 3 ↓
Step 4 ↓</code></pre>
<p><strong>Visual cues for flow:</strong> - Arrows between panels - Progressive color intensity - Consistent aspect ratio (smooth scanning)</p>
<hr>
</section>
</section>
<section id="aspect-ratios-and-panel-sizing" class="level2">
<h2 class="anchored" data-anchor-id="aspect-ratios-and-panel-sizing">5.3 Aspect Ratios and Panel Sizing</h2>
<section id="the-golden-ratio-and-practical-aspect-ratios" class="level3">
<h3 class="anchored" data-anchor-id="the-golden-ratio-and-practical-aspect-ratios">The Golden Ratio and Practical Aspect Ratios</h3>
<p><strong>Aspect ratio</strong> = Width / Height</p>
<p>Different ratios serve different purposes and affect perception:</p>
<p><strong>Common aspect ratios in scientific figures:</strong></p>
<pre><code>1:1 (Square)
- Use for: Heatmaps, correlation matrices, symmetric data
- Perception: Balanced, no directional bias
- Example: 6×6 inches

4:3 (Standard)
- Use for: General purpose, presentations
- Perception: Slightly wider, comfortable viewing
- Example: 8×6 inches

16:9 (Widescreen)
- Use for: Time series, horizontal comparisons
- Perception: Emphasizes horizontal progression
- Example: 10×5.625 inches

3:2 (Classic photography)
- Use for: Balanced figures, portraits
- Perception: Natural, versatile
- Example: 9×6 inches

Golden ratio (~1.618:1)
- Use for: Aesthetically pleasing single panels
- Perception: Harmonious, professional
- Example: 9.7×6 inches</code></pre>
<hr>
</section>
<section id="matching-aspect-ratio-to-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="matching-aspect-ratio-to-data-structure">Matching Aspect Ratio to Data Structure</h3>
<p><strong>The Principle: Aspect ratio should emphasize data relationships</strong></p>
<p><strong>Horizontal (Wide) Ratios:</strong></p>
<pre><code>✓ BEST for:
- Time series (time flows left-to-right)
- Sequential processes
- Many categories on x-axis
- Comparisons across groups

Example: 16:9 or 2:1</code></pre>
<p><strong>Vertical (Tall) Ratios:</strong></p>
<pre><code>✓ BEST for:
- Hierarchical trees/dendrograms
- Stacked plots (multiple time series)
- Rank-ordered lists
- Vertical processes

Example: 1:2 or 9:16</code></pre>
<p><strong>Square Ratios:</strong></p>
<pre><code>✓ BEST for:
- Symmetric relationships (correlation matrices)
- Spatial data without directional bias
- Heatmaps with equal dimensions
- Network diagrams

Example: 1:1</code></pre>
<hr>
<p><strong>Code Example (Python) - Aspect Ratio Effects:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate time series data</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">24</span>, <span class="dv">100</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> <span class="dv">100</span> <span class="op">+</span> <span class="dv">20</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>time<span class="op">/</span><span class="dv">24</span>) <span class="op">+</span> np.random.randn(<span class="dv">100</span>)<span class="op">*</span><span class="dv">3</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Aspect ratio 1: Too tall (vertical bias)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>ax1.plot(time, signal, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ TOO TALL (1:3 aspect)</span><span class="ch">\n</span><span class="st">Emphasizes vertical, hard to see temporal pattern'</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>ax1.set_aspect(<span class="st">'auto'</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Aspect ratio 2: Good (horizontal emphasis)</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>ax2.plot(time, signal, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD (3:1 aspect)</span><span class="ch">\n</span><span class="st">Emphasizes horizontal flow, clear temporal pattern'</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>ax2.set_aspect(<span class="st">'auto'</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co"># For comparison: Make ax2 appear wider by adjusting position</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> ax2.get_position()</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>ax2.set_position([pos.x0, pos.y0, pos.width, pos.height<span class="op">*</span><span class="fl">0.5</span>])</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Aspect ratio 3: Square (no directional emphasis)</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">2</span>]</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>ax3.plot(time, signal, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#E67E22'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Response'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'⚠ SQUARE (1:1 aspect)</span><span class="ch">\n</span><span class="st">No directional bias, but less ideal for time series'</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>ax3.set_aspect(<span class="st">'auto'</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>ax3.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Aspect Ratio Impact on Time Series Perception'</span>,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.98</span>)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.96</span>])</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'aspect_ratio_effects.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Aspect ratio affects data perception"</span>)</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Match ratio to data structure (wide for time, square for symmetric)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="panel-size-consistency-rules" class="level3">
<h3 class="anchored" data-anchor-id="panel-size-consistency-rules">Panel Size Consistency Rules</h3>
<p><strong>Within a single figure:</strong></p>
<pre><code>✓ CONSISTENT sizes when:
- Comparing similar data types
- All panels equally important
- Direct visual comparison needed

✓ VARIABLE sizes when:
- Main result + supporting evidence
- Different data types (image vs. plot)
- Hierarchical importance</code></pre>
<p><strong>Across figures in manuscript:</strong></p>
<pre><code>✓ Keep consistent:
- Axis label font sizes
- Marker sizes
- Line widths
- Color schemes

✓ Can vary:
- Overall figure dimensions (based on content)
- Number of panels
- Layout structure</code></pre>
<hr>
</section>
</section>
<section id="white-space-the-unsung-hero" class="level2">
<h2 class="anchored" data-anchor-id="white-space-the-unsung-hero">5.4 White Space: The Unsung Hero</h2>
<section id="the-power-of-negative-space" class="level3">
<h3 class="anchored" data-anchor-id="the-power-of-negative-space">The Power of Negative Space</h3>
<p><strong>White space</strong> (or negative space) is NOT wasted space—it’s functional design element that:</p>
<ol type="1">
<li><strong>Separates groups</strong> (visual breathing room)</li>
<li><strong>Directs attention</strong> (eyes rest on dense areas)</li>
<li><strong>Reduces cognitive load</strong> (prevents overwhelming)</li>
<li><strong>Signals professionalism</strong> (crowded = amateur)</li>
</ol>
<hr>
</section>
<section id="the-density-principle" class="level3">
<h3 class="anchored" data-anchor-id="the-density-principle">The Density Principle</h3>
<p><strong>Rule of thumb: 40-60% white space in scientific figures</strong></p>
<pre><code>Too dense (&lt;30% white space):
→ Overwhelming, cluttered
→ Hard to identify key elements
→ Looks amateur

Too sparse (&gt;70% white space):
→ Inefficient use of space
→ May appear incomplete
→ Poor for publications with page limits

Optimal (40-60%):
→ Clear visual hierarchy
→ Easy to scan
→ Professional appearance</code></pre>
<hr>
<p><strong>Code Example (Python) - White Space Management:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Group A'</span>, <span class="st">'Group B'</span>, <span class="st">'Group C'</span>, <span class="st">'Group D'</span>]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">35</span>]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">3.5</span>, <span class="fl">4.2</span>]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Too cramped (insufficient white space)</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax1.bar(categories, values, width<span class="op">=</span><span class="fl">0.95</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>,  <span class="co"># Width = 0.95 (very wide)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>              edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>ax1.errorbar(categories, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>            ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: Insufficient White Space</span><span class="ch">\n</span><span class="st">(Cramped, hard to distinguish)'</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">45</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>ax1.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluttered annotations</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, val) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, values)):</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    ax1.text(i, val <span class="op">+</span> errors[i] <span class="op">+</span> <span class="dv">1</span>, <span class="ss">f'</span><span class="sc">{</span>val<span class="sc">}</span><span class="ss">±</span><span class="sc">{</span>errors[i]<span class="sc">:.1f}</span><span class="ss">'</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove spines</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>ax1.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Appropriate white space</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax2.bar(categories, values, width<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>,  <span class="co"># Width = 0.6 (breathing room)</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>              edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>ax2.errorbar(categories, values, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>            ecolor<span class="op">=</span><span class="st">'black'</span>, capsize<span class="op">=</span><span class="dv">8</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: Appropriate White Space</span><span class="ch">\n</span><span class="st">(Clear, easy to read)'</span>,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">45</span>)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Spaced annotations</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, val) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, values)):</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    ax2.text(i, <span class="dv">42</span>, <span class="ss">f'n=15'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, style<span class="op">=</span><span class="st">'italic'</span>)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'white_space_importance.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="margin-and-padding-guidelines" class="level3">
<h3 class="anchored" data-anchor-id="margin-and-padding-guidelines">Margin and Padding Guidelines</h3>
<p><strong>Standard spacing hierarchy:</strong></p>
<pre><code>Between figure and edge (outer margin):
- Minimum: 0.5 inches (1.27 cm)
- Recommended: 0.75-1 inch (prevents cropping)

Between panels (internal spacing):
- Related panels: 0.25-0.5 inches
- Separate groups: 0.75-1 inch

Between elements within panel:
- Axis to tick labels: ~0.1 inches
- Tick labels to axis label: ~0.15 inches
- Title to plot area: ~0.2 inches</code></pre>
<p><strong>In code (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set spacing explicitly</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="fl">1.5</span>,      <span class="co"># Outer padding</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                h_pad<span class="op">=</span><span class="fl">2.0</span>,     <span class="co"># Vertical spacing between panels</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                w_pad<span class="op">=</span><span class="fl">2.0</span>)     <span class="co"># Horizontal spacing between panels</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Or manually with subplots_adjust</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(left<span class="op">=</span><span class="fl">0.1</span>, right<span class="op">=</span><span class="fl">0.95</span>,   <span class="co"># Outer margins</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                   top<span class="op">=</span><span class="fl">0.92</span>, bottom<span class="op">=</span><span class="fl">0.08</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                   hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)  <span class="co"># Internal spacing</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="multi-figure-consistency-across-a-manuscript" class="level2">
<h2 class="anchored" data-anchor-id="multi-figure-consistency-across-a-manuscript">5.5 Multi-Figure Consistency Across a Manuscript</h2>
<section id="the-style-guide-approach" class="level3">
<h3 class="anchored" data-anchor-id="the-style-guide-approach">The Style Guide Approach</h3>
<p><strong>Create a figure style guide at the START of manuscript preparation:</strong></p>
<pre><code>Document specifications:
├─ Font family: Arial
├─ Font sizes:
│   ├─ Panel labels: 14pt bold
│   ├─ Titles: 12pt bold
│   ├─ Axis labels: 11pt bold
│   ├─ Tick labels: 9pt regular
│   └─ Annotations: 9pt regular/italic
├─ Colors:
│   ├─ Control: #7F8C8D (gray)
│   ├─ Treatment A: #3498DB (blue)
│   ├─ Treatment B: #E74C3C (red)
│   └─ Significant: #E67E22 (orange highlights)
├─ Line widths:
│   ├─ Data lines: 2.5pt
│   ├─ Axis lines: 1.5pt
│   └─ Grid lines: 0.5pt, alpha=0.3
├─ Marker sizes:
│   ├─ Scatter points: 50-80 (matplotlib units)
│   └─ Line markers: 5-6
└─ Aspect ratios:
    ├─ Time series: 16:9 or 3:1
    ├─ Comparisons: 4:3 or 3:2
    └─ Heatmaps: 1:1 or data-dependent</code></pre>
<hr>
</section>
<section id="template-system-implementation" class="level3">
<h3 class="anchored" data-anchor-id="template-system-implementation">Template System Implementation</h3>
<p><strong>Python template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define once, use everywhere</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>FIGURE_STYLE <span class="op">=</span> {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">'sans-serif'</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.sans-serif'</span>: [<span class="st">'Arial'</span>, <span class="st">'Helvetica'</span>],</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">9</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: <span class="dv">11</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="dv">12</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.linewidth'</span>: <span class="fl">1.5</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: <span class="dv">9</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: <span class="dv">9</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.fontsize'</span>: <span class="dv">9</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.titlesize'</span>: <span class="dv">14</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="fl">2.5</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.markersize'</span>: <span class="dv">6</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.alpha'</span>: <span class="fl">0.3</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.linewidth'</span>: <span class="fl">0.5</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors (semantic consistency)</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>COLORS <span class="op">=</span> {</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'control'</span>: <span class="st">'#7F8C8D'</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'treatment_a'</span>: <span class="st">'#3498DB'</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'treatment_b'</span>: <span class="st">'#E74C3C'</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'significant'</span>: <span class="st">'#E67E22'</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply globally</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(FIGURE_STYLE)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to set consistent panel formatting</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_panel(ax, xlabel, ylabel, title, panel_label):</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Apply consistent formatting to all panels"""</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(xlabel, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    ax.set_title(title, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.15</span>, <span class="fl">1.05</span>, panel_label, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>           fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    ax.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>], color<span class="op">=</span>COLORS[<span class="st">'treatment_a'</span>])</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>format_panel(ax, <span class="st">'Time (s)'</span>, <span class="st">'Response (AU)'</span>, <span class="st">'Example Plot'</span>, <span class="st">'A'</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'consistent_figure.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R template:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define theme once</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>manuscript_theme <span class="ot">&lt;-</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>, <span class="at">base_family =</span> <span class="st">'Arial'</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">'bold'</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors (semantic consistency)</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>COLORS <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="st">'#7F8C8D'</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_a =</span> <span class="st">'#3498DB'</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_b =</span> <span class="st">'#E74C3C'</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">significant =</span> <span class="st">'#E67E22'</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> COLORS<span class="sc">$</span>treatment_a, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Time (s)'</span>, <span class="at">y =</span> <span class="st">'Response (AU)'</span>, <span class="at">title =</span> <span class="st">'Example Plot'</span>, <span class="at">tag =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  manuscript_theme</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'consistent_figure.png'</span>, p, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="cross-figure-checklist" class="level3">
<h3 class="anchored" data-anchor-id="cross-figure-checklist">Cross-Figure Checklist</h3>
<p><strong>Before submitting manuscript, verify:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>All figures use same font family</strong></label></li>
<li><label><input type="checkbox"><strong>Font sizes consistent</strong> (panel labels, axes, etc.)</label></li>
<li><label><input type="checkbox"><strong>Color schemes consistent</strong> (Control always gray, Drug A always blue, etc.)</label></li>
<li><label><input type="checkbox"><strong>Line widths consistent</strong> across figure types</label></li>
<li><label><input type="checkbox"><strong>Marker sizes consistent</strong></label></li>
<li><label><input type="checkbox"><strong>Panel label format consistent</strong> (A, B, C… in same position)</label></li>
<li><label><input type="checkbox"><strong>Aspect ratios appropriate</strong> for each data type</label></li>
<li><label><input type="checkbox"><strong>White space balanced</strong> (not too cramped or too sparse)</label></li>
<li><label><input type="checkbox"><strong>Grid styles consistent</strong> (if used)</label></li>
<li><label><input type="checkbox"><strong>Error bar styles consistent</strong> (SEM vs SD documented)</label></li>
<li><label><input type="checkbox"><strong>Statistical annotations consistent</strong> (<em>, <strong>, </strong></em> system)</label></li>
<li><label><input type="checkbox"><strong>All figures export at same DPI</strong> (300 minimum)</label></li>
<li><label><input type="checkbox"><strong>File formats consistent</strong> (TIFF/PNG for publication)</label></li>
</ul>
<hr>
</section>
<section id="version-control-for-figures" class="level3">
<h3 class="anchored" data-anchor-id="version-control-for-figures">Version Control for Figures</h3>
<p><strong>Best practices:</strong></p>
<pre><code>File naming convention:
figure1_version1_20250107.png
figure1_version2_20250115.png (after revisions)
figure1_final_20250120.png

Track changes:
- Keep log of what changed between versions
- Save original high-resolution files separately
- Document software versions used</code></pre>
<hr>
<p><strong>Summary of Chapter 5 so far:</strong></p>
<p>✓ <strong>Gestalt principles</strong>: Proximity, similarity, closure guide perception ✓ <strong>Grid systems</strong>: Structured layouts (equal weight, dominant, sequential) ✓ <strong>Aspect ratios</strong>: Match to data (wide for time, square for symmetric) ✓ <strong>White space</strong>: 40-60% optimal, prevents crowding ✓ <strong>Consistency</strong>: Style guide + templates ensure manuscript coherence</p>
<hr>
<p><strong>End of Chapter 5: Layout, Composition &amp; Figure Assembly</strong></p>
<p><strong>Final Figure Assembly Workflow:</strong></p>
<pre><code>1. Define style guide (fonts, colors, sizes)
2. Create templates (Python rcParams / R themes)
3. Generate individual panels with consistent formatting
4. Assemble using grid system (appropriate layout strategy)
5. Balance white space (check density)
6. Add panel labels (A, B, C...) consistently
7. Verify aspect ratios match data types
8. Cross-check against manuscript figures for consistency
9. Export at publication quality (300 DPI, TIFF/PNG)
10. Review entire figure set side-by-side before submission</code></pre>
<hr>
</section>
<section id="irregular-shapes-in-regular-frames" class="level3">
<h3 class="anchored" data-anchor-id="irregular-shapes-in-regular-frames"><strong>5.6 Irregular Shapes in Regular Frames</strong></h3>
<p><strong>Principle:</strong> Irregular plots (network diagrams, UMAPs, dendrograms) should be contained in regular rectangular frames for easy comparison.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: BAD - Irregular network without frame</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>G1 <span class="op">=</span> nx.random_geometric_graph(<span class="dv">20</span>, <span class="fl">0.3</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>pos1 <span class="op">=</span> nx.spring_layout(G1)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G1, pos<span class="op">=</span>pos1, ax<span class="op">=</span>ax1, node_color<span class="op">=</span><span class="st">'#3498DB'</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">300</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ BAD: No Frame</span><span class="ch">\n</span><span class="st">(Hard to compare size/scale)'</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>ax1.axis(<span class="st">'off'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: GOOD - Network in regular frame</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>G2 <span class="op">=</span> nx.random_geometric_graph(<span class="dv">20</span>, <span class="fl">0.3</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>pos2 <span class="op">=</span> nx.spring_layout(G2)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G2, pos<span class="op">=</span>pos2, ax<span class="op">=</span>ax2, node_color<span class="op">=</span><span class="st">'#27AE60'</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">300</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add visible frame</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> spine <span class="kw">in</span> ax2.spines.values():</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    spine.set_visible(<span class="va">True</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    spine.set_linewidth(<span class="dv">2</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    spine.set_edgecolor(<span class="st">'black'</span>)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ GOOD: Regular Frame</span><span class="ch">\n</span><span class="st">(Easy to compare)'</span>,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>ax2.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Multiple irregular shapes without frames (confusing)</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>ax3.axis(<span class="st">'off'</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'❌ BAD: Multiple Irregular Shapes</span><span class="ch">\n</span><span class="st">(No alignment reference)'</span>,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw two networks at different positions/sizes</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>G3a <span class="op">=</span> nx.random_geometric_graph(<span class="dv">15</span>, <span class="fl">0.35</span>)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>pos3a <span class="op">=</span> nx.spring_layout(G3a, scale<span class="op">=</span><span class="fl">0.3</span>, center<span class="op">=</span>(<span class="fl">0.25</span>, <span class="fl">0.7</span>))</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G3a, pos<span class="op">=</span>pos3a, ax<span class="op">=</span>ax3, node_color<span class="op">=</span><span class="st">'#3498DB'</span>,</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">200</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>G3b <span class="op">=</span> nx.random_geometric_graph(<span class="dv">18</span>, <span class="fl">0.3</span>)</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>pos3b <span class="op">=</span> nx.spring_layout(G3b, scale<span class="op">=</span><span class="fl">0.4</span>, center<span class="op">=</span>(<span class="fl">0.75</span>, <span class="fl">0.3</span>))</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G3b, pos<span class="op">=</span>pos3b, ax<span class="op">=</span>ax3, node_color<span class="op">=</span><span class="st">'#E74C3C'</span>,</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">200</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel D: Same networks in regular frames (clear comparison)</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>ax4.axis(<span class="st">'off'</span>)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'✓ GOOD: Regular Frames Enable Comparison'</span>,</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two subplot axes within ax4</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.gridspec <span class="im">import</span> GridSpec</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>inner_gs <span class="op">=</span> GridSpec(<span class="dv">1</span>, <span class="dv">2</span>, figure<span class="op">=</span>fig,</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>                   left<span class="op">=</span><span class="fl">0.52</span>, right<span class="op">=</span><span class="fl">0.98</span>, bottom<span class="op">=</span><span class="fl">0.05</span>, top<span class="op">=</span><span class="fl">0.45</span>,</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>                   wspace<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>ax4a <span class="op">=</span> fig.add_subplot(inner_gs[<span class="dv">0</span>])</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>ax4b <span class="op">=</span> fig.add_subplot(inner_gs[<span class="dv">1</span>])</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Network A in frame</span></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>G4a <span class="op">=</span> nx.random_geometric_graph(<span class="dv">15</span>, <span class="fl">0.35</span>)</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>pos4a <span class="op">=</span> nx.spring_layout(G4a)</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G4a, pos<span class="op">=</span>pos4a, ax<span class="op">=</span>ax4a, node_color<span class="op">=</span><span class="st">'#3498DB'</span>,</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">200</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>ax4a.set_xlim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>ax4a.set_ylim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>ax4a.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> spine <span class="kw">in</span> ax4a.spines.values():</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>    spine.set_visible(<span class="va">True</span>)</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    spine.set_linewidth(<span class="dv">2</span>)</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>    spine.set_edgecolor(<span class="st">'black'</span>)</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>ax4a.set_title(<span class="st">'Network A'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Network B in frame (same size frame!)</span></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>G4b <span class="op">=</span> nx.random_geometric_graph(<span class="dv">18</span>, <span class="fl">0.3</span>)</span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>pos4b <span class="op">=</span> nx.spring_layout(G4b)</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G4b, pos<span class="op">=</span>pos4b, ax<span class="op">=</span>ax4b, node_color<span class="op">=</span><span class="st">'#E74C3C'</span>,</span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>                node_size<span class="op">=</span><span class="dv">200</span>, with_labels<span class="op">=</span><span class="va">False</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>ax4b.set_xlim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)  <span class="co"># SAME LIMITS</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>ax4b.set_ylim(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)  <span class="co"># SAME LIMITS</span></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>ax4b.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> spine <span class="kw">in</span> ax4b.spines.values():</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>    spine.set_visible(<span class="va">True</span>)</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>    spine.set_linewidth(<span class="dv">2</span>)</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>    spine.set_edgecolor(<span class="st">'black'</span>)</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>ax4b.set_title(<span class="st">'Network B'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Add panel labels</span></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>([ax1, ax2, ax3]):</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.05</span>, <span class="bu">chr</span>(<span class="dv">65</span><span class="op">+</span>i), transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a>           fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>ax4.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.05</span>, <span class="st">'D'</span>, transform<span class="op">=</span>ax4.transAxes,</span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, va<span class="op">=</span><span class="st">'top'</span>)</span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'irregular_shapes_regular_frames.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="layout-logic-reading-direction-and-narrative-flow" class="level3">
<h3 class="anchored" data-anchor-id="layout-logic-reading-direction-and-narrative-flow"><strong>5.7 Layout Logic: Reading Direction and Narrative Flow</strong></h3>
<p><strong>Principle:</strong> Panel arrangement should follow logical narrative progression.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">10</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Experimental workflow visualization</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Logical flow: Sample → Process → Analysis → Result</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD layout: Random arrangement</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>ax_bad <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>ax_bad.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'❌ BAD LAYOUT</span><span class="ch">\n\n</span><span class="st">Random order:</span><span class="ch">\n</span><span class="st">C → A → D → B</span><span class="ch">\n\n</span><span class="st">No logical flow!'</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>           ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>           bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#FFCCCC'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>ax_bad.axis(<span class="st">'off'</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>ax_bad.set_title(<span class="st">'Random Panel Arrangement'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD layout: Left-to-right, top-to-bottom flow</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>ax_good <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>ax_good.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'✓ GOOD LAYOUT</span><span class="ch">\n\n</span><span class="st">Logical order:</span><span class="ch">\n</span><span class="st">A → B → C → D</span><span class="ch">\n\n</span><span class="st">Follows workflow!'</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>            bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#CCFFCC'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>ax_good.axis(<span class="st">'off'</span>)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>ax_good.set_title(<span class="st">'Logical Panel Arrangement'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed example: Multi-step experiment</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">2</span>, <span class="dv">4</span>, left<span class="op">=</span><span class="fl">0.05</span>, right<span class="op">=</span><span class="fl">0.95</span>, bottom<span class="op">=</span><span class="fl">0.05</span>, top<span class="op">=</span><span class="fl">0.45</span>,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                     hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Sample collection</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>ax_a <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>ax_a.bar([<span class="st">'Ctrl'</span>, <span class="st">'Trt'</span>], [<span class="dv">10</span>, <span class="dv">10</span>], color<span class="op">=</span>[<span class="st">'#7F8C8D'</span>, <span class="st">'#3498DB'</span>],</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>ax_a.set_ylabel(<span class="st">'Samples'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>ax_a.set_title(<span class="st">'A. Sample Collection'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>ax_a.text(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="st">'STEP 1'</span>, transform<span class="op">=</span>ax_a.transAxes,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrow to next step</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>ax_arrow1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, :<span class="dv">2</span>])</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>ax_arrow1.annotate(<span class="st">''</span>, xy<span class="op">=</span>(<span class="fl">0.75</span>, <span class="fl">0.5</span>), xytext<span class="op">=</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>),</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>                  arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, lw<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'black'</span>),</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>                  xycoords<span class="op">=</span><span class="st">'axes fraction'</span>)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>ax_arrow1.axis(<span class="st">'off'</span>)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Processing</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>ax_b <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate gel/blot</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>gel_data <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">4</span>)</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>ax_b.imshow(gel_data, cmap<span class="op">=</span><span class="st">'gray_r'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>ax_b.set_title(<span class="st">'B. Western Blot'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>ax_b.axis(<span class="st">'off'</span>)</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>ax_b.text(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="st">'STEP 2'</span>, transform<span class="op">=</span>ax_b.transAxes,</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Quantification</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>ax_c <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">2</span>])</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">145</span>]</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>ax_c.bar([<span class="st">'Ctrl'</span>, <span class="st">'Trt'</span>], values, color<span class="op">=</span>[<span class="st">'#7F8C8D'</span>, <span class="st">'#3498DB'</span>],</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>ax_c.set_ylabel(<span class="st">'Protein Level (%)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>ax_c.set_title(<span class="st">'C. Quantification'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>ax_c.axhline(<span class="dv">100</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>ax_c.text(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="st">'STEP 3'</span>, transform<span class="op">=</span>ax_c.transAxes,</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel D: Statistical analysis</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>ax_d <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">3</span>])</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter with error bars</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>x_data <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>y_data <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">145</span>]</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">8</span>, <span class="dv">12</span>]</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>ax_d.errorbar(x_data, y_data, yerr<span class="op">=</span>errors, fmt<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>             capsize<span class="op">=</span><span class="dv">10</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>ax_d.set_xlim(<span class="fl">0.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>ax_d.set_xticks([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>ax_d.set_xticklabels([<span class="st">'Ctrl'</span>, <span class="st">'Trt'</span>])</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>ax_d.set_ylabel(<span class="st">'Protein Level (%)'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>ax_d.set_title(<span class="st">'D. Statistics (n=3)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>ax_d.plot([<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">155</span>, <span class="dv">155</span>], <span class="st">'k-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>ax_d.text(<span class="fl">1.5</span>, <span class="dv">158</span>, <span class="st">'**'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>ax_d.text(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="st">'STEP 4'</span>, transform<span class="op">=</span>ax_d.transAxes,</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>         bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Add flow arrows between all panels in bottom row</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>    ax_flow <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, :])</span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>    ax_flow.annotate(<span class="st">''</span>, xy<span class="op">=</span>((i<span class="op">+</span><span class="fl">1.5</span>)<span class="op">/</span><span class="dv">4</span>, <span class="fl">0.5</span>), xytext<span class="op">=</span>((i<span class="op">+</span><span class="fl">0.5</span>)<span class="op">/</span><span class="dv">4</span>, <span class="fl">0.5</span>),</span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>                    arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, lw<span class="op">=</span><span class="fl">2.5</span>, color<span class="op">=</span><span class="st">'blue'</span>),</span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>                    xycoords<span class="op">=</span><span class="st">'axes fraction'</span>)</span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>    ax_flow.axis(<span class="st">'off'</span>)</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'layout_logic_narrative_flow.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="panel-size-considerations-the-a4-paper-test" class="level3">
<h3 class="anchored" data-anchor-id="panel-size-considerations-the-a4-paper-test"><strong>5.8 Panel Size Considerations: The A4 Paper Test</strong></h3>
<p><strong>Practical tip:</strong> Use physical A4 paper to test figure size on screen.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guideline for sizing figures</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">FIGURE SIZE GUIDELINES:</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">1. SINGLE COLUMN (journal dependent):</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">   - Nature/Science: 89 mm (3.5 inches)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">   - Cell: 85 mm (3.35 inches)</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">   - PLOS: 83 mm (3.27 inches)</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">   → In code: figsize=(3.5, 2.5) for 3.5" × 2.5"</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">2. DOUBLE COLUMN:</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">   - Nature/Science: 183 mm (7.2 inches)</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">   - Cell: 178 mm (7 inches)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">   - PLOS: 173 mm (6.8 inches)</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">   → In code: figsize=(7, 5) for 7" × 5"</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">3. A4 PAPER </span><span class="al">TEST</span><span class="co">:</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">   - A4 = 210 mm × 297 mm (8.27" × 11.69")</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co">   - Print your figure at intended size</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">   - Place on screen next to code</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">   - Check:</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">     * Can you read smallest text?</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">     * Are symbols distinguishable?</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">     * Is white space appropriate?</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Create figure at publication size</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">6</span>))  <span class="co"># Double column width</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ... add your plots ...</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Before saving, test print:</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Save as PDF: plt.savefig('test_print.pdf', dpi=300)</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Print at 100% scale (NO "fit to page")</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Place printed version on screen</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Compare to on-screen version</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Check minimum font sizes</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>min_fontsize <span class="op">=</span> <span class="dv">6</span>  <span class="co"># points (minimum readable after reduction)</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flat:</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'X Label'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)  <span class="co"># Will reduce to ~8pt</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Y Label'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">9</span>)  <span class="co"># Will reduce to ~6.5pt</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Title'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)  <span class="co"># Will reduce to ~8.5pt</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Journal may reduce figure by 50-75%</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="co"># So design at final size, not current screen size!</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'size_test_figure.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="scientific-figure-design-comprehensive-quick-reference-guide" class="level1">
<h1>Scientific Figure Design: Comprehensive Quick Reference Guide</h1>
<hr>
<section id="part-i-pre-design-decision-framework" class="level2">
<h2 class="anchored" data-anchor-id="part-i-pre-design-decision-framework">Part I: Pre-Design Decision Framework</h2>
<section id="step-1-define-your-message" class="level3">
<h3 class="anchored" data-anchor-id="step-1-define-your-message">Step 1: Define Your Message</h3>
<pre><code>Ask yourself:
1. What is the ONE key finding this figure must communicate?
2. Who is the audience? (Specialists vs. general scientists)
3. What comparison is most important? (Groups, time, relationships)
4. What level of detail is required? (Overview vs. granular)

→ Answer determines: Plot type, layout complexity, detail level</code></pre>
</section>
<section id="step-2-assess-your-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="step-2-assess-your-data-structure">Step 2: Assess Your Data Structure</h3>
<pre><code>Data characteristics checklist:
 Continuous or categorical variables?
 How many variables? (1, 2, 3+)
 Sample size? (n &lt; 20, 20-100, &gt;100)
 Distribution shape? (Normal, skewed, bimodal)
 Temporal component? (Time series, sequential)
 Hierarchical or grouped structure?
 Comparisons needed? (Between groups, over time, correlations)

→ Determines: Plot type selection (see Part II)</code></pre>
</section>
<section id="step-3-choose-plot-type" class="level3">
<h3 class="anchored" data-anchor-id="step-3-choose-plot-type">Step 3: Choose Plot Type</h3>
<p><em>See detailed decision tree in Part II</em></p>
</section>
<section id="step-4-establish-style-specifications" class="level3">
<h3 class="anchored" data-anchor-id="step-4-establish-style-specifications">Step 4: Establish Style Specifications</h3>
<pre><code>Before creating ANY figures, document:
 Font family (Arial/Helvetica recommended)
 Font size hierarchy (panel labels &gt; titles &gt; axis labels &gt; ticks)
 Color scheme (3 colors maximum, semantic consistency)
 Line widths (data: 2-3pt, axes: 1-1.5pt, grid: 0.5pt)
 Marker sizes (scatter: 50-80, line markers: 5-6)
 Error bar type (SEM vs SD - must be consistent)

→ Create template file to enforce consistency</code></pre>
<hr>
</section>
</section>
<section id="part-ii-plot-type-selection-matrix" class="level2">
<h2 class="anchored" data-anchor-id="part-ii-plot-type-selection-matrix">Part II: Plot Type Selection Matrix</h2>
<section id="for-comparing-groups" class="level3">
<h3 class="anchored" data-anchor-id="for-comparing-groups">For Comparing Groups</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Best Plot</th>
<th>Key Considerations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Few groups (&lt;5), one variable</strong></td>
<td>Bar chart</td>
<td>Start at zero, show error bars, include n</td>
</tr>
<tr class="even">
<td><strong>Few groups, show distribution</strong></td>
<td>Box plot or Violin plot</td>
<td>Box = quartiles, Violin = density shape</td>
</tr>
<tr class="odd">
<td><strong>Many groups (&gt;5)</strong></td>
<td>Small multiples or Heatmap</td>
<td>Avoid single cluttered panel</td>
</tr>
<tr class="even">
<td><strong>Bimodal/complex distributions</strong></td>
<td>Violin plot</td>
<td>Box plot will hide multiple peaks</td>
</tr>
</tbody>
</table>
</section>
<section id="for-showing-distributions" class="level3">
<h3 class="anchored" data-anchor-id="for-showing-distributions">For Showing Distributions</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Best Plot</th>
<th>Key Considerations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Single distribution</strong></td>
<td>Histogram or Density plot</td>
<td>Choose bin width carefully (Sturges’, FD)</td>
</tr>
<tr class="even">
<td><strong>Compare 2-3 distributions</strong></td>
<td>Overlapping density plots</td>
<td>Transparency helps</td>
</tr>
<tr class="odd">
<td><strong>Compare many distributions</strong></td>
<td>Ridgeline plot or Box plot grid</td>
<td>Maintain consistent scales</td>
</tr>
</tbody>
</table>
</section>
<section id="for-relationships" class="level3">
<h3 class="anchored" data-anchor-id="for-relationships">For Relationships</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Best Plot</th>
<th>Key Considerations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Two continuous variables</strong></td>
<td>Scatter plot</td>
<td>Always plot raw data (Anscombe warning!)</td>
</tr>
<tr class="even">
<td><strong>Dense scatter (&gt;1000 points)</strong></td>
<td>Hexbin or 2D density</td>
<td>Avoid point occlusion</td>
</tr>
<tr class="odd">
<td><strong>Correlation matrix</strong></td>
<td>Heatmap with hierarchical clustering</td>
<td>Symmetric diverging colormap</td>
</tr>
</tbody>
</table>
</section>
<section id="for-temporal-data" class="level3">
<h3 class="anchored" data-anchor-id="for-temporal-data">For Temporal Data</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Best Plot</th>
<th>Key Considerations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Single time series</strong></td>
<td>Line graph</td>
<td>Lines imply continuity</td>
</tr>
<tr class="even">
<td><strong>Few time series (2-4)</strong></td>
<td>Line graph, different colors</td>
<td>Add legend or direct labels</td>
</tr>
<tr class="odd">
<td><strong>Many time series (&gt;5)</strong></td>
<td>Small multiples OR Highlight one + gray others</td>
<td>Avoid spaghetti plot</td>
</tr>
<tr class="even">
<td><strong>Time series with error</strong></td>
<td>Shaded error band (SEM/SD)</td>
<td>Cleaner than error bars at every point</td>
</tr>
</tbody>
</table>
</section>
<section id="what-to-avoid" class="level3">
<h3 class="anchored" data-anchor-id="what-to-avoid">What to AVOID</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 17%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Never Use</th>
<th>Why</th>
<th>Use Instead</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Pie charts</strong></td>
<td>Angles harder to compare than lengths</td>
<td>Bar chart (horizontal if long labels)</td>
</tr>
<tr class="even">
<td><strong>3D effects on 2D data</strong></td>
<td>Perspective distortion, occlusion</td>
<td>Standard 2D with color/size for 3rd dimension</td>
</tr>
<tr class="odd">
<td><strong>Dual y-axes (usually)</strong></td>
<td>Easily manipulated to mislead</td>
<td>Separate panels or normalize to same scale</td>
</tr>
<tr class="even">
<td><strong>Truncated bar charts</strong></td>
<td>Exaggerates small differences</td>
<td>Always start bars at zero</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="part-iii-color-decision-framework" class="level2">
<h2 class="anchored" data-anchor-id="part-iii-color-decision-framework">Part III: Color Decision Framework</h2>
<section id="step-1-identify-data-type" class="level3">
<h3 class="anchored" data-anchor-id="step-1-identify-data-type">Step 1: Identify Data Type</h3>
<pre><code>Sequential (ordered, one direction):
→ Use: Single-hue gradient (light → dark)
→ Colormap: viridis, plasma, YlOrRd, Blues
→ Example: Gene expression (0 to max)

Diverging (ordered, two directions from center):
→ Use: Two-hue gradient with neutral center
→ Colormap: RdBu, PiYG, BrBG (ensure symmetric!)
→ Example: Fold change (-∞ to +∞, center at 0)

Categorical (unordered groups):
→ Use: Distinct hues, equal saturation
→ Colormap: Okabe-Ito palette, Set2, Dark2
→ Example: Different cell types, treatment groups</code></pre>
</section>
<section id="step-2-apply-semantic-color-logic" class="level3">
<h3 class="anchored" data-anchor-id="step-2-apply-semantic-color-logic">Step 2: Apply Semantic Color Logic</h3>
<pre><code>Control/Baseline: Gray (#7F8C8D)
Experimental conditions: Colors (distinct hues)
Significant results: Deeper saturation
Non-significant: Lighter saturation or gray

CRITICAL: Same group = same color across ALL figures</code></pre>
</section>
<section id="step-3-accessibility-check" class="level3">
<h3 class="anchored" data-anchor-id="step-3-accessibility-check">Step 3: Accessibility Check</h3>
<pre><code>Mandatory checks before finalizing:
 Uses colorblind-safe palette (Okabe-Ito recommended)
 Redundant encoding applied (color + shape/line style)
 Tested with Color Oracle or Coblis simulator
 Works in grayscale (print test)
 Text contrast meets WCAG AA (4.5:1 minimum)</code></pre>
</section>
<section id="step-4-special-cases" class="level3">
<h3 class="anchored" data-anchor-id="step-4-special-cases">Step 4: Special Cases</h3>
<pre><code>All values significant?
→ Don't use binary deep/light colors
→ Encode magnitude with continuous gradient

Missing data (NA)?
→ NEVER use a color from your gradient
→ Use distinct color (gray with black border) OR pattern (crosshatch)

Cyclic data (time of day, angles)?
→ Use cyclic colormap (twilight, hsv)
→ Start and end colors must be similar</code></pre>
<hr>
</section>
</section>
<section id="part-iv-typography-annotation-checklist" class="level2">
<h2 class="anchored" data-anchor-id="part-iv-typography-annotation-checklist">Part IV: Typography &amp; Annotation Checklist</h2>
<section id="font-specifications" class="level3">
<h3 class="anchored" data-anchor-id="font-specifications">Font Specifications</h3>
<pre><code>Font hierarchy (apply consistently):
Panel labels:     14-16pt, bold, black
Titles:           12-13pt, bold, black
Axis labels:      11pt, bold, black  ← ALWAYS include units: "Variable (unit)"
Tick labels:      9pt, regular, dark gray (#333)
Legend text:      9pt, regular, black
Annotations:      9-10pt, regular/italic, black or dark gray

Font family: Sans-serif (Arial, Helvetica, Calibri)</code></pre>
</section>
<section id="axis-label-requirements" class="level3">
<h3 class="anchored" data-anchor-id="axis-label-requirements">Axis Label Requirements</h3>
<pre><code>Format: "Variable Name (units)"

Examples:
✓ "Temperature (°C)"
✓ "Time (hours)"
✓ "Expression Level (FPKM)"
✓ "Fold Change (log₂)"

❌ NEVER:
- "Temperature" (missing units)
- "Expression" (ambiguous scale)
- "Time" (seconds? hours? days?)</code></pre>
</section>
<section id="statistical-annotations" class="level3">
<h3 class="anchored" data-anchor-id="statistical-annotations">Statistical Annotations</h3>
<pre><code>Standard notation:
*     p &lt; 0.05
**    p &lt; 0.01
***   p &lt; 0.001
n.s.  p ≥ 0.05

Required in caption:
- Statistical test used (e.g., "two-way ANOVA with Tukey post-hoc")
- Exact p-values if critical (e.g., "p = 0.003")
- Sample sizes (e.g., "n = 15 per group")</code></pre>
</section>
<section id="caption-structure" class="level3">
<h3 class="anchored" data-anchor-id="caption-structure">Caption Structure</h3>
<pre><code>[Figure #]. [One-sentence summary of main finding].
(A) [Panel A description: what + how + n + stats].
(B) [Panel B description: what + how + n + stats].
[Error bar definition]. [Statistical methods]. [Abbreviations].

Example:
"Figure 2. Treatment A reduces tumor volume in xenograft mice.
(A) Tumor volume over time (n=8 mice per group, mean ± SEM,
two-way ANOVA, **p&lt;0.01). (B) Survival curves (log-rank test,
***p&lt;0.001). Error bars: SEM. * p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001."</code></pre>
<hr>
</section>
</section>
<section id="part-v-layout-composition-checklist" class="level2">
<h2 class="anchored" data-anchor-id="part-v-layout-composition-checklist">Part V: Layout &amp; Composition Checklist</h2>
<section id="panel-arrangement" class="level3">
<h3 class="anchored" data-anchor-id="panel-arrangement">Panel Arrangement</h3>
<pre><code>Equal weight (all panels equally important):
└─ Use: 2×2, 3×3, or uniform grid
└─ Spacing: Equal margins between all panels

Dominant panel (one main + supporting):
└─ Use: Large panel (60-70%) + small panels (15-20%)
└─ Spacing: Main panel prominent, supporting clustered nearby

Sequential/narrative (process flow):
└─ Use: Left-to-right or top-to-bottom progression
└─ Spacing: Tight within sequence, clear breaks between stages</code></pre>
</section>
<section id="aspect-ratio-selection" class="level3">
<h3 class="anchored" data-anchor-id="aspect-ratio-selection">Aspect Ratio Selection</h3>
<pre><code>Data Type          → Recommended Aspect Ratio
Time series        → 16:9 or 3:1 (wide)
Group comparisons  → 4:3 or 3:2 (standard)
Heatmaps           → 1:1 or data-dependent (square/rectangular)
Hierarchical trees → 1:2 or 9:16 (tall)
Spatial maps       → Match geographic proportions</code></pre>
</section>
<section id="white-space-guidelines" class="level3">
<h3 class="anchored" data-anchor-id="white-space-guidelines">White Space Guidelines</h3>
<pre><code>Target: 40-60% white space

Spacing hierarchy (smallest to largest):
1. Within panel: 0.1-0.2 inches (axis to labels)
2. Between related panels: 0.25-0.5 inches
3. Between panel groups: 0.75-1 inch
4. Figure outer margin: 0.75-1 inch

Bar chart specific:
- Bar width : gap ratio ≈ 3:1
- Leave breathing room between bars</code></pre>
<hr>
</section>
</section>
<section id="part-vi-pre-submission-quality-control" class="level2">
<h2 class="anchored" data-anchor-id="part-vi-pre-submission-quality-control">Part VI: Pre-Submission Quality Control</h2>
<section id="technical-specifications" class="level3">
<h3 class="anchored" data-anchor-id="technical-specifications">Technical Specifications</h3>
<pre><code>Resolution:
 Minimum 300 DPI for publication
 600 DPI if images contain fine details (microscopy)

File formats:
 TIFF or PNG for final submission (lossless)
 Vector formats (PDF, EPS) for line graphs if allowed
 RGB color mode (unless journal requires CMYK)

Dimensions:
 Check journal specifications (often 3.5" or 7" column width)
 Export at intended print size (don't rely on scaling)</code></pre>
</section>
<section id="cross-figure-consistency-check" class="level3">
<h3 class="anchored" data-anchor-id="cross-figure-consistency-check">Cross-Figure Consistency Check</h3>
<pre><code>Verify across ALL manuscript figures:
 Font family identical
 Font sizes consistent (panel labels, axes, ticks)
 Color schemes consistent (Control always gray, Drug A always blue, etc.)
 Line widths uniform
 Marker sizes uniform
 Panel label format consistent (A, B, C... placement)
 Error bar definition consistent (all SEM or all SD)
 Statistical notation consistent (*, **, ***)
 Grid styles consistent (if used)
 Legend positions logical</code></pre>
</section>
<section id="accessibility-verification" class="level3">
<h3 class="anchored" data-anchor-id="accessibility-verification">Accessibility Verification</h3>
<pre><code>Final checks before submission:
 Colorblind-safe palette used (Okabe-Ito, ColorBrewer CVD-safe)
 Redundant encoding present (color + shape/line for critical distinctions)
 Tested with Color Oracle or Coblis
 Prints clearly in grayscale
 Text contrast sufficient (WCAG AA: 4.5:1)
 Font sizes readable when printed at target size
 No reliance on color alone for critical information</code></pre>
</section>
<section id="ethical-compliance" class="level3">
<h3 class="anchored" data-anchor-id="ethical-compliance">Ethical Compliance</h3>
<pre><code>Image integrity (microscopy, gels, photos):
 No selective brightness/contrast adjustments
 All adjustments applied uniformly to all comparison images
 Linear adjustments only (no gamma correction)
 Original, unprocessed images available if requested
 All processing documented in Methods section

Color scale integrity:
 Symmetric scales for diverging data (no manipulation)
 No truncated axes (unless explicitly justified)
 Colormap choices documented in caption
 Missing data handled appropriately (not hidden)</code></pre>
<hr>
</section>
</section>
<section id="part-vii-common-mistakes-quick-reference" class="level2">
<h2 class="anchored" data-anchor-id="part-vii-common-mistakes-quick-reference">Part VII: Common Mistakes Quick Reference</h2>
<section id="top-10-errors-to-avoid" class="level3">
<h3 class="anchored" data-anchor-id="top-10-errors-to-avoid">Top 10 Errors to Avoid</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 37%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Error</th>
<th>Why It’s Wrong</th>
<th>Correct Approach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1. Truncated bar chart y-axis</strong></td>
<td>Exaggerates small differences</td>
<td>Always start at zero for bar charts</td>
</tr>
<tr class="even">
<td><strong>2. Using pie charts</strong></td>
<td>Angles harder to compare than lengths</td>
<td>Use bar chart instead</td>
</tr>
<tr class="odd">
<td><strong>3. Missing units on axes</strong></td>
<td>Reader can’t interpret scale</td>
<td>“Variable (unit)” format required</td>
</tr>
<tr class="even">
<td><strong>4. Inconsistent colors across figures</strong></td>
<td>Confuses readers, breaks semantic meaning</td>
<td>Define color scheme once, use everywhere</td>
</tr>
<tr class="odd">
<td><strong>5. No sample size reported</strong></td>
<td>Can’t assess reliability</td>
<td>State n in caption or on figure</td>
</tr>
<tr class="even">
<td><strong>6. Error bar type undefined</strong></td>
<td>SEM vs SD gives different interpretation</td>
<td>Always specify “Error bars: SEM” or “SD”</td>
</tr>
<tr class="odd">
<td><strong>7. Missing colorblind accessibility</strong></td>
<td>Excludes 8% of male readers</td>
<td>Use Okabe-Ito palette + redundant encoding</td>
</tr>
<tr class="even">
<td><strong>8. All-significant data with binary coloring</strong></td>
<td>Loses magnitude information</td>
<td>Use continuous gradient for effect size</td>
</tr>
<tr class="odd">
<td><strong>9. Overlapping text labels</strong></td>
<td>Illegible, unprofessional</td>
<td>Use adjustText (Python) or ggrepel (R)</td>
</tr>
<tr class="even">
<td><strong>10. 3D effects on 2D data</strong></td>
<td>Perspective distortion, looks gimmicky</td>
<td>Use standard 2D with color/size for 3rd variable</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="part-viii-software-specific-quick-commands" class="level2">
<h2 class="anchored" data-anchor-id="part-viii-software-specific-quick-commands">Part VIII: Software-Specific Quick Commands</h2>
<section id="python-matplotlib-essential-commands" class="level3">
<h3 class="anchored" data-anchor-id="python-matplotlib-essential-commands">Python (Matplotlib) Essential Commands</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Global style setup (run once at start)</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">'sans-serif'</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.sans-serif'</span>: [<span class="st">'Arial'</span>, <span class="st">'Helvetica'</span>],</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">9</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: <span class="dv">11</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="dv">12</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="fl">2.5</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.alpha'</span>: <span class="fl">0.3</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito colorblind-safe palette</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>OKABE_ITO <span class="op">=</span> {</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'orange'</span>: <span class="st">'#E69F00'</span>,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sky_blue'</span>: <span class="st">'#56B4E9'</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bluish_green'</span>: <span class="st">'#009E73'</span>,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'yellow'</span>: <span class="st">'#F0E442'</span>,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'blue'</span>: <span class="st">'#0072B2'</span>,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vermilion'</span>: <span class="st">'#D55E00'</span>,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'reddish_purple'</span>: <span class="st">'#CC79A7'</span>,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'black'</span>: <span class="st">'#000000'</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove top and right spines (cleaner look)</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Save at publication quality</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="r-ggplot2-essential-commands" class="level3">
<h3 class="anchored" data-anchor-id="r-ggplot2-essential-commands">R (ggplot2) Essential Commands</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reusable theme</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>manuscript_theme <span class="ot">&lt;-</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">11</span>, <span class="at">base_family =</span> <span class="st">'Arial'</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">'gray90'</span>, <span class="at">size =</span> <span class="fl">0.3</span>),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">'bold'</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Okabe-Ito palette</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>OKABE_ITO <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">orange =</span> <span class="st">'#E69F00'</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sky_blue =</span> <span class="st">'#56B4E9'</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">bluish_green =</span> <span class="st">'#009E73'</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">yellow =</span> <span class="st">'#F0E442'</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">blue =</span> <span class="st">'#0072B2'</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">vermilion =</span> <span class="st">'#D55E00'</span>,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">reddish_purple =</span> <span class="st">'#CC79A7'</span>,</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">black =</span> <span class="st">'#000000'</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to plot</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(...) <span class="sc">+</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> OKABE_ITO[<span class="st">'sky_blue'</span>]) <span class="sc">+</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  manuscript_theme</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Save at publication quality</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'figure.png'</span>, p, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">bg =</span> <span class="st">'white'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="part-ix-journal-specific-considerations" class="level2">
<h2 class="anchored" data-anchor-id="part-ix-journal-specific-considerations">Part IX: Journal-Specific Considerations</h2>
<section id="nature-family" class="level3">
<h3 class="anchored" data-anchor-id="nature-family">Nature Family</h3>
<pre><code>Requirements:
- Figures must be self-explanatory
- Concise but complete captions
- Define all abbreviations
- 300 DPI minimum
- RGB color mode
- TIFF preferred for final submission

Caption style:
- Brief title sentence
- Panel descriptions (a, b, c in lowercase)
- Statistical methods in caption or Methods
- Scale bars required for all images</code></pre>
</section>
<section id="cell-family" class="level3">
<h3 class="anchored" data-anchor-id="cell-family">Cell Family</h3>
<pre><code>Requirements:
- Similar to Nature
- Emphasize reproducibility (n, replicates clearly stated)
- Can use supplementary figures liberally
- 300-600 DPI
- Color figures encouraged (no extra charge)

Caption style:
- Related panels can share description
- "(A-C)" notation for grouped panels
- Error bar type must be specified</code></pre>
</section>
<section id="plos-family" class="level3">
<h3 class="anchored" data-anchor-id="plos-family">PLOS Family</h3>
<pre><code>Requirements:
- Very detailed captions encouraged
- Must be understandable without main text
- Can include more methods detail in caption than Nature/Cell
- 300 DPI
- Figures published under CC-BY license (open access)

Caption style:
- More verbose acceptable
- Extensive statistical details in caption
- All abbreviations defined at first use</code></pre>
<hr>
</section>
</section>
<section id="part-x-emergency-troubleshooting" class="level2">
<h2 class="anchored" data-anchor-id="part-x-emergency-troubleshooting">Part X: Emergency Troubleshooting</h2>
<section id="my-figure-looks-cluttered" class="level3">
<h3 class="anchored" data-anchor-id="my-figure-looks-cluttered">“My figure looks cluttered”</h3>
<pre><code>Solutions:
1. Reduce number of elements (combine categories, show fewer time points)
2. Increase white space (widen margins, reduce bar width)
3. Use small multiples instead of overlaying everything
4. Remove non-essential grid lines
5. Simplify color palette (remove gradients, use solid colors)
6. Increase font sizes (yes, bigger is often clearer)</code></pre>
</section>
<section id="colors-dont-distinguish-well" class="level3">
<h3 class="anchored" data-anchor-id="colors-dont-distinguish-well">“Colors don’t distinguish well”</h3>
<pre><code>Solutions:
1. Test with Color Oracle simulator
2. Switch to Okabe-Ito palette
3. Add redundant encoding (shapes, line styles)
4. Increase saturation difference
5. Check contrast ratio (aim for &gt;4.5:1)
6. Avoid red-green combinations</code></pre>
</section>
<section id="text-is-illegible" class="level3">
<h3 class="anchored" data-anchor-id="text-is-illegible">“Text is illegible”</h3>
<pre><code>Solutions:
1. Increase font size (minimum 9pt for tick labels)
2. Use bold for critical text (axis labels, panel labels)
3. Increase contrast (black text on white background)
4. Remove text overlap (use adjustText or ggrepel)
5. Rotate long axis labels 45° if necessary
6. Simplify category names if too long</code></pre>
</section>
<section id="figure-doesnt-fit-journal-specifications" class="level3">
<h3 class="anchored" data-anchor-id="figure-doesnt-fit-journal-specifications">“Figure doesn’t fit journal specifications”</h3>
<pre><code>Solutions:
1. Check journal's figure guidelines (width, DPI, format)
2. Redesign for column width (single vs. double column)
3. Reduce number of panels (move some to supplement)
4. Adjust aspect ratio to match journal template
5. Export at exact required dimensions (don't rely on scaling)</code></pre>
<hr>
</section>
</section>
<section id="part-xi-final-submission-checklist" class="level2">
<h2 class="anchored" data-anchor-id="part-xi-final-submission-checklist">Part XI: Final Submission Checklist</h2>
<pre><code>Before submitting manuscript:

Figure Files:
 All figures exported at 300+ DPI
 Correct file format (TIFF/PNG or as specified)
 RGB color mode (unless CMYK required)
 Files named according to journal guidelines
 Correct dimensions (match journal column widths)

Visual Consistency:
 All figures use identical font family and sizes
 Color schemes consistent across all figures
 Panel labels (A, B, C...) in consistent position
 Line widths and marker sizes uniform
 Error bar styles and definitions consistent

Scientific Content:
 All axes have labels with units
 All panels have clear titles or descriptions
 Sample sizes (n) stated in captions
 Statistical methods documented
 Error bar types specified (SEM vs SD)
 Significance markers defined (*, **, ***)
 Scale bars present on all images (microscopy, maps)

Accessibility:
 Colorblind-safe palettes used
 Redundant encoding applied where needed
 Tested with colorblind simulator
 Works in grayscale
 Text contrast sufficient (WCAG AA)

Captions:
 Self-contained (understandable without main text)
 All panels described
 Sample sizes and statistics included
 Abbreviations defined
 Technical details provided (scale bars, magnifications, etc.)

Ethics:
 No image manipulation beyond linear adjustments
 All adjustments applied uniformly to comparison images
 Original unprocessed images available
 Processing documented in Methods
 No misleading color scale manipulation</code></pre>
<hr>
</section>
<section id="part-xii-resources-and-tools" class="level2">
<h2 class="anchored" data-anchor-id="part-xii-resources-and-tools">Part XII: Resources and Tools</h2>
<section id="color-tools" class="level3">
<h3 class="anchored" data-anchor-id="color-tools">Color Tools</h3>
<pre><code>Palette generators:
- ColorBrewer 2.0: colorbrewer2.org (CVD-safe filter available)
- Coolors: coolors.co (palette generator)
- Adobe Color: color.adobe.com

Accessibility testing:
- Color Oracle: colororacle.org (desktop, free, real-time CVD simulation)
- Coblis: coblis.blogspot.com (web-based, image upload)
- WebAIM Contrast Checker: webaim.org/resources/contrastchecker/

Recommended palettes:
- Okabe-Ito: Universally colorblind-safe (8 colors)
- Viridis: Perceptually uniform, colorblind-safe (sequential)
- RdBu: Diverging, colorblind-safe (with proper use)</code></pre>
</section>
<section id="layout-and-design-references" class="level3">
<h3 class="anchored" data-anchor-id="layout-and-design-references">Layout and Design References</h3>
<pre><code>Books:
- "The Visual Display of Quantitative Information" by Edward Tufte
- "Fundamentals of Data Visualization" by Claus O. Wilke (free online)
- "Better Presentations" by Jonathan Schwabish

Online guides:
- Fundamentals of Data Visualization: clauswilke.com/dataviz/
- Data-to-Viz: data-to-viz.com (plot type decision tree)
- From Data to Viz: python graph gallery: python-graph-gallery.com</code></pre>
</section>
<section id="software-documentation" class="level3">
<h3 class="anchored" data-anchor-id="software-documentation">Software Documentation</h3>
<pre><code>Python:
- Matplotlib: matplotlib.org/stable/tutorials/
- Seaborn: seaborn.pydata.org/tutorial.html
- Plotly: plotly.com/python/

R:
- ggplot2: ggplot2.tidyverse.org
- patchwork (multi-panel): patchwork.data-imaginist.com
- cowplot (publication-ready): wilkelab.org/cowplot/

Statistics:
- GraphPad Prism tutorials: graphpad.com/guides/
- JASP (free): jasp-stats.org</code></pre>
<hr>
</section>
</section>
<section id="conclusion-the-path-to-publication-quality-figures" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-the-path-to-publication-quality-figures">Conclusion: The Path to Publication-Quality Figures</h2>
<p><strong>Remember the hierarchy of priorities:</strong></p>
<ol type="1">
<li><strong>Scientific accuracy</strong> (correct data representation)</li>
<li><strong>Clarity</strong> (immediate comprehension of key message)</li>
<li><strong>Accessibility</strong> (colorblind-safe, high contrast, clear labels)</li>
<li><strong>Consistency</strong> (uniform style across manuscript)</li>
<li><strong>Aesthetics</strong> (professional appearance, but never at expense of 1-4)</li>
</ol>
<p><strong>When in doubt:</strong> - Ask: “Does this choice help or hinder understanding?” - Simplify rather than embellish - Test on colleagues unfamiliar with your work - Refer back to journal requirements - Prioritize data over decoration</p>
<p><strong>Scientific figures are functional communication tools, not art.</strong> Every design choice must serve the goal of clear, honest, accessible data presentation.</p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter 4.html" class="pagination-link" aria-label="Chapter 4: Data Encoding &amp; Graph Selection">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 4: Data Encoding &amp; Graph Selection</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter 6.html" class="pagination-link" aria-label="Chapter 6: Technical Specifications &amp; Publication Requirements">
        <span class="nav-page-text"><span class="chapter-title">Chapter 6: Technical Specifications &amp; Publication Requirements</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>