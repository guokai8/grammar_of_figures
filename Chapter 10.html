<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 10: Figure Troubleshooting Guide – The Complete Guide to Bash Errors: From Beginner to Expert</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter 9.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter 10.html"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Complete Guide to Bash Errors: From Beginner to Expert</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Grammar of Figures: The Art &amp; Science of Visualizing Data for Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 0.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>Grammar of Figures: The Art and Science of Visualizing Data for Publication</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: The Language of Color</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Typography, Annotation &amp; Labels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: Data Encoding &amp; Graph Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: Technical Specifications &amp; Publication Requirements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Common Figure Types Deep Dive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Specialized Field Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Interactive and Dynamic Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 10.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#diagnostic-framework-my-figure-looks-wrong" id="toc-diagnostic-framework-my-figure-looks-wrong" class="nav-link active" data-scroll-target="#diagnostic-framework-my-figure-looks-wrong">10.1 Diagnostic Framework: “My Figure Looks Wrong”</a>
  <ul class="collapse">
  <li><a href="#systematic-troubleshooting-approach" id="toc-systematic-troubleshooting-approach" class="nav-link" data-scroll-target="#systematic-troubleshooting-approach">Systematic Troubleshooting Approach</a></li>
  </ul></li>
  <li><a href="#technical-issues" id="toc-technical-issues" class="nav-link" data-scroll-target="#technical-issues">10.2 Technical Issues</a>
  <ul class="collapse">
  <li><a href="#problem-1-my-figure-looks-blurrypixelated-when-zoomed" id="toc-problem-1-my-figure-looks-blurrypixelated-when-zoomed" class="nav-link" data-scroll-target="#problem-1-my-figure-looks-blurrypixelated-when-zoomed">Problem 1: “My figure looks blurry,pixelated when zoomed”</a></li>
  <li><a href="#problem-2-colors-look-different-on-screen-vs-print" id="toc-problem-2-colors-look-different-on-screen-vs-print" class="nav-link" data-scroll-target="#problem-2-colors-look-different-on-screen-vs-print">Problem 2: “Colors look different on screen vs print”</a></li>
  <li><a href="#problem-3-file-size-too-large-for-submission" id="toc-problem-3-file-size-too-large-for-submission" class="nav-link" data-scroll-target="#problem-3-file-size-too-large-for-submission">Problem 3: “File size too large for submission”</a></li>
  <li><a href="#problem-4-fonts-look-different-after-export" id="toc-problem-4-fonts-look-different-after-export" class="nav-link" data-scroll-target="#problem-4-fonts-look-different-after-export">Problem 4: “Fonts look different after export”</a></li>
  </ul></li>
  <li><a href="#design-issues" id="toc-design-issues" class="nav-link" data-scroll-target="#design-issues">10.3 Design Issues</a>
  <ul class="collapse">
  <li><a href="#problem-5-text-is-overlapping-and-illegible" id="toc-problem-5-text-is-overlapping-and-illegible" class="nav-link" data-scroll-target="#problem-5-text-is-overlapping-and-illegible">Problem 5: “Text is overlapping and illegible”</a></li>
  <li><a href="#problem-6-figure-looks-clutteredtoo-busy" id="toc-problem-6-figure-looks-clutteredtoo-busy" class="nav-link" data-scroll-target="#problem-6-figure-looks-clutteredtoo-busy">Problem 6: “Figure looks cluttered/too busy”</a></li>
  <li><a href="#problem-7-panels-are-misaligned" id="toc-problem-7-panels-are-misaligned" class="nav-link" data-scroll-target="#problem-7-panels-are-misaligned">Problem 7: “Panels are misaligned”</a></li>
  </ul></li>
  <li><a href="#data-representation-issues" id="toc-data-representation-issues" class="nav-link" data-scroll-target="#data-representation-issues">10.4 Data Representation Issues</a>
  <ul class="collapse">
  <li><a href="#problem-8-my-bar-chart-doesnt-show-the-difference-clearly" id="toc-problem-8-my-bar-chart-doesnt-show-the-difference-clearly" class="nav-link" data-scroll-target="#problem-8-my-bar-chart-doesnt-show-the-difference-clearly">Problem 8: “My bar chart doesn’t show the difference clearly”</a></li>
  <li><a href="#problem-9-p-values-overlap-or-are-unreadable" id="toc-problem-9-p-values-overlap-or-are-unreadable" class="nav-link" data-scroll-target="#problem-9-p-values-overlap-or-are-unreadable">Problem 9: “P-values overlap or are unreadable”</a></li>
  <li><a href="#problem-10-data-points-are-too-small-or-large" id="toc-problem-10-data-points-are-too-small-or-large" class="nav-link" data-scroll-target="#problem-10-data-points-are-too-small-or-large">Problem 10: “Data points are too small or large”</a></li>
  </ul></li>
  <li><a href="#compliance-issues" id="toc-compliance-issues" class="nav-link" data-scroll-target="#compliance-issues">10.5 Compliance Issues</a>
  <ul class="collapse">
  <li><a href="#problem-11-journal-rejected-my-figure-for-image-manipulation" id="toc-problem-11-journal-rejected-my-figure-for-image-manipulation" class="nav-link" data-scroll-target="#problem-11-journal-rejected-my-figure-for-image-manipulation">Problem 11: “Journal rejected my figure for image manipulation”</a></li>
  <li><a href="#problem-12-figure-doesnt-meet-journal-specifications" id="toc-problem-12-figure-doesnt-meet-journal-specifications" class="nav-link" data-scroll-target="#problem-12-figure-doesnt-meet-journal-specifications">Problem 12: “Figure doesn’t meet journal specifications”</a></li>
  </ul></li>
  <li><a href="#quick-fix-cheat-sheet" id="toc-quick-fix-cheat-sheet" class="nav-link" data-scroll-target="#quick-fix-cheat-sheet">10.6 Quick Fix Cheat Sheet</a></li>
  <li><a href="#master-checklist-publication-quality-scientific-figures" id="toc-master-checklist-publication-quality-scientific-figures" class="nav-link" data-scroll-target="#master-checklist-publication-quality-scientific-figures">MASTER CHECKLIST: Publication-Quality Scientific Figures</a>
  <ul class="collapse">
  <li><a href="#section-1-pre-design-planning" id="toc-section-1-pre-design-planning" class="nav-link" data-scroll-target="#section-1-pre-design-planning">SECTION 1: PRE-DESIGN PLANNING</a>
  <ul class="collapse">
  <li><a href="#define-your-message" id="toc-define-your-message" class="nav-link" data-scroll-target="#define-your-message">1.1 Define Your Message</a></li>
  <li><a href="#data-assessment" id="toc-data-assessment" class="nav-link" data-scroll-target="#data-assessment">1.2 Data Assessment</a></li>
  <li><a href="#journal-requirements-research" id="toc-journal-requirements-research" class="nav-link" data-scroll-target="#journal-requirements-research">1.3 Journal Requirements Research</a></li>
  </ul></li>
  <li><a href="#section-2-color-design" id="toc-section-2-color-design" class="nav-link" data-scroll-target="#section-2-color-design">SECTION 2: COLOR DESIGN</a>
  <ul class="collapse">
  <li><a href="#color-palette-selection" id="toc-color-palette-selection" class="nav-link" data-scroll-target="#color-palette-selection">2.1 Color Palette Selection</a></li>
  <li><a href="#color-accessibility" id="toc-color-accessibility" class="nav-link" data-scroll-target="#color-accessibility">2.2 Color Accessibility</a></li>
  <li><a href="#color-scale-integrity" id="toc-color-scale-integrity" class="nav-link" data-scroll-target="#color-scale-integrity">2.3 Color Scale Integrity</a></li>
  </ul></li>
  <li><a href="#section-3-typography-labels" id="toc-section-3-typography-labels" class="nav-link" data-scroll-target="#section-3-typography-labels">SECTION 3: TYPOGRAPHY &amp; LABELS</a>
  <ul class="collapse">
  <li><a href="#font-specifications" id="toc-font-specifications" class="nav-link" data-scroll-target="#font-specifications">3.1 Font Specifications</a></li>
  <li><a href="#axis-labels" id="toc-axis-labels" class="nav-link" data-scroll-target="#axis-labels">3.2 Axis Labels</a></li>
  <li><a href="#statistical-annotations" id="toc-statistical-annotations" class="nav-link" data-scroll-target="#statistical-annotations">3.3 Statistical Annotations</a></li>
  <li><a href="#text-readability" id="toc-text-readability" class="nav-link" data-scroll-target="#text-readability">3.4 Text Readability</a></li>
  </ul></li>
  <li><a href="#section-4-plot-type-selection" id="toc-section-4-plot-type-selection" class="nav-link" data-scroll-target="#section-4-plot-type-selection">SECTION 4: PLOT TYPE SELECTION</a>
  <ul class="collapse">
  <li><a href="#comparing-groups" id="toc-comparing-groups" class="nav-link" data-scroll-target="#comparing-groups">4.1 Comparing Groups</a></li>
  <li><a href="#distributions" id="toc-distributions" class="nav-link" data-scroll-target="#distributions">4.2 Distributions</a></li>
  <li><a href="#relationships" id="toc-relationships" class="nav-link" data-scroll-target="#relationships">4.3 Relationships</a></li>
  <li><a href="#time-series" id="toc-time-series" class="nav-link" data-scroll-target="#time-series">4.4 Time Series</a></li>
  <li><a href="#what-to-avoid" id="toc-what-to-avoid" class="nav-link" data-scroll-target="#what-to-avoid">4.5 What to AVOID</a></li>
  </ul></li>
  <li><a href="#section-5-layout-composition" id="toc-section-5-layout-composition" class="nav-link" data-scroll-target="#section-5-layout-composition">SECTION 5: LAYOUT &amp; COMPOSITION</a>
  <ul class="collapse">
  <li><a href="#panel-arrangement" id="toc-panel-arrangement" class="nav-link" data-scroll-target="#panel-arrangement">5.1 Panel Arrangement</a></li>
  <li><a href="#aspect-ratios" id="toc-aspect-ratios" class="nav-link" data-scroll-target="#aspect-ratios">5.2 Aspect Ratios</a></li>
  <li><a href="#white-space" id="toc-white-space" class="nav-link" data-scroll-target="#white-space">5.3 White Space</a></li>
  <li><a href="#panel-labels" id="toc-panel-labels" class="nav-link" data-scroll-target="#panel-labels">5.4 Panel Labels</a></li>
  </ul></li>
  <li><a href="#section-6-technical-specifications" id="toc-section-6-technical-specifications" class="nav-link" data-scroll-target="#section-6-technical-specifications">SECTION 6: TECHNICAL SPECIFICATIONS</a>
  <ul class="collapse">
  <li><a href="#resolution" id="toc-resolution" class="nav-link" data-scroll-target="#resolution">6.1 Resolution</a></li>
  <li><a href="#file-format" id="toc-file-format" class="nav-link" data-scroll-target="#file-format">6.2 File Format</a></li>
  <li><a href="#dimensions" id="toc-dimensions" class="nav-link" data-scroll-target="#dimensions">6.3 Dimensions</a></li>
  <li><a href="#file-size" id="toc-file-size" class="nav-link" data-scroll-target="#file-size">6.4 File Size</a></li>
  </ul></li>
  <li><a href="#section-7-field-specific-requirements" id="toc-section-7-field-specific-requirements" class="nav-link" data-scroll-target="#section-7-field-specific-requirements">SECTION 7: FIELD-SPECIFIC REQUIREMENTS</a>
  <ul class="collapse">
  <li><a href="#microscopy-images" id="toc-microscopy-images" class="nav-link" data-scroll-target="#microscopy-images">7.1 Microscopy Images</a></li>
  <li><a href="#western-blots" id="toc-western-blots" class="nav-link" data-scroll-target="#western-blots">7.2 Western Blots</a></li>
  <li><a href="#flow-cytometry" id="toc-flow-cytometry" class="nav-link" data-scroll-target="#flow-cytometry">7.3 Flow Cytometry</a></li>
  <li><a href="#phylogenetic-trees" id="toc-phylogenetic-trees" class="nav-link" data-scroll-target="#phylogenetic-trees">7.4 Phylogenetic Trees</a></li>
  <li><a href="#network-diagrams" id="toc-network-diagrams" class="nav-link" data-scroll-target="#network-diagrams">7.5 Network Diagrams</a></li>
  </ul></li>
  <li><a href="#section-8-specialized-plot-types" id="toc-section-8-specialized-plot-types" class="nav-link" data-scroll-target="#section-8-specialized-plot-types">SECTION 8: SPECIALIZED PLOT TYPES</a>
  <ul class="collapse">
  <li><a href="#heatmaps" id="toc-heatmaps" class="nav-link" data-scroll-target="#heatmaps">8.1 Heatmaps</a></li>
  <li><a href="#volcano-plots" id="toc-volcano-plots" class="nav-link" data-scroll-target="#volcano-plots">8.2 Volcano Plots</a></li>
  <li><a href="#pca-plots" id="toc-pca-plots" class="nav-link" data-scroll-target="#pca-plots">8.3 PCA Plots</a></li>
  <li><a href="#survival-curves-kaplan-meier" id="toc-survival-curves-kaplan-meier" class="nav-link" data-scroll-target="#survival-curves-kaplan-meier">8.4 Survival Curves (Kaplan-Meier)</a></li>
  <li><a href="#roc-curves" id="toc-roc-curves" class="nav-link" data-scroll-target="#roc-curves">8.5 ROC Curves</a></li>
  </ul></li>
  <li><a href="#section-9-captions" id="toc-section-9-captions" class="nav-link" data-scroll-target="#section-9-captions">SECTION 9: CAPTIONS</a>
  <ul class="collapse">
  <li><a href="#caption-structure" id="toc-caption-structure" class="nav-link" data-scroll-target="#caption-structure">9.1 Caption Structure</a></li>
  </ul></li>
  <li><a href="#section-10-cross-figure-consistency" id="toc-section-10-cross-figure-consistency" class="nav-link" data-scroll-target="#section-10-cross-figure-consistency">SECTION 10: CROSS-FIGURE CONSISTENCY</a>
  <ul class="collapse">
  <li><a href="#manuscript-wide-checks" id="toc-manuscript-wide-checks" class="nav-link" data-scroll-target="#manuscript-wide-checks">10.1 Manuscript-Wide Checks</a></li>
  <li><a href="#style-guide-documentation" id="toc-style-guide-documentation" class="nav-link" data-scroll-target="#style-guide-documentation">10.2 Style Guide Documentation</a></li>
  </ul></li>
  <li><a href="#section-11-ethical-compliance" id="toc-section-11-ethical-compliance" class="nav-link" data-scroll-target="#section-11-ethical-compliance">SECTION 11: ETHICAL COMPLIANCE</a>
  <ul class="collapse">
  <li><a href="#image-integrity" id="toc-image-integrity" class="nav-link" data-scroll-target="#image-integrity">11.1 Image Integrity</a></li>
  <li><a href="#data-integrity" id="toc-data-integrity" class="nav-link" data-scroll-target="#data-integrity">11.2 Data Integrity</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation">11.3 Documentation</a></li>
  </ul></li>
  <li><a href="#section-12-pre-submission-final-checks" id="toc-section-12-pre-submission-final-checks" class="nav-link" data-scroll-target="#section-12-pre-submission-final-checks">SECTION 12: PRE-SUBMISSION FINAL CHECKS</a>
  <ul class="collapse">
  <li><a href="#technical-quality" id="toc-technical-quality" class="nav-link" data-scroll-target="#technical-quality">12.1 Technical Quality</a></li>
  <li><a href="#visual-quality" id="toc-visual-quality" class="nav-link" data-scroll-target="#visual-quality">12.2 Visual Quality</a></li>
  <li><a href="#content-completeness" id="toc-content-completeness" class="nav-link" data-scroll-target="#content-completeness">12.3 Content Completeness</a></li>
  <li><a href="#accessibility" id="toc-accessibility" class="nav-link" data-scroll-target="#accessibility">12.4 Accessibility</a></li>
  <li><a href="#journal-specific" id="toc-journal-specific" class="nav-link" data-scroll-target="#journal-specific">12.5 Journal-Specific</a></li>
  </ul></li>
  <li><a href="#section-13-interactive-figures-if-applicable" id="toc-section-13-interactive-figures-if-applicable" class="nav-link" data-scroll-target="#section-13-interactive-figures-if-applicable">SECTION 13: INTERACTIVE FIGURES (if applicable)</a>
  <ul class="collapse">
  <li><a href="#interactive-figure-requirements" id="toc-interactive-figure-requirements" class="nav-link" data-scroll-target="#interactive-figure-requirements">13.1 Interactive Figure Requirements</a></li>
  <li><a href="#caption-for-interactive" id="toc-caption-for-interactive" class="nav-link" data-scroll-target="#caption-for-interactive">13.2 Caption for Interactive</a></li>
  </ul></li>
  <li><a href="#section-14-troubleshooting-quick-fixes" id="toc-section-14-troubleshooting-quick-fixes" class="nav-link" data-scroll-target="#section-14-troubleshooting-quick-fixes">SECTION 14: TROUBLESHOOTING QUICK FIXES</a>
  <ul class="collapse">
  <li><a href="#one-line-fixes" id="toc-one-line-fixes" class="nav-link" data-scroll-target="#one-line-fixes">14.1 One-Line Fixes</a></li>
  <li><a href="#common-problems-solutions" id="toc-common-problems-solutions" class="nav-link" data-scroll-target="#common-problems-solutions">14.2 Common Problems → Solutions</a></li>
  </ul></li>
  <li><a href="#section-15-manuscript-submission-checklist" id="toc-section-15-manuscript-submission-checklist" class="nav-link" data-scroll-target="#section-15-manuscript-submission-checklist">SECTION 15: MANUSCRIPT SUBMISSION CHECKLIST</a>
  <ul class="collapse">
  <li><a href="#all-figures" id="toc-all-figures" class="nav-link" data-scroll-target="#all-figures">15.1 All Figures</a></li>
  <li><a href="#cover-letter" id="toc-cover-letter" class="nav-link" data-scroll-target="#cover-letter">15.2 Cover Letter</a></li>
  <li><a href="#methods-section" id="toc-methods-section" class="nav-link" data-scroll-target="#methods-section">15.3 Methods Section</a></li>
  </ul></li>
  <li><a href="#section-16-post-submission" id="toc-section-16-post-submission" class="nav-link" data-scroll-target="#section-16-post-submission">SECTION 16: POST-SUBMISSION</a>
  <ul class="collapse">
  <li><a href="#revision-response" id="toc-revision-response" class="nav-link" data-scroll-target="#revision-response">16.1 Revision Response</a></li>
  <li><a href="#data-archival" id="toc-data-archival" class="nav-link" data-scroll-target="#data-archival">16.2 Data Archival</a></li>
  </ul></li>
  <li><a href="#emergency-deadline-checklist-30-min-review" id="toc-emergency-deadline-checklist-30-min-review" class="nav-link" data-scroll-target="#emergency-deadline-checklist-30-min-review">EMERGENCY DEADLINE CHECKLIST (30-min review)</a></li>
  <li><a href="#resources-tools" id="toc-resources-tools" class="nav-link" data-scroll-target="#resources-tools">RESOURCES &amp; TOOLS</a>
  <ul class="collapse">
  <li><a href="#software" id="toc-software" class="nav-link" data-scroll-target="#software">Software</a></li>
  <li><a href="#color-palettes" id="toc-color-palettes" class="nav-link" data-scroll-target="#color-palettes">Color Palettes</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#online-validators" id="toc-online-validators" class="nav-link" data-scroll-target="#online-validators">Online Validators</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="diagnostic-framework-my-figure-looks-wrong" class="level2">
<h2 class="anchored" data-anchor-id="diagnostic-framework-my-figure-looks-wrong">10.1 Diagnostic Framework: “My Figure Looks Wrong”</h2>
<section id="systematic-troubleshooting-approach" class="level3">
<h3 class="anchored" data-anchor-id="systematic-troubleshooting-approach">Systematic Troubleshooting Approach</h3>
<p><strong>When your figure doesn’t look right, follow this diagnostic tree:</strong></p>
<pre><code>STEP 1: Identify the problem category
├─ Technical issues (resolution, colors, file format)
├─ Design issues (layout, spacing, readability)
├─ Data representation issues (plot type, axes, scale)
└─ Compliance issues (journal requirements, ethical standards)

STEP 2: Apply category-specific solutions (see sections below)

STEP 3: Verify fix doesn't create new problems

STEP 4: Document what worked for future reference</code></pre>
<hr>
</section>
</section>
<section id="technical-issues" class="level2">
<h2 class="anchored" data-anchor-id="technical-issues">10.2 Technical Issues</h2>
<section id="problem-1-my-figure-looks-blurrypixelated-when-zoomed" class="level3">
<h3 class="anchored" data-anchor-id="problem-1-my-figure-looks-blurrypixelated-when-zoomed">Problem 1: “My figure looks blurry,pixelated when zoomed”</h3>
<p><strong>Symptoms:</strong></p>
<ul>
<li>Text appears fuzzy</li>
<li>Lines have jagged edges</li>
<li>Image quality degrades when enlarged</li>
</ul>
<p><strong>Diagnosis:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'your_figure.png'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Size: </span><span class="sc">{</span>img<span class="sc">.</span>size<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"DPI: </span><span class="sc">{</span>img<span class="sc">.</span>info<span class="sc">.</span>get(<span class="st">'dpi'</span>, <span class="st">'Not set'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effective DPI</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>width_inches <span class="op">=</span> <span class="dv">7</span>  <span class="co"># Intended print width</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>dpi_effective <span class="op">=</span> img.size[<span class="dv">0</span>] <span class="op">/</span> width_inches</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Effective DPI at </span><span class="sc">{</span>width_inches<span class="sc">}</span><span class="ch">\"</span><span class="ss"> width: </span><span class="sc">{</span>dpi_effective<span class="sc">:.1f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1: Re-export at higher DPI</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ... your plotting code ...</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save at 300 DPI (publication standard)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure_300dpi.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For microscopy/detailed images, use 600 DPI</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure_600dpi.png'</span>, dpi<span class="op">=</span><span class="dv">600</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Common mistake: Upsampling after creation</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ❌ WRONG: This doesn't add information</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'low_res.png'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>img_upsampled <span class="op">=</span> img.resize((img.width<span class="op">*</span><span class="dv">2</span>, img.height<span class="op">*</span><span class="dv">2</span>), Image.LANCZOS)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># → Still blurry, just larger file</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ✓ CORRECT: Create at target resolution from start</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>), dpi<span class="op">=</span><span class="dv">300</span>)  <span class="co"># Set DPI at creation</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="problem-2-colors-look-different-on-screen-vs-print" class="level3">
<h3 class="anchored" data-anchor-id="problem-2-colors-look-different-on-screen-vs-print">Problem 2: “Colors look different on screen vs print”</h3>
<p>Cause: RGB (screen) vs CMYK (print) color space mismatch</p>
<p><strong>Diagnosis:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'figure.png'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Color mode: </span><span class="sc">{</span>img<span class="sc">.</span>mode<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># RGB = screen colors, CMYK = print colors</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preventive: Use print-safe RGB colors from the start</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Avoid highly saturated colors that can't be printed</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>PRINT_SAFE_PALETTE <span class="op">=</span> {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'blue'</span>: <span class="st">'#0066CC'</span>,      <span class="co"># Instead of pure #0000FF</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'red'</span>: <span class="st">'#CC0000'</span>,       <span class="co"># Instead of pure #FF0000</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'green'</span>: <span class="st">'#009900'</span>,     <span class="co"># Instead of pure #00FF00</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'orange'</span>: <span class="st">'#CC6600'</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'purple'</span>: <span class="st">'#9933CC'</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Test colors in grayscale (simulate print preview)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Original colors</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> axes[<span class="dv">0</span>].imshow(data, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Original (RGB)'</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Grayscale preview (simulates black &amp; white print)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> axes[<span class="dv">1</span>].imshow(data, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Grayscale Preview'</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'color_test.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Journal-specific fix:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some journals require CMYK conversion</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Do this ONLY if explicitly required</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert RGB to CMYK</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>img_rgb <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'figure_rgb.png'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>img_cmyk <span class="op">=</span> img_rgb.convert(<span class="st">'CMYK'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>img_cmyk.save(<span class="st">'figure_cmyk.tif'</span>)  <span class="co"># TIFF supports CMYK</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"⚠ Warning: Colors may shift during conversion"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"→ Preview before submission"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="problem-3-file-size-too-large-for-submission" class="level3">
<h3 class="anchored" data-anchor-id="problem-3-file-size-too-large-for-submission">Problem 3: “File size too large for submission”</h3>
<p><strong>Diagnosis:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">'large_figure.png'</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>size_mb <span class="op">=</span> os.path.getsize(file_path) <span class="op">/</span> (<span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Current file size: </span><span class="sc">{</span>size_mb<span class="sc">:.2f}</span><span class="ss"> MB"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check journal limit (common limits: 5-20 MB per figure)</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>limit_mb <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> size_mb <span class="op">&gt;</span> limit_mb:</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"❌ Exceeds </span><span class="sc">{</span>limit_mb<span class="sc">}</span><span class="ss"> MB limit"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solutions (in order of preference):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1: Optimize compression (lossless)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'large_figure.png'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># PNG optimization</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>img.save(<span class="st">'optimized.png'</span>, optimize<span class="op">=</span><span class="va">True</span>, compress_level<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check new size</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>new_size <span class="op">=</span> os.path.getsize(<span class="st">'optimized.png'</span>) <span class="op">/</span> (<span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Optimized size: </span><span class="sc">{</span>new_size<span class="sc">:.2f}</span><span class="ss"> MB (</span><span class="sc">{</span>(<span class="dv">1</span><span class="op">-</span>new_size<span class="op">/</span>size_mb)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% reduction)"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2: Reduce dimensions (if too large)</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Only if figure dimensions exceed journal specifications</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>target_width <span class="op">=</span> <span class="dv">7</span>  <span class="co"># inches</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>current_dpi <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>img_resized <span class="op">=</span> img.resize((<span class="bu">int</span>(target_width <span class="op">*</span> current_dpi),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                         <span class="bu">int</span>(target_width <span class="op">*</span> current_dpi <span class="op">*</span> img.height <span class="op">/</span> img.width)),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                        Image.LANCZOS)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>img_resized.save(<span class="st">'resized.png'</span>, optimize<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 3: Use TIFF with LZW compression (lossless)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>img.save(<span class="st">'compressed.tif'</span>, compression<span class="op">=</span><span class="st">'tiff_lzw'</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 4: Split into multiple panels (if complex)</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Save panels separately, combine in manuscript text</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="problem-4-fonts-look-different-after-export" class="level3">
<h3 class="anchored" data-anchor-id="problem-4-fonts-look-different-after-export">Problem 4: “Fonts look different after export”</h3>
<p><strong>Cause:</strong> Font embedding issues</p>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matplotlib: Ensure fonts are embedded</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'pdf.fonttype'</span>] <span class="op">=</span> <span class="dv">42</span>  <span class="co"># TrueType (embeds fonts)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ps.fonttype'</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Or rasterize text (converts to pixels, always works)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure.pdf'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)  <span class="co"># Text as vectors</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># If font still missing, use rasterization</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)  <span class="co"># Text as pixels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure fonts are embedded in PDF</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'figure.pdf'</span>, plot,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> cairo_pdf,  <span class="co"># Uses Cairo for better font handling</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Or save as PNG (rasterizes everything)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'figure.png'</span>, plot,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Fallback: Use system fonts only</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If custom fonts cause issues, stick to universals</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'sans-serif'</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'Arial'</span>, <span class="st">'Helvetica'</span>, <span class="st">'DejaVu Sans'</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># System will use first available font</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="design-issues" class="level2">
<h2 class="anchored" data-anchor-id="design-issues">10.3 Design Issues</h2>
<section id="problem-5-text-is-overlapping-and-illegible" class="level3">
<h3 class="anchored" data-anchor-id="problem-5-text-is-overlapping-and-illegible">Problem 5: “Text is overlapping and illegible”</h3>
<p><strong>Common in:</strong> Scatter plots with many labels, crowded axes</p>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1: Use adjustText library (automatic label adjustment)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> adjustText <span class="im">import</span> adjust_text</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.rand(<span class="dv">30</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.rand(<span class="dv">30</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f'Gene_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">30</span>)]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Without adjustment (overlapping)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>ax1.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, label <span class="kw">in</span> <span class="bu">enumerate</span>(labels):</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    ax1.text(x[i], y[i], label, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ Without Adjustment</span><span class="ch">\n</span><span class="st">(Overlapping labels)'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># With adjustment (clean)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>ax2.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>texts <span class="op">=</span> [ax2.text(x[i], y[i], label, fontsize<span class="op">=</span><span class="dv">8</span>) <span class="cf">for</span> i, label <span class="kw">in</span> <span class="bu">enumerate</span>(labels)]</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>adjust_text(texts, arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'gray'</span>, lw<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ With Adjustment</span><span class="ch">\n</span><span class="st">(Clear labels)'</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'label_overlap_fix.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R equivalent:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)  <span class="co"># Automatic label repelling</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Without repelling (overlapping)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'#3498DB'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Overlaps</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'❌ Without Repelling'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># With repelling (clean)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'#3498DB'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">size =</span> <span class="dv">3</span>,  <span class="co"># Automatic adjustment</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">max.overlaps =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'✓ With Repelling'</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'label_overlap_fix.png'</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution 2: Selective labeling</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label only significant/important points</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>significant_idx <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">28</span>]  <span class="co"># Indices of important points</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> significant_idx:</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    ax.annotate(labels[i], (x[i], y[i]),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>               xytext<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>), textcoords<span class="op">=</span><span class="st">'offset points'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>               fontsize<span class="op">=</span><span class="dv">9</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>               bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>               arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, lw<span class="op">=</span><span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="problem-6-figure-looks-clutteredtoo-busy" class="level3">
<h3 class="anchored" data-anchor-id="problem-6-figure-looks-clutteredtoo-busy">Problem 6: “Figure looks cluttered/too busy”</h3>
<p><strong>Symptoms:</strong></p>
<ul>
<li>Hard to identify key message</li>
<li>Too many colors/patterns</li>
<li>Dense gridlines overwhelm data</li>
</ul>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decluttering checklist:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Remove unnecessary grid lines</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">False</span>)  <span class="co"># Remove all grids</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Or: Use subtle grid</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Remove top and right spines</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Reduce color palette</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ❌ BAD: Too many colors</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> plt.cm.tab20(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">15</span>))  <span class="co"># 15 different colors!</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ✓ GOOD: 3-4 colors maximum</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#7F8C8D'</span>, <span class="st">'#3498DB'</span>, <span class="st">'#E74C3C'</span>]  <span class="co"># Gray, blue, red</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Increase white space</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(left<span class="op">=</span><span class="fl">0.15</span>, right<span class="op">=</span><span class="fl">0.9</span>, top<span class="op">=</span><span class="fl">0.9</span>, bottom<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Use small multiples instead of overlaying everything</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))  <span class="co"># Split into 4 panels</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead of cramming all data into one plot</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Remove redundant legends</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co"># If panel labels (A, B, C) are clear, legend may not be needed</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Before/After Example:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># CLUTTERED VERSION</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.sin(x <span class="op">+</span> i<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> np.random.rand(<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    ax1.plot(x, y, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f'Series </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)  <span class="co"># Heavy grid</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'best'</span>, fontsize<span class="op">=</span><span class="dv">8</span>, ncol<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ Cluttered: Too Many Elements'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># CLEAN VERSION</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only 3 key series</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">9</span>]:</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.sin(x <span class="op">+</span> i<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> np.random.rand(<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    ax2.plot(x, y, linewidth<span class="op">=</span><span class="fl">2.5</span>, label<span class="op">=</span><span class="ss">f'Series </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Others in background (gray)</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]:</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.sin(x <span class="op">+</span> i<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> np.random.rand(<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    ax2.plot(x, y, color<span class="op">=</span><span class="st">'#CCCCCC'</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>ax2.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)  <span class="co"># Subtle grid</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ Clean: Focused Message'</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'declutter_fix.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="problem-7-panels-are-misaligned" class="level3">
<h3 class="anchored" data-anchor-id="problem-7-panels-are-misaligned">Problem 7: “Panels are misaligned”</h3>
<p><strong>Cause:</strong> Inconsistent axis ranges, label sizes, or spacing</p>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1: Use consistent axis limits</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set same limits for all comparable plots</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>xlim_range <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>ylim_range <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.flat:</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... plot data ...</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(xlim_range)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(ylim_range)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2: Use GridSpec for precise control</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.gridspec <span class="im">import</span> GridSpec</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> GridSpec(<span class="dv">2</span>, <span class="dv">2</span>, figure<span class="op">=</span>fig,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>             width_ratios<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>], height_ratios<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>             hspace<span class="op">=</span><span class="fl">0.3</span>, wspace<span class="op">=</span><span class="fl">0.3</span>)  <span class="co"># Consistent spacing</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 3: Match axis label sizes</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> [ax1, ax2, ax3, ax4]:</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'X Label'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Y Label'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">9</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R equivalent:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with consistent limits</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data1, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># Same limits</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data3, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data4, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with patchwork (auto-aligns)</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="data-representation-issues" class="level2">
<h2 class="anchored" data-anchor-id="data-representation-issues">10.4 Data Representation Issues</h2>
<section id="problem-8-my-bar-chart-doesnt-show-the-difference-clearly" class="level3">
<h3 class="anchored" data-anchor-id="problem-8-my-bar-chart-doesnt-show-the-difference-clearly">Problem 8: “My bar chart doesn’t show the difference clearly”</h3>
<p><strong>Diagnosis:</strong> Likely truncated y-axis or wrong plot type</p>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">102</span>, <span class="dv">104</span>]  <span class="co"># Small differences</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: Truncated axis (exaggerates difference)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ax1.bar(categories, data, color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">95</span>, <span class="dv">105</span>)  <span class="co"># Truncated!</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Value'</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ Misleading: Truncated Axis'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'Exaggerates</span><span class="ch">\n</span><span class="st">differences!'</span>, transform<span class="op">=</span>ax1.transAxes,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT: Start at zero (shows true scale)</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>ax2.bar(categories, data, color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">110</span>)  <span class="co"># Starts at zero</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Value'</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ Correct: Zero Baseline'</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ALTERNATIVE: Dot plot with range (if differences are small but real)</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">2</span>]</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>ax3.plot(categories, data, <span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">95</span>, <span class="dv">105</span>)  <span class="co"># Can use truncated axis for dot plots</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>ax3.axhline(<span class="dv">100</span>, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Baseline'</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Value'</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'✓ Alternative: Dot Plot</span><span class="ch">\n</span><span class="st">(Truncation OK here)'</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'bar_chart_fix.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Key rule:</strong></p>
<pre><code>Bar charts: ALWAYS start at zero
Dot plots/line plots: Truncation acceptable if clearly indicated</code></pre>
<hr>
</section>
<section id="problem-9-p-values-overlap-or-are-unreadable" class="level3">
<h3 class="anchored" data-anchor-id="problem-9-p-values-overlap-or-are-unreadable">Problem 9: “P-values overlap or are unreadable”</h3>
<p><strong>Common in:</strong> Plots with many statistical comparisons</p>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">28</span>, <span class="dv">40</span>, <span class="dv">35</span>]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>errors <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: All comparisons shown (cluttered)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax1.bar(categories, values, yerr<span class="op">=</span>errors, capsize<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>              color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="dv">60</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw all pairwise comparisons (too many!)</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>y_max <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(categories)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">+=</span> <span class="dv">3</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    ax1.plot([i, i<span class="op">+</span><span class="dv">1</span>], [y_max, y_max], <span class="st">'k-'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    ax1.text((i <span class="op">+</span> i<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>, y_max <span class="op">+</span> <span class="fl">0.5</span>, <span class="st">'**'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'❌ Cluttered: Too Many Comparisons'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Show only key comparisons</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> ax2.bar(categories, values, yerr<span class="op">=</span>errors, capsize<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>              color<span class="op">=</span><span class="st">'#3498DB'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">0</span>, <span class="dv">55</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only comparisons vs. control (A) or most important</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison: D vs A</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>ax2.plot([<span class="dv">0</span>, <span class="dv">3</span>], [<span class="dv">48</span>, <span class="dv">48</span>], <span class="st">'k-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">1.5</span>, <span class="dv">49</span>, <span class="st">'** p&lt;0.01'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison: E vs A</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>ax2.plot([<span class="dv">0</span>, <span class="dv">4</span>], [<span class="dv">52</span>, <span class="dv">52</span>], <span class="st">'k-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="dv">2</span>, <span class="dv">53</span>, <span class="st">'* p&lt;0.05'</span>, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'✓ Clean: Key Comparisons Only'</span>, color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'statistical_annotation_fix.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Use letters instead of brackets (common in biology)</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>ax.bar(categories, values, ...)</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Add letters above bars</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>letters <span class="op">=</span> [<span class="st">'a'</span>, <span class="st">'ab'</span>, <span class="st">'ab'</span>, <span class="st">'c'</span>, <span class="st">'bc'</span>]  <span class="co"># Different letters = significant difference</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, letter) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, letters)):</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> bar.get_height()</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    ax.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> errors[i] <span class="op">+</span> <span class="dv">1</span>,</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>           letter, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Caption: "Bars with different letters are significantly different (p&lt;0.05, Tukey HSD)"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="problem-10-data-points-are-too-small-or-large" class="level3">
<h3 class="anchored" data-anchor-id="problem-10-data-points-are-too-small-or-large">Problem 10: “Data points are too small or large”</h3>
<p><strong>Solutions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guideline: Marker sizes for readability</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>recommended_sizes <span class="op">=</span> {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'few_points'</span>: (<span class="dv">10</span>, <span class="dv">50</span>),      <span class="co"># &lt;20 points: 50-150 in plt units</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'moderate'</span>: (<span class="dv">50</span>, <span class="dv">100</span>),       <span class="co"># 20-100 points: 30-80</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'many'</span>: (<span class="dv">100</span>, <span class="dv">500</span>),          <span class="co"># 100-500 points: 20-50</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dense'</span>: (<span class="dv">500</span>, <span class="dv">1000</span>),        <span class="co"># &gt;500 points: 10-30 or use hexbin</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'very_dense'</span>: (<span class="dv">1000</span>, <span class="dv">10000</span>)  <span class="co"># &gt;1000 points: 5-15 or 2D density</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust based on figure size</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>fig_inches <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>dpi <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>fig_pixels <span class="op">=</span> fig_inches <span class="op">*</span> dpi</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule of thumb: marker diameter should be 1-3% of figure dimension</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>marker_size_min <span class="op">=</span> (<span class="fl">0.01</span> <span class="op">*</span> fig_pixels)<span class="op">**</span><span class="dv">2</span>  <span class="co"># matplotlib uses area, not diameter</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>marker_size_max <span class="op">=</span> (<span class="fl">0.03</span> <span class="op">*</span> fig_pixels)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recommended marker size range: </span><span class="sc">{</span>marker_size_min<span class="sc">:.0f}</span><span class="ss"> - </span><span class="sc">{</span>marker_size_max<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, ...)  <span class="co"># s = area in points^2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="compliance-issues" class="level2">
<h2 class="anchored" data-anchor-id="compliance-issues">10.5 Compliance Issues</h2>
<section id="problem-11-journal-rejected-my-figure-for-image-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="problem-11-journal-rejected-my-figure-for-image-manipulation">Problem 11: “Journal rejected my figure for image manipulation”</h3>
<p><strong>Common violations:</strong> 1. Selective brightness/contrast adjustment 2. Lane splicing in Western blots without disclosure 3. Background removal 4. Duplicated/cloned elements</p>
<p><strong>Prevention:</strong></p>
<pre><code># Document ALL processing steps
"""
Image Processing Protocol (for Methods section):

1. Microscopy images acquired with:
   - Microscope: [Model]
   - Objective: [Magnification, NA]
   - Camera: [Model]
   - Exposure: [milliseconds]
   - Gain: [value]

2. Post-acquisition processing:
   - Software: ImageJ v1.53
   - Brightness: +10% (applied uniformly to all images)
   - Contrast: Linear adjustment (min=50, max=200, applied uniformly)
   - No gamma adjustment
   - No background subtraction
   - No cloning or content-aware fill

3. Cropping:
   - Representative regions shown
   - Original unprocessed images available upon request

4. Figure assembly:
   - Software: Adobe Illustrator CC 2024
   - No modifications beyond cropping and labeling
"""

# Save original unprocessed images separately
# Name: raw_image_01.tif, raw_image_02.tif, ...
# Keep permanently for potential requests from journal/reviewers</code></pre>
<hr>
</section>
<section id="problem-12-figure-doesnt-meet-journal-specifications" class="level3">
<h3 class="anchored" data-anchor-id="problem-12-figure-doesnt-meet-journal-specifications">Problem 12: “Figure doesn’t meet journal specifications”</h3>
<p><strong>Systematic check:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_figure_specs(file_path, journal_specs):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Validate figure against journal requirements</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">    journal_specs = {</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">        'max_width_inches': 7,</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">        'min_dpi': 300,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">        'allowed_formats': ['TIFF', 'PNG', 'PDF'],</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">        'max_file_size_mb': 10,</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">        'color_mode': 'RGB'</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">    }</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> os</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> Image.<span class="bu">open</span>(file_path)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    file_size_mb <span class="op">=</span> os.path.getsize(file_path) <span class="op">/</span> (<span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    issues <span class="op">=</span> []</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check format</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> img.<span class="bu">format</span> <span class="kw">not</span> <span class="kw">in</span> journal_specs[<span class="st">'allowed_formats'</span>]:</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        issues.append(<span class="ss">f"❌ Format </span><span class="sc">{</span>img<span class="sc">.</span><span class="bu">format</span><span class="sc">}</span><span class="ss"> not allowed. Use: </span><span class="sc">{</span>journal_specs[<span class="st">'allowed_formats'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check DPI</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    dpi <span class="op">=</span> img.info.get(<span class="st">'dpi'</span>, (<span class="dv">72</span>, <span class="dv">72</span>))[<span class="dv">0</span>]</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dpi <span class="op">&lt;</span> journal_specs[<span class="st">'min_dpi'</span>]:</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        issues.append(<span class="ss">f"❌ DPI </span><span class="sc">{</span>dpi<span class="sc">}</span><span class="ss"> &lt; required </span><span class="sc">{</span>journal_specs[<span class="st">'min_dpi'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check dimensions</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    width_inches <span class="op">=</span> img.size[<span class="dv">0</span>] <span class="op">/</span> dpi</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> width_inches <span class="op">&gt;</span> journal_specs[<span class="st">'max_width_inches'</span>]:</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        issues.append(<span class="ss">f"❌ Width </span><span class="sc">{</span>width_inches<span class="sc">:.2f}</span><span class="ch">\"</span><span class="ss"> &gt; max </span><span class="sc">{</span>journal_specs[<span class="st">'max_width_inches'</span>]<span class="sc">}</span><span class="ch">\"</span><span class="ss">"</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check file size</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> file_size_mb <span class="op">&gt;</span> journal_specs[<span class="st">'max_file_size_mb'</span>]:</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        issues.append(<span class="ss">f"❌ File size </span><span class="sc">{</span>file_size_mb<span class="sc">:.2f}</span><span class="ss"> MB &gt; max </span><span class="sc">{</span>journal_specs[<span class="st">'max_file_size_mb'</span>]<span class="sc">}</span><span class="ss"> MB"</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check color mode</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> img.mode <span class="op">!=</span> journal_specs[<span class="st">'color_mode'</span>]:</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        issues.append(<span class="ss">f"⚠ Color mode </span><span class="sc">{</span>img<span class="sc">.</span>mode<span class="sc">}</span><span class="ss">, required: </span><span class="sc">{</span>journal_specs[<span class="st">'color_mode'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> issues:</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Issues found:"</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> issue <span class="kw">in</span> issues:</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>issue<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"✓ All specifications met"</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>nature_specs <span class="op">=</span> {</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_width_inches'</span>: <span class="fl">7.2</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_dpi'</span>: <span class="dv">300</span>,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'allowed_formats'</span>: [<span class="st">'TIFF'</span>, <span class="st">'PDF'</span>, <span class="st">'EPS'</span>],</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_file_size_mb'</span>: <span class="dv">10</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'color_mode'</span>: <span class="st">'RGB'</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>validate_figure_specs(<span class="st">'my_figure.png'</span>, nature_specs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="quick-fix-cheat-sheet" class="level2">
<h2 class="anchored" data-anchor-id="quick-fix-cheat-sheet">10.6 Quick Fix Cheat Sheet</h2>
<p><strong>One-line fixes for common problems:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Text too small</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">11</span>  <span class="co"># Increase base font size</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Legend overlaps data</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.02</span>, <span class="dv">1</span>))  <span class="co"># Outside plot area</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Margins too tight</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="fl">2.0</span>)  <span class="co"># Increase padding</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Axes labels cut off</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'figure.png'</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)  <span class="co"># Auto-adjust bounds</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Colorbar too wide</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>plt.colorbar(fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>)  <span class="co"># Standard narrow colorbar</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Tick labels overlap</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Rotate 45°</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Grid too prominent</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>ax.grid(alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)  <span class="co"># Subtle grid</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Too much white space</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(left<span class="op">=</span><span class="fl">0.1</span>, right<span class="op">=</span><span class="fl">0.95</span>, top<span class="op">=</span><span class="fl">0.95</span>, bottom<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Inconsistent line widths</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, linewidth<span class="op">=</span><span class="fl">2.5</span>)  <span class="co"># Standard data line</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'left'</span>].set_linewidth(<span class="fl">1.5</span>)  <span class="co"># Standard axis line</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem: Can't see error bars</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>ax.errorbar(x, y, yerr<span class="op">=</span>errors, capsize<span class="op">=</span><span class="dv">6</span>, capthick<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>End of Chapter 10: Figure Troubleshooting Guide</strong></p>
<p><strong>Emergency Checklist (use when deadline is tight):</strong></p>
<pre><code> DPI ≥ 300 (check with print preview at 100%)
 File format correct for journal (usually TIFF/PNG)
 Color mode RGB (unless CMYK explicitly required)
 File size &lt; journal limit
 All text readable at intended print size
 Axes labeled with units
 Panel labels (A, B, C...) present
 Scale bars on all microscopy images
 Statistical annotations clear
 Color-blind safe palette used
 Figure works in grayscale
 Caption complete (methods, n, statistics)
 Consistent style across all manuscript figures</code></pre>
<hr>
</section>
<section id="master-checklist-publication-quality-scientific-figures" class="level1">
<h1>MASTER CHECKLIST: Publication-Quality Scientific Figures</h1>
<p><strong>Version 1.0 | Complete Reference Guide</strong></p>
<hr>
<section id="section-1-pre-design-planning" class="level2">
<h2 class="anchored" data-anchor-id="section-1-pre-design-planning">SECTION 1: PRE-DESIGN PLANNING</h2>
<section id="define-your-message" class="level3">
<h3 class="anchored" data-anchor-id="define-your-message">1.1 Define Your Message</h3>
<pre><code> One key finding per figure identified
 Target audience defined (specialists vs. general)
 Primary comparison clearly stated
 Figure type selected based on data structure</code></pre>
</section>
<section id="data-assessment" class="level3">
<h3 class="anchored" data-anchor-id="data-assessment">1.2 Data Assessment</h3>
<pre><code> Data type classified (continuous, categorical, temporal, spatial)
 Sample sizes documented (n for each group)
 Distribution assessed (normal, skewed, multimodal)
 Missing data identified and handling method determined
 Statistical tests planned</code></pre>
</section>
<section id="journal-requirements-research" class="level3">
<h3 class="anchored" data-anchor-id="journal-requirements-research">1.3 Journal Requirements Research</h3>
<pre><code> Submission guidelines read carefully
 Figure dimensions noted (single/double column width)
 Required DPI documented
 File format requirements noted
 File size limits recorded
 Color mode specified (RGB vs CMYK)
 Special requirements noted (e.g., separate panel files)</code></pre>
<hr>
</section>
</section>
<section id="section-2-color-design" class="level2">
<h2 class="anchored" data-anchor-id="section-2-color-design">SECTION 2: COLOR DESIGN</h2>
<section id="color-palette-selection" class="level3">
<h3 class="anchored" data-anchor-id="color-palette-selection">2.1 Color Palette Selection</h3>
<pre><code> Palette type matches data:
   • Sequential (ordered, one direction): Viridis, Blues, YlOrRd
   • Diverging (ordered, two directions): RdBu, PiYG, BrBG
   • Categorical (unordered): Okabe-Ito, Set2, Dark2

 Colorblind-safe palette used (test with Color Oracle)
 Maximum 3-5 colors for categorical data
 Semantic consistency applied:
   • Control always same color across figures
   • Treatment A always same color across figures
   • Statistical significance encoded consistently</code></pre>
</section>
<section id="color-accessibility" class="level3">
<h3 class="anchored" data-anchor-id="color-accessibility">2.2 Color Accessibility</h3>
<pre><code> Tested with colorblind simulator (Color Oracle, Coblis)
 Works in grayscale (print test performed)
 Redundant encoding added where critical (color + shape/line)
 Text contrast meets WCAG AA (4.5:1 minimum)
 No red-green combinations as sole distinguisher</code></pre>
</section>
<section id="color-scale-integrity" class="level3">
<h3 class="anchored" data-anchor-id="color-scale-integrity">2.3 Color Scale Integrity</h3>
<pre><code> Symmetric diverging scales (e.g., -3 to +3, center at 0)
 Colorbar included with units
 Missing data encoded distinctly (not from main palette)
 No rainbow colormap (jet, hsv) used
 Perceptually uniform colormap used for sequential data</code></pre>
<hr>
</section>
</section>
<section id="section-3-typography-labels" class="level2">
<h2 class="anchored" data-anchor-id="section-3-typography-labels">SECTION 3: TYPOGRAPHY &amp; LABELS</h2>
<section id="font-specifications" class="level3">
<h3 class="anchored" data-anchor-id="font-specifications">3.1 Font Specifications</h3>
<pre><code> Font family consistent across all figures: Arial/Helvetica
 Font hierarchy implemented:
   • Panel labels: 14-16pt, bold
   • Titles: 12-13pt, bold
   • Axis labels: 11pt, bold
   • Tick labels: 9pt, regular
   • Legend: 9pt, regular
   • Annotations: 9-10pt, regular/italic</code></pre>
</section>
<section id="axis-labels" class="level3">
<h3 class="anchored" data-anchor-id="axis-labels">3.2 Axis Labels</h3>
<pre><code> All axes labeled with variable name and units: "Variable (unit)"
 Examples checked:
   ✓ "Temperature (°C)" not "Temperature"
   ✓ "Time (hours)" not "Time"
   ✓ "Expression (FPKM)" not "Expression"
   ✓ "Fold Change (log₂)" not "Fold Change"</code></pre>
</section>
<section id="statistical-annotations" class="level3">
<h3 class="anchored" data-anchor-id="statistical-annotations">3.3 Statistical Annotations</h3>
<pre><code> Notation consistent:
   • * p &lt; 0.05
   • ** p &lt; 0.01
   • *** p &lt; 0.001
   • n.s. p ≥ 0.05
 Statistical test stated in caption
 Exact p-values provided when critical
 Sample sizes (n) stated</code></pre>
</section>
<section id="text-readability" class="level3">
<h3 class="anchored" data-anchor-id="text-readability">3.4 Text Readability</h3>
<pre><code> No overlapping labels (adjustText or ggrepel used)
 All text readable at intended print size
 High contrast: black text on white background
 No text smaller than 6pt after reduction
 Bold used for emphasis (axis labels, panel labels)</code></pre>
<hr>
</section>
</section>
<section id="section-4-plot-type-selection" class="level2">
<h2 class="anchored" data-anchor-id="section-4-plot-type-selection">SECTION 4: PLOT TYPE SELECTION</h2>
<section id="comparing-groups" class="level3">
<h3 class="anchored" data-anchor-id="comparing-groups">4.1 Comparing Groups</h3>
<pre><code>Data: Few groups (&lt;5), continuous variable
 Bar chart selected (if showing means/totals)
 Box plot selected (if showing distributions)
 Violin plot selected (if distributions complex/bimodal)
 Zero baseline used for bar charts
 Error bars included (SEM or SD specified)
 Individual data points overlaid (if n small)</code></pre>
</section>
<section id="distributions" class="level3">
<h3 class="anchored" data-anchor-id="distributions">4.2 Distributions</h3>
<pre><code>Data: Distribution of continuous variable
 Histogram used (with appropriate bin width)
 Density plot used (for smooth estimate)
 Box/violin plot used (for compact view)
 Bin width justified (Sturges', Freedman-Diaconis, or manual)</code></pre>
</section>
<section id="relationships" class="level3">
<h3 class="anchored" data-anchor-id="relationships">4.3 Relationships</h3>
<pre><code>Data: Two continuous variables
 Scatter plot used (always plot raw data)
 Regression line added if appropriate
 Correlation coefficient reported
 Hexbin or 2D density used if &gt;1000 points</code></pre>
</section>
<section id="time-series" class="level3">
<h3 class="anchored" data-anchor-id="time-series">4.4 Time Series</h3>
<pre><code>Data: Variable measured over time
 Line graph used (implies continuity)
 Small multiples used if &gt;5 series
 Shaded error bands used (cleaner than error bars)
 Time axis starts at meaningful baseline</code></pre>
</section>
<section id="what-to-avoid" class="level3">
<h3 class="anchored" data-anchor-id="what-to-avoid">4.5 What to AVOID</h3>
<pre><code> NO pie charts (use bar chart instead)
 NO 3D effects on 2D data
 NO dual y-axes (unless absolutely justified)
 NO truncated bar charts (always start at zero)
 NO rainbow colormaps (jet, hsv)</code></pre>
<hr>
</section>
</section>
<section id="section-5-layout-composition" class="level2">
<h2 class="anchored" data-anchor-id="section-5-layout-composition">SECTION 5: LAYOUT &amp; COMPOSITION</h2>
<section id="panel-arrangement" class="level3">
<h3 class="anchored" data-anchor-id="panel-arrangement">5.1 Panel Arrangement</h3>
<pre><code> Layout strategy chosen:
   • Equal weight: All panels equally important (2×2, 3×3)
   • Dominant: Main panel (60-70%) + supporting (15-20%)
   • Sequential: Left-to-right or top-to-bottom flow

 Gestalt principles applied:
   • Proximity: Related panels close together
   • Similarity: Same colors for same groups
   • Closure: Boxes/borders for grouping</code></pre>
</section>
<section id="aspect-ratios" class="level3">
<h3 class="anchored" data-anchor-id="aspect-ratios">5.2 Aspect Ratios</h3>
<pre><code> Ratio matches data structure:
   • Time series: 16:9 or 3:1 (wide)
   • Comparisons: 4:3 or 3:2 (standard)
   • Heatmaps: 1:1 or data-dependent (square)
   • Trees: 1:2 (tall)</code></pre>
</section>
<section id="white-space" class="level3">
<h3 class="anchored" data-anchor-id="white-space">5.3 White Space</h3>
<pre><code> White space: 40-60% of figure area
 Margins adequate:
   • Outer margin: 0.75-1 inch
   • Between panels: 0.25-0.5 inch (related), 0.75-1 inch (separate)
 Not too cramped (&lt;30% white space)
 Not too sparse (&gt;70% white space)</code></pre>
</section>
<section id="panel-labels" class="level3">
<h3 class="anchored" data-anchor-id="panel-labels">5.4 Panel Labels</h3>
<pre><code> All panels labeled: A, B, C...
 Labels in consistent position (top-left or top-right)
 Labels bold, large (14-16pt)
 Labels easily visible (white on dark, black on light)</code></pre>
<hr>
</section>
</section>
<section id="section-6-technical-specifications" class="level2">
<h2 class="anchored" data-anchor-id="section-6-technical-specifications">SECTION 6: TECHNICAL SPECIFICATIONS</h2>
<section id="resolution" class="level3">
<h3 class="anchored" data-anchor-id="resolution">6.1 Resolution</h3>
<pre><code> DPI appropriate for content:
   • Line art: 600-1000 DPI
   • Photos/microscopy: 300-600 DPI
   • Combination: 600 DPI
 Created at target resolution (not upsampled later)
 Effective DPI calculated: pixels / intended width (inches)</code></pre>
</section>
<section id="file-format" class="level3">
<h3 class="anchored" data-anchor-id="file-format">6.2 File Format</h3>
<pre><code> Format matches journal requirements:
   • TIFF: Publication standard (lossless)
   • PNG: Good alternative (lossless, smaller files)
   • PDF: Vector graphics
   • EPS: Legacy vector format
 NO JPEG used (lossy compression)
 Color mode correct: RGB (most common)</code></pre>
</section>
<section id="dimensions" class="level3">
<h3 class="anchored" data-anchor-id="dimensions">6.3 Dimensions</h3>
<pre><code> Width matches journal specifications:
   • Single column: typically 3.5" (89mm)
   • Double column: typically 7" (178mm)
 Height within limits (often ≤10")
 Aspect ratio appropriate for data</code></pre>
</section>
<section id="file-size" class="level3">
<h3 class="anchored" data-anchor-id="file-size">6.4 File Size</h3>
<pre><code> File size &lt; journal limit (often 5-20 MB)
 Optimization applied if needed:
   • PNG with compress_level=9
   • TIFF with LZW compression
   • Dimensions not larger than necessary
 Fallback: Split into multiple files if too large</code></pre>
<hr>
</section>
</section>
<section id="section-7-field-specific-requirements" class="level2">
<h2 class="anchored" data-anchor-id="section-7-field-specific-requirements">SECTION 7: FIELD-SPECIFIC REQUIREMENTS</h2>
<section id="microscopy-images" class="level3">
<h3 class="anchored" data-anchor-id="microscopy-images">7.1 Microscopy Images</h3>
<pre><code> Scale bar present on ALL images
 Scale bar sized appropriately (10 µm, 50 µm, 100 µm)
 Scale bar color contrasts with image (white on dark, black on light)
 Channel labels included for fluorescence:
   • Channel name (e.g., "DAPI")
   • Wavelength (e.g., "405 nm")
   • Merge clearly labeled
 Image processing documented:
   • Microscope model and settings
   • All adjustments listed
   • Uniform processing applied
 "Representative images shown" stated in caption
 Quantification included (n fields/images analyzed)</code></pre>
</section>
<section id="western-blots" class="level3">
<h3 class="anchored" data-anchor-id="western-blots">7.2 Western Blots</h3>
<pre><code> Full lanes visible (no splicing without disclosure)
 Molecular weight markers labeled
 Loading control included (β-actin, GAPDH, etc.)
 Loading control in SAME sample order
 Quantification bar chart included
 Normalized to loading control
 Error bars from biological replicates (n≥3)
 Statistical test stated
 "Representative blot from X experiments" in caption
 Original unprocessed images available</code></pre>
</section>
<section id="flow-cytometry" class="level3">
<h3 class="anchored" data-anchor-id="flow-cytometry">7.3 Flow Cytometry</h3>
<pre><code> Axes labeled: Marker name + fluorophore (e.g., "CD4-FITC")
 Scale type indicated (linear or logarithmic)
 Gates clearly visible (red lines typical)
 Population percentages shown
 Total cell count stated (n = X cells)
 Gating strategy defined in Methods or caption
 Compensation described in Methods</code></pre>
</section>
<section id="phylogenetic-trees" class="level3">
<h3 class="anchored" data-anchor-id="phylogenetic-trees">7.4 Phylogenetic Trees</h3>
<pre><code> Scale bar with units (substitutions/site, years)
 Bootstrap or posterior probability values at nodes
 Branch lengths proportional to distance
 Root indicated (outgroup stated)
 Tip labels clear
 Tree-building method stated in caption</code></pre>
</section>
<section id="network-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="network-diagrams">7.5 Network Diagrams</h3>
<pre><code> Node encoding defined (size, color, shape)
 Edge encoding defined (width, color, style)
 Layout algorithm stated
 Network statistics reported (nodes, edges, density)
 Labels non-overlapping
 Not too dense (hairball avoided)</code></pre>
<hr>
</section>
</section>
<section id="section-8-specialized-plot-types" class="level2">
<h2 class="anchored" data-anchor-id="section-8-specialized-plot-types">SECTION 8: SPECIALIZED PLOT TYPES</h2>
<section id="heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="heatmaps">8.1 Heatmaps</h3>
<pre><code> Colormap matches data type:
   • Sequential: Viridis, Plasma (one direction)
   • Diverging: RdBu, PiYG (two directions from center)
 Symmetric diverging scale if applicable (-3 to +3, center at 0)
 Colorbar present with label and units
 Normalization stated (row Z-score, raw values, etc.)
 Clustering method stated if used
 Dendrogram shown if hierarchical clustering
 NO rainbow colormap</code></pre>
</section>
<section id="volcano-plots" class="level3">
<h3 class="anchored" data-anchor-id="volcano-plots">8.2 Volcano Plots</h3>
<pre><code> X-axis: Log₂ fold change
 Y-axis: -Log₁₀ p-value
 BOTH fold change AND p-value thresholds shown
 Threshold lines visible (typically |log₂FC| &gt; 1, p &lt; 0.05)
 Three color groups:
   • Not significant (gray)
   • Upregulated significant (red)
   • Downregulated significant (blue)
 Gene counts per category in legend</code></pre>
</section>
<section id="pca-plots" class="level3">
<h3 class="anchored" data-anchor-id="pca-plots">8.3 PCA Plots</h3>
<pre><code> Variance explained in axis labels: "PC1 (45.3% variance)"
 Color/shape encodes biological variable
 95% confidence ellipses shown for groups
 Scree plot included (shows variance by PC)
 Grid lines at x=0, y=0
 Legend with sample sizes</code></pre>
</section>
<section id="survival-curves-kaplan-meier" class="level3">
<h3 class="anchored" data-anchor-id="survival-curves-kaplan-meier">8.4 Survival Curves (Kaplan-Meier)</h3>
<pre><code> Y-axis: 0 to 1 (survival probability), starts at 1.0
 X-axis: Time, starts at 0
 Step function (not smooth curve)
 95% confidence bands shown (shaded or dashed)
 Censored data marked (tick marks or + symbols)
 Log-rank test p-value reported
 Median survival times noted
 Number at risk table (or stated in caption)</code></pre>
</section>
<section id="roc-curves" class="level3">
<h3 class="anchored" data-anchor-id="roc-curves">8.5 ROC Curves</h3>
<pre><code> X-axis: False Positive Rate (1 - Specificity)
 Y-axis: True Positive Rate (Sensitivity)
 Diagonal reference line (y=x) shown
 AUC with 95% confidence interval reported
 Square aspect ratio (equal axes)
 Optimal operating point marked (if applicable)
 Sample size stated (n positives, n negatives)</code></pre>
<hr>
</section>
</section>
<section id="section-9-captions" class="level2">
<h2 class="anchored" data-anchor-id="section-9-captions">SECTION 9: CAPTIONS</h2>
<section id="caption-structure" class="level3">
<h3 class="anchored" data-anchor-id="caption-structure">9.1 Caption Structure</h3>
<pre><code> Format: [Figure #]. [One-sentence summary].
   (A) [Panel A description]. (B) [Panel B description]. ...
   [Error bar definition]. [Statistical methods]. [Abbreviations].

 Caption is self-contained (understandable without main text)
 All panels described (A, B, C...)
 Sample sizes stated for each group (n = X)
 Error bar type specified (SEM or SD)
 Statistical methods documented:
   • Test used (t-test, ANOVA, etc.)
   • Significance thresholds (*, **, ***)
   • Post-hoc tests if applicable
 Abbreviations defined at first use
 Technical details included:
   • Microscopy: scale bars, magnifications
   • Blots: antibodies, molecular weights
   • Flow: cell counts, gating strategy</code></pre>
<hr>
</section>
</section>
<section id="section-10-cross-figure-consistency" class="level2">
<h2 class="anchored" data-anchor-id="section-10-cross-figure-consistency">SECTION 10: CROSS-FIGURE CONSISTENCY</h2>
<section id="manuscript-wide-checks" class="level3">
<h3 class="anchored" data-anchor-id="manuscript-wide-checks">10.1 Manuscript-Wide Checks</h3>
<pre><code> Font family identical across all figures
 Font sizes consistent (panel labels, axes, ticks)
 Color scheme consistent:
   • Control always same color
   • Treatment A always same color
   • Treatment B always same color
 Line widths uniform (data: 2-3pt, axes: 1-1.5pt)
 Marker sizes uniform
 Panel label format consistent (position, size)
 Error bar style consistent (all SEM or all SD)
 Statistical notation consistent (*, **, ***)
 Grid styles consistent (if used)
 All figures export at same DPI (300 minimum)
 File formats consistent</code></pre>
</section>
<section id="style-guide-documentation" class="level3">
<h3 class="anchored" data-anchor-id="style-guide-documentation">10.2 Style Guide Documentation</h3>
<pre><code> Style guide created and saved:
   • Font family and sizes
   • Color palette (hex codes)
   • Line widths
   • Marker sizes
   • Aspect ratios by plot type
 Template files created (Python rcParams, R themes)
 Version control for figures:
   • File naming: figure1_v1_20250108.png
   • Change log maintained
   • Original high-res files saved separately</code></pre>
<hr>
</section>
</section>
<section id="section-11-ethical-compliance" class="level2">
<h2 class="anchored" data-anchor-id="section-11-ethical-compliance">SECTION 11: ETHICAL COMPLIANCE</h2>
<section id="image-integrity" class="level3">
<h3 class="anchored" data-anchor-id="image-integrity">11.1 Image Integrity</h3>
<pre><code> NO selective brightness/contrast adjustments
 All adjustments applied uniformly to comparison images
 Linear adjustments only (no gamma without justification)
 NO background removal beyond uniform adjustments
 NO cloning or content-aware fill
 NO selective cropping to remove unwanted features
 Original unprocessed images saved and available
 All processing documented in Methods section</code></pre>
</section>
<section id="data-integrity" class="level3">
<h3 class="anchored" data-anchor-id="data-integrity">11.2 Data Integrity</h3>
<pre><code> NO data point removal without justification
 Outliers handled transparently (method stated)
 NO selective reporting (all replicates shown or summarized)
 NO p-hacking (multiple testing corrected)
 NO misleading truncation of axes (bar charts start at zero)
 NO manipulation of scales to exaggerate effects</code></pre>
</section>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">11.3 Documentation</h3>
<pre><code> Methods section documents:
   • Image acquisition settings
   • Statistical tests and software
   • Sample sizes and replicates
   • Inclusion/exclusion criteria
   • All image processing steps
 Raw data available (in supplement or upon request)
 Code available (if computational)</code></pre>
<hr>
</section>
</section>
<section id="section-12-pre-submission-final-checks" class="level2">
<h2 class="anchored" data-anchor-id="section-12-pre-submission-final-checks">SECTION 12: PRE-SUBMISSION FINAL CHECKS</h2>
<section id="technical-quality" class="level3">
<h3 class="anchored" data-anchor-id="technical-quality">12.1 Technical Quality</h3>
<pre><code> Print test at 100% scale performed (readability check)
 DPI verified (≥300 for publication)
 File format correct for journal
 File size &lt; journal limit
 Color mode correct (RGB unless CMYK specified)
 All fonts embedded (if PDF/EPS)
 No compression artifacts (JPEG avoided)
 Files named per journal convention</code></pre>
</section>
<section id="visual-quality" class="level3">
<h3 class="anchored" data-anchor-id="visual-quality">12.2 Visual Quality</h3>
<pre><code> All text readable at intended size
 No overlapping labels
 Colors distinguish well
 Grid lines subtle (not overwhelming)
 White space balanced (40-60%)
 Panels aligned properly
 Consistent styling across all manuscript figures</code></pre>
</section>
<section id="content-completeness" class="level3">
<h3 class="anchored" data-anchor-id="content-completeness">12.3 Content Completeness</h3>
<pre><code> All axes labeled with units
 All panels labeled (A, B, C...)
 Scale bars on all microscopy images
 Molecular weight markers on all blots
 Statistical annotations clear
 Legends complete
 Captions self-contained
 Supplementary figures numbered separately</code></pre>
</section>
<section id="accessibility" class="level3">
<h3 class="anchored" data-anchor-id="accessibility">12.4 Accessibility</h3>
<pre><code> Colorblind-safe palette used
 Tested with colorblind simulator
 Works in grayscale
 Redundant encoding present (color + shape/line)
 Text contrast sufficient (WCAG AA)
 Alt text prepared (if online publication)</code></pre>
</section>
<section id="journal-specific" class="level3">
<h3 class="anchored" data-anchor-id="journal-specific">12.5 Journal-Specific</h3>
<pre><code> Dimensions match specifications
 Resolution meets requirements
 File format allowed
 File size within limits
 Special requirements met (e.g., separate panel files)
 Submission checklist completed</code></pre>
<hr>
</section>
</section>
<section id="section-13-interactive-figures-if-applicable" class="level2">
<h2 class="anchored" data-anchor-id="section-13-interactive-figures-if-applicable">SECTION 13: INTERACTIVE FIGURES (if applicable)</h2>
<section id="interactive-figure-requirements" class="level3">
<h3 class="anchored" data-anchor-id="interactive-figure-requirements">13.1 Interactive Figure Requirements</h3>
<pre><code> Static fallback version created (for print/PDF)
 Alt text provided (describes figure content)
 Colorblind-safe palette used (same as static)
 Tested on multiple browsers (Chrome, Firefox, Safari)
 Download option for underlying data provided
 Software/library versions documented in Methods
 File size optimized (&lt;10 MB target for web)</code></pre>
</section>
<section id="caption-for-interactive" class="level3">
<h3 class="anchored" data-anchor-id="caption-for-interactive">13.2 Caption for Interactive</h3>
<pre><code> Instructions included:
   • How to interact (hover, click, drag)
   • What features are available (zoom, pan, filter)
   • URL to interactive version
 Static version described: "Static version shows [state]"
 Data availability noted (supplementary table, etc.)</code></pre>
<hr>
</section>
</section>
<section id="section-14-troubleshooting-quick-fixes" class="level2">
<h2 class="anchored" data-anchor-id="section-14-troubleshooting-quick-fixes">SECTION 14: TROUBLESHOOTING QUICK FIXES</h2>
<section id="one-line-fixes" class="level3">
<h3 class="anchored" data-anchor-id="one-line-fixes">14.1 One-Line Fixes</h3>
<pre><code># Text too small
plt.rcParams['font.size'] = 11

# Legend overlaps data
ax.legend(loc='upper left', bbox_to_anchor=(1.02, 1))

# Margins too tight
plt.tight_layout(pad=2.0)

# Axes labels cut off
plt.savefig('figure.png', bbox_inches='tight')

# Tick labels overlap
ax.tick_params(axis='x', rotation=45)

# Grid too prominent
ax.grid(alpha=0.3, linewidth=0.5)

# Inconsistent line widths
ax.plot(x, y, linewidth=2.5)  # Data lines
ax.spines['left'].set_linewidth(1.5)  # Axes

# Error bars not visible
ax.errorbar(x, y, yerr=err, capsize=6, capthick=2, linewidth=2)</code></pre>
</section>
<section id="common-problems-solutions" class="level3">
<h3 class="anchored" data-anchor-id="common-problems-solutions">14.2 Common Problems → Solutions</h3>
<pre><code>Blurry figure → Re-export at 300+ DPI (don't upsample)
Colors look different in print → Use print-safe RGB palette
File too large → Optimize compression, reduce dimensions
Fonts missing → Embed fonts (fonttype=42) or use system fonts
Labels overlapping → Use adjustText (Python) or ggrepel (R)
Figure cluttered → Reduce elements, increase white space
Panels misaligned → Use consistent limits and GridSpec
Bar chart misleading → Always start at zero
P-values unreadable → Show only key comparisons or use letter notation
Journal rejection → Document all processing, provide originals</code></pre>
<hr>
</section>
</section>
<section id="section-15-manuscript-submission-checklist" class="level2">
<h2 class="anchored" data-anchor-id="section-15-manuscript-submission-checklist">SECTION 15: MANUSCRIPT SUBMISSION CHECKLIST</h2>
<section id="all-figures" class="level3">
<h3 class="anchored" data-anchor-id="all-figures">15.1 All Figures</h3>
<pre><code> Figures numbered sequentially (Figure 1, 2, 3...)
 All figures cited in text in order
 All figure files in correct format
 All figure files named correctly (e.g., Figure1.tif)
 All figure captions in separate document (if required)
 Supplementary figures numbered separately (Figure S1, S2...)
 High-resolution originals saved separately
 Figure permissions obtained (if reusing published material)</code></pre>
</section>
<section id="cover-letter" class="level3">
<h3 class="anchored" data-anchor-id="cover-letter">15.2 Cover Letter</h3>
<pre><code> Figure creation software stated
 Statistical software stated
 Any special considerations mentioned (e.g., large file sizes)
 Confirmation of original data and no manipulation</code></pre>
</section>
<section id="methods-section" class="level3">
<h3 class="anchored" data-anchor-id="methods-section">15.3 Methods Section</h3>
<pre><code> Figure creation software and versions
 Statistical tests with software
 Image acquisition parameters
 Image processing steps
 Color encodings explained
 Any custom code deposited (GitHub, Zenodo)</code></pre>
<hr>
</section>
</section>
<section id="section-16-post-submission" class="level2">
<h2 class="anchored" data-anchor-id="section-16-post-submission">SECTION 16: POST-SUBMISSION</h2>
<section id="revision-response" class="level3">
<h3 class="anchored" data-anchor-id="revision-response">16.1 Revision Response</h3>
<pre><code> Original figure files saved (for comparison)
 Revised figures clearly marked (v2, v3, etc.)
 Change log maintained (what changed and why)
 Response letter documents figure changes
 Reviewer comments addressed systematically</code></pre>
</section>
<section id="data-archival" class="level3">
<h3 class="anchored" data-anchor-id="data-archival">16.2 Data Archival</h3>
<pre><code> Raw data deposited (journal repository or public database)
 Figure source code deposited (if computational)
 Original unprocessed images archived
 Processing scripts archived
 README file with metadata</code></pre>
<hr>
</section>
</section>
<section id="emergency-deadline-checklist-30-min-review" class="level2">
<h2 class="anchored" data-anchor-id="emergency-deadline-checklist-30-min-review">EMERGENCY DEADLINE CHECKLIST (30-min review)</h2>
<p><strong>If you have 30 minutes before submission:</strong></p>
<pre><code> DPI ≥ 300 (zoom to 100% and check readability)
 File format correct (TIFF or PNG, NOT JPEG)
 All axes labeled with units
 Panel labels present (A, B, C...)
 Scale bars on microscopy images
 Color-blind safe palette (test with Color Oracle)
 Works in grayscale (File → Print Preview)
 Caption complete (n, statistics, error bars defined)
 File size &lt; limit
 Consistent style across figures
 Statistical annotations clear
 Spelling checked (titles, labels, captions)</code></pre>
<hr>
</section>
<section id="resources-tools" class="level2">
<h2 class="anchored" data-anchor-id="resources-tools">RESOURCES &amp; TOOLS</h2>
<section id="software" class="level3">
<h3 class="anchored" data-anchor-id="software">Software</h3>
<pre><code>Python: matplotlib, seaborn, plotly
R: ggplot2, patchwork, pheatmap
Color tools: Color Oracle, Coblis, ColorBrewer
Image processing: ImageJ/Fiji, Adobe Photoshop (with caution)
Vector graphics: Adobe Illustrator, Inkscape</code></pre>
</section>
<section id="color-palettes" class="level3">
<h3 class="anchored" data-anchor-id="color-palettes">Color Palettes</h3>
<pre><code>Colorblind-safe:
- Okabe-Ito (8 colors): Universal
- Viridis family: Sequential, perceptually uniform
- ColorBrewer: CVD-safe filter available</code></pre>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<pre><code>- Tufte, E. "The Visual Display of Quantitative Information"
- Wilke, C. O. "Fundamentals of Data Visualization" (online)
- Nature Methods "Points of View" series
- Journal-specific figure guidelines</code></pre>
</section>
<section id="online-validators" class="level3">
<h3 class="anchored" data-anchor-id="online-validators">Online Validators</h3>
<pre><code>- Color contrast: WebAIM Contrast Checker
- Colorblind simulation: Color Oracle, Coblis
- Image integrity: Check for duplications (manually or software)</code></pre>
<hr>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter 9.html" class="pagination-link" aria-label="Chapter 9: Interactive and Dynamic Figures">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 9: Interactive and Dynamic Figures</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>