<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 1: Foundations of Visual Perception – The Complete Guide to Bash Errors: From Beginner to Expert</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter 2.html" rel="next">
<link href="./Chapter 0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter 1.html"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Complete Guide to Bash Errors: From Beginner to Expert</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Grammar of Figures: The Art &amp; Science of Visualizing Data for Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 0.html" class="sidebar-item-text sidebar-link"><span class="chapter-title"><strong>Grammar of Figures: The Art and Science of Visualizing Data for Publication</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: The Language of Color</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: Typography, Annotation &amp; Labels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4: Data Encoding &amp; Graph Selection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Layout, Composition &amp; Figure Assembly</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: Technical Specifications &amp; Publication Requirements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Common Figure Types Deep Dive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Specialized Field Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Interactive and Dynamic Figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter 10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: Figure Troubleshooting Guide</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#how-we-see-graphical-perception-principles" id="toc-how-we-see-graphical-perception-principles" class="nav-link active" data-scroll-target="#how-we-see-graphical-perception-principles">1.1 How We See: Graphical Perception Principles</a>
  <ul class="collapse">
  <li><a href="#the-science-behind-data-visualization" id="toc-the-science-behind-data-visualization" class="nav-link" data-scroll-target="#the-science-behind-data-visualization">The Science Behind Data Visualization</a></li>
  <li><a href="#pre-attentive-processing-what-we-see-without-thinking" id="toc-pre-attentive-processing-what-we-see-without-thinking" class="nav-link" data-scroll-target="#pre-attentive-processing-what-we-see-without-thinking">Pre-attentive Processing: What We See Without Thinking</a></li>
  <li><a href="#the-hierarchy-of-perceptual-accuracy-cleveland-mcgill" id="toc-the-hierarchy-of-perceptual-accuracy-cleveland-mcgill" class="nav-link" data-scroll-target="#the-hierarchy-of-perceptual-accuracy-cleveland-mcgill">The Hierarchy of Perceptual Accuracy: Cleveland &amp; McGill</a></li>
  <li><a href="#practical-application-choosing-plot-types" id="toc-practical-application-choosing-plot-types" class="nav-link" data-scroll-target="#practical-application-choosing-plot-types">Practical Application: Choosing Plot Types</a></li>
  <li><a href="#attention-and-visual-search" id="toc-attention-and-visual-search" class="nav-link" data-scroll-target="#attention-and-visual-search">Attention and Visual Search</a></li>
  <li><a href="#gestalt-principles-in-data-visualization" id="toc-gestalt-principles-in-data-visualization" class="nav-link" data-scroll-target="#gestalt-principles-in-data-visualization">Gestalt Principles in Data Visualization</a></li>
  <li><a href="#change-blindness-and-inattentional-blindness" id="toc-change-blindness-and-inattentional-blindness" class="nav-link" data-scroll-target="#change-blindness-and-inattentional-blindness">Change Blindness and Inattentional Blindness</a></li>
  <li><a href="#working-memory-constraints" id="toc-working-memory-constraints" class="nav-link" data-scroll-target="#working-memory-constraints">Working Memory Constraints</a></li>
  <li><a href="#perceptual-biases-we-cannot-avoid" id="toc-perceptual-biases-we-cannot-avoid" class="nav-link" data-scroll-target="#perceptual-biases-we-cannot-avoid">Perceptual Biases We Cannot Avoid</a></li>
  <li><a href="#temporal-perception-animation-and-change" id="toc-temporal-perception-animation-and-change" class="nav-link" data-scroll-target="#temporal-perception-animation-and-change">Temporal Perception: Animation and Change</a></li>
  <li><a href="#exercise-1.1.1-perceptual-hierarchy-experiment" id="toc-exercise-1.1.1-perceptual-hierarchy-experiment" class="nav-link" data-scroll-target="#exercise-1.1.1-perceptual-hierarchy-experiment">Exercise 1.1.1: Perceptual Hierarchy Experiment</a></li>
  <li><a href="#exercise-1.1.2-pre-attentive-feature-detection" id="toc-exercise-1.1.2-pre-attentive-feature-detection" class="nav-link" data-scroll-target="#exercise-1.1.2-pre-attentive-feature-detection">Exercise 1.1.2: Pre-attentive Feature Detection</a></li>
  <li><a href="#exercise-1.1.3-gestalt-principles-audit" id="toc-exercise-1.1.3-gestalt-principles-audit" class="nav-link" data-scroll-target="#exercise-1.1.3-gestalt-principles-audit">Exercise 1.1.3: Gestalt Principles Audit</a></li>
  </ul></li>
  <li><a href="#visual-channels-and-their-effectiveness" id="toc-visual-channels-and-their-effectiveness" class="nav-link" data-scroll-target="#visual-channels-and-their-effectiveness">1.2 Visual Channels and Their Effectiveness</a>
  <ul class="collapse">
  <li><a href="#what-are-visual-channels" id="toc-what-are-visual-channels" class="nav-link" data-scroll-target="#what-are-visual-channels">What Are Visual Channels?</a></li>
  <li><a href="#the-complete-channel-inventory" id="toc-the-complete-channel-inventory" class="nav-link" data-scroll-target="#the-complete-channel-inventory">The Complete Channel Inventory</a></li>
  <li><a href="#matching-channels-to-data-types" id="toc-matching-channels-to-data-types" class="nav-link" data-scroll-target="#matching-channels-to-data-types">Matching Channels to Data Types</a></li>
  <li><a href="#channel-combination-rules" id="toc-channel-combination-rules" class="nav-link" data-scroll-target="#channel-combination-rules">Channel Combination Rules</a></li>
  <li><a href="#common-channel-mistakes" id="toc-common-channel-mistakes" class="nav-link" data-scroll-target="#common-channel-mistakes">Common Channel Mistakes</a></li>
  <li><a href="#exercise-1.2.1-channel-selection-practice" id="toc-exercise-1.2.1-channel-selection-practice" class="nav-link" data-scroll-target="#exercise-1.2.1-channel-selection-practice">Exercise 1.2.1: Channel Selection Practice</a></li>
  <li><a href="#exercise-1.2.2-channel-effectiveness-audit" id="toc-exercise-1.2.2-channel-effectiveness-audit" class="nav-link" data-scroll-target="#exercise-1.2.2-channel-effectiveness-audit">Exercise 1.2.2: Channel Effectiveness Audit</a></li>
  </ul></li>
  <li><a href="#gestalt-principles-in-figure-design-expanded" id="toc-gestalt-principles-in-figure-design-expanded" class="nav-link" data-scroll-target="#gestalt-principles-in-figure-design-expanded">1.3 Gestalt Principles in Figure Design (Expanded)</a>
  <ul class="collapse">
  <li><a href="#the-law-of-prägnanz-simplicity" id="toc-the-law-of-prägnanz-simplicity" class="nav-link" data-scroll-target="#the-law-of-prägnanz-simplicity">The Law of Prägnanz (Simplicity)</a></li>
  <li><a href="#advanced-gestalt-applications" id="toc-advanced-gestalt-applications" class="nav-link" data-scroll-target="#advanced-gestalt-applications">Advanced Gestalt Applications</a></li>
  </ul></li>
  <li><a href="#visual-hierarchy-and-focus" id="toc-visual-hierarchy-and-focus" class="nav-link" data-scroll-target="#visual-hierarchy-and-focus">1.4 Visual Hierarchy and Focus</a>
  <ul class="collapse">
  <li><a href="#creating-effective-visual-hierarchy" id="toc-creating-effective-visual-hierarchy" class="nav-link" data-scroll-target="#creating-effective-visual-hierarchy">Creating Effective Visual Hierarchy</a></li>
  <li><a href="#the-three-level-hierarchy" id="toc-the-three-level-hierarchy" class="nav-link" data-scroll-target="#the-three-level-hierarchy">The Three-Level Hierarchy</a></li>
  <li><a href="#contrast-as-the-primary-tool" id="toc-contrast-as-the-primary-tool" class="nav-link" data-scroll-target="#contrast-as-the-primary-tool">Contrast as the Primary Tool</a></li>
  <li><a href="#common-hierarchy-mistakes" id="toc-common-hierarchy-mistakes" class="nav-link" data-scroll-target="#common-hierarchy-mistakes">Common Hierarchy Mistakes</a></li>
  <li><a href="#exercise-1.4.1-visual-hierarchy-redesign" id="toc-exercise-1.4.1-visual-hierarchy-redesign" class="nav-link" data-scroll-target="#exercise-1.4.1-visual-hierarchy-redesign">Exercise 1.4.1: Visual Hierarchy Redesign</a></li>
  <li><a href="#theme-base-size-and-font-scaling" id="toc-theme-base-size-and-font-scaling" class="nav-link" data-scroll-target="#theme-base-size-and-font-scaling"><strong>1.5 Theme Base Size and Font Scaling</strong></a></li>
  </ul></li>
  <li><a href="#common-perceptual-traps-and-how-to-avoid-them" id="toc-common-perceptual-traps-and-how-to-avoid-them" class="nav-link" data-scroll-target="#common-perceptual-traps-and-how-to-avoid-them">1.6 Common Perceptual Traps and How to Avoid Them</a>
  <ul class="collapse">
  <li><a href="#trap-1-the-truncated-axis" id="toc-trap-1-the-truncated-axis" class="nav-link" data-scroll-target="#trap-1-the-truncated-axis">Trap 1: The Truncated Axis</a></li>
  <li><a href="#trap-2-the-dual-axis-deception" id="toc-trap-2-the-dual-axis-deception" class="nav-link" data-scroll-target="#trap-2-the-dual-axis-deception">Trap 2: The Dual Axis Deception</a></li>
  <li><a href="#trap-3-cherry-picked-axis-ranges" id="toc-trap-3-cherry-picked-axis-ranges" class="nav-link" data-scroll-target="#trap-3-cherry-picked-axis-ranges">Trap 3: Cherry-Picked Axis Ranges</a></li>
  <li><a href="#trap-4-logarithmic-scale-without-clear-indication" id="toc-trap-4-logarithmic-scale-without-clear-indication" class="nav-link" data-scroll-target="#trap-4-logarithmic-scale-without-clear-indication">Trap 4: Logarithmic Scale Without Clear Indication</a></li>
  <li><a href="#trap-5-the-3d-disaster" id="toc-trap-5-the-3d-disaster" class="nav-link" data-scroll-target="#trap-5-the-3d-disaster">Trap 5: The 3D Disaster</a></li>
  <li><a href="#exercise-1.6.1-perceptual-trap-detection" id="toc-exercise-1.6.1-perceptual-trap-detection" class="nav-link" data-scroll-target="#exercise-1.6.1-perceptual-trap-detection">Exercise 1.6.1: Perceptual Trap Detection</a></li>
  </ul></li>
  <li><a href="#chapter-1-summary" id="toc-chapter-1-summary" class="nav-link" data-scroll-target="#chapter-1-summary">Chapter 1 Summary</a>
  <ul class="collapse">
  <li><a href="#key-principles-from-visual-perception-science" id="toc-key-principles-from-visual-perception-science" class="nav-link" data-scroll-target="#key-principles-from-visual-perception-science">Key Principles from Visual Perception Science</a></li>
  <li><a href="#practical-application-checklist" id="toc-practical-application-checklist" class="nav-link" data-scroll-target="#practical-application-checklist">Practical Application Checklist</a></li>
  <li><a href="#transition-to-chapter-2" id="toc-transition-to-chapter-2" class="nav-link" data-scroll-target="#transition-to-chapter-2">Transition to Chapter 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 1: Foundations of Visual Perception</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="how-we-see-graphical-perception-principles" class="level2">
<h2 class="anchored" data-anchor-id="how-we-see-graphical-perception-principles">1.1 How We See: Graphical Perception Principles</h2>
<section id="the-science-behind-data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="the-science-behind-data-visualization">The Science Behind Data Visualization</h3>
<p>Before we can create effective scientific figures, we must understand the fundamental mechanisms of how humans perceive and interpret visual information. <strong>Graphical perception</strong> is the study of how people extract quantitative information from visual displays. Understanding these principles transforms figure design from an aesthetic exercise into a scientifically-grounded practice.</p>
</section>
<section id="pre-attentive-processing-what-we-see-without-thinking" class="level3">
<h3 class="anchored" data-anchor-id="pre-attentive-processing-what-we-see-without-thinking">Pre-attentive Processing: What We See Without Thinking</h3>
<p><strong>Pre-attentive processing</strong> refers to visual features that our brain processes automatically, before conscious attention. These features are detected in less than 200-250 milliseconds—essentially instantaneously.</p>
<p><strong>Pre-attentive Visual Features:</strong> - <strong>Color hue</strong> (red vs.&nbsp;blue) - <strong>Intensity/brightness</strong> (dark vs.&nbsp;light) - <strong>Orientation</strong> (vertical vs.&nbsp;horizontal lines) - <strong>Size</strong> (large vs.&nbsp;small) - <strong>Shape</strong> (circle vs.&nbsp;square) - <strong>Position</strong> (spatial location) - <strong>Motion</strong> (in dynamic displays)</p>
<p><strong>Example Demonstration:</strong></p>
<p>Imagine two scatter plots: - <strong>Plot A</strong>: 100 gray circles, with 1 red circle - <strong>Plot B</strong>: 100 gray circles in random positions, with 1 gray circle positioned differently</p>
<p>In Plot A, the red circle “pops out” immediately (pre-attentive color detection). In Plot B, you must consciously search for the differently positioned circle (attentive processing).</p>
<p><strong>Implication for Figure Design:</strong> Use pre-attentive features to direct attention to the most important data points or patterns. Don’t bury your key finding in visual complexity that requires effortful search.</p>
<p><strong>Good Example:</strong></p>
<pre><code>A volcano plot showing differential gene expression:
- Thousands of gray points (non-significant genes)
- Significant upregulated genes in red
- Significant downregulated genes in blue
→ The colored points immediately draw attention</code></pre>
<p><strong>Bad Example:</strong></p>
<pre><code>The same volcano plot where:
- All points are gray
- Significant genes marked only by slightly different symbols (triangle vs. circle)
→ Requires careful examination; key findings don't stand out</code></pre>
</section>
<section id="the-hierarchy-of-perceptual-accuracy-cleveland-mcgill" class="level3">
<h3 class="anchored" data-anchor-id="the-hierarchy-of-perceptual-accuracy-cleveland-mcgill">The Hierarchy of Perceptual Accuracy: Cleveland &amp; McGill</h3>
<p>In the 1980s, psychologists William Cleveland and Robert McGill conducted landmark experiments to determine how accurately people can judge different types of visual encodings. Their findings established a <strong>hierarchy of perceptual accuracy</strong>:</p>
<p><strong>Ranking from MOST to LEAST Accurate:</strong></p>
<ol type="1">
<li><strong>Position along a common scale</strong> (e.g., points on a scatter plot with shared axes)</li>
<li><strong>Position along non-aligned scales</strong> (e.g., separate panels with different scales)</li>
<li><strong>Length</strong> (e.g., bar heights)</li>
<li><strong>Direction/Angle</strong> (e.g., slopes of lines)</li>
<li><strong>Area</strong> (e.g., bubble sizes in bubble charts)</li>
<li><strong>Volume/Density</strong> (e.g., 3D shapes)</li>
<li><strong>Color saturation/intensity</strong> (e.g., heatmap gradients)</li>
<li><strong>Color hue</strong> (e.g., categorical colors)</li>
</ol>
<p><strong>What This Means for Practice:</strong></p>
<p><strong>Most Accurate Encoding (Position):</strong></p>
<pre><code>Comparing treatment effects across conditions:
✓ GOOD: Dot plot with groups on x-axis, values on y-axis
  → Direct position comparison along common y-axis scale
✗ AVOID: Pie charts comparing percentages
  → Requires angle/area judgments, much less accurate</code></pre>
<p><strong>Length vs.&nbsp;Area:</strong></p>
<pre><code>Showing relative quantities:
✓ GOOD: Bar chart (comparing bar heights/lengths)
✗ WORSE: Bubble chart (comparing circle areas)
  → People underestimate area differences

Mathematical reality:
- A circle with 2× the radius has 4× the area
- But viewers perceive only ~2× difference</code></pre>
<p><strong>Color Hue for Quantitative Data:</strong></p>
<pre><code>✗ BAD: Using rainbow colors (red → yellow → blue) for continuous data
  → No inherent ordering; perceptually non-uniform
✓ GOOD: Using sequential color scale (light blue → dark blue)
  → Clear ordering; leverages intensity perception</code></pre>
</section>
<section id="practical-application-choosing-plot-types" class="level3">
<h3 class="anchored" data-anchor-id="practical-application-choosing-plot-types">Practical Application: Choosing Plot Types</h3>
<p>Based on the Cleveland-McGill hierarchy, here’s how to select plot types:</p>
<p><strong>For Precise Quantitative Comparisons:</strong> 1. <strong>Scatter plots</strong> (position vs.&nbsp;position) 2. <strong>Line graphs</strong> (position over continuous variable like time) 3. <strong>Bar charts</strong> (length comparison) 4. <strong>Dot plots</strong> (position along scale)</p>
<p><strong>For Approximate Patterns/Trends:</strong> 5. <strong>Heatmaps</strong> (color intensity for patterns, not precise values) 6. <strong>Bubble charts</strong> (area for rough magnitude) 7. <strong>Pie charts</strong> (only for 2-3 very different proportions, if at all)</p>
<p><strong>For Categorical Relationships:</strong> 8. <strong>Box plots/Violin plots</strong> (distribution shapes) 9. <strong>Network diagrams</strong> (connectivity, not precise values)</p>
</section>
<section id="attention-and-visual-search" class="level3">
<h3 class="anchored" data-anchor-id="attention-and-visual-search">Attention and Visual Search</h3>
<p>Beyond pre-attentive processing, how we direct and sustain attention matters for complex figures.</p>
<p><strong>Limited Attention Resources:</strong> - We can only consciously attend to one thing at a time - Complex figures require serial processing (scanning element by element) - Each additional element increases cognitive load</p>
<p><strong>Implications:</strong> 1. <strong>Minimize visual clutter</strong>: Every element should serve a purpose 2. <strong>Create clear visual hierarchy</strong>: Most important elements should be most salient 3. <strong>Limit simultaneous comparisons</strong>: Human working memory holds ~4-7 items 4. <strong>Guide the viewer’s path</strong>: Use layout to create a reading order</p>
<p><strong>Example of Attention Management:</strong></p>
<p><strong>Bad: Cognitive Overload</strong></p>
<pre><code>A single figure trying to show:
- Time course of 8 treatments (8 overlapping lines)
- Individual data points (hundreds of dots)
- Error bars at each timepoint
- Statistical significance markers between all pairs
- Three different y-axis scales
→ Viewer doesn't know where to look first; analysis paralysis</code></pre>
<p><strong>Good: Staged Information</strong></p>
<pre><code>Multi-panel approach:
Panel A: Overview - mean trajectories only (3 key treatments)
Panel B: Detailed comparison - 2 treatments with error bars
Panel C: Summary - final endpoint comparison with statistics
→ Clear narrative progression; each panel has one message</code></pre>
</section>
<section id="gestalt-principles-in-data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="gestalt-principles-in-data-visualization">Gestalt Principles in Data Visualization</h3>
<p>Gestalt psychology describes how humans organize visual elements into groups or unified wholes. These principles are fundamental to effective figure layout.</p>
<section id="proximity" class="level4">
<h4 class="anchored" data-anchor-id="proximity">1. Proximity</h4>
<p><strong>Principle:</strong> Elements close together are perceived as belonging together.</p>
<p><strong>Application:</strong></p>
<pre><code>Multi-panel figures:
- Place related panels near each other
- Use white space to separate conceptually different sections
- Group legends near their corresponding data

Example:
Panel A (experiment 1) | Panel B (experiment 2)
[placed adjacently]
vs.
Panel C (control data)
[separated by white space]</code></pre>
</section>
<section id="similarity" class="level4">
<h4 class="anchored" data-anchor-id="similarity">2. Similarity</h4>
<p><strong>Principle:</strong> Elements that share visual properties (color, shape, size) are perceived as related.</p>
<p><strong>Application:</strong></p>
<pre><code>Consistent encoding across figures:
- Same colors for same treatments throughout manuscript
- Same symbols for same data types
- Same line styles for same conditions

Example:
Figure 1: Control = blue circles, Treatment = red squares
Figure 2: Should maintain same scheme, not switch arbitrarily</code></pre>
</section>
<section id="continuity" class="level4">
<h4 class="anchored" data-anchor-id="continuity">3. Continuity</h4>
<p><strong>Principle:</strong> The eye follows paths and lines naturally.</p>
<p><strong>Application:</strong></p>
<pre><code>Line graphs:
- Smooth lines guide eye through temporal progression
- Connecting related data points clarifies relationships
- Avoid unnecessary breaks in lines (unless data truly missing)

Example in multi-panel layout:
Arrange panels in reading order (left → right, top → bottom)
that matches narrative progression</code></pre>
</section>
<section id="closure" class="level4">
<h4 class="anchored" data-anchor-id="closure">4. Closure</h4>
<p><strong>Principle:</strong> We perceive complete figures even when parts are missing.</p>
<p><strong>Application:</strong></p>
<pre><code>Axis design:
✓ Can omit top and right spines (brain completes the frame)
✗ Don't omit axis labels (brain cannot infer meaning)

Scatter plots:
- Can use partial grid lines (just at major ticks)
- Brain fills in the implicit grid structure</code></pre>
</section>
<section id="figure-ground-separation" class="level4">
<h4 class="anchored" data-anchor-id="figure-ground-separation">5. Figure-Ground Separation</h4>
<p><strong>Principle:</strong> We distinguish foreground objects from background.</p>
<p><strong>Application:</strong></p>
<pre><code>Data vs. Context:
- Data elements (points, lines) should be visually prominent
- Supporting elements (grid, axis lines) should recede
- Use contrast: bold/bright for data, light/thin for context

Example:
✓ Black data points on light gray grid
✗ Gray data points on black grid (inverts natural hierarchy)</code></pre>
</section>
</section>
<section id="change-blindness-and-inattentional-blindness" class="level3">
<h3 class="anchored" data-anchor-id="change-blindness-and-inattentional-blindness">Change Blindness and Inattentional Blindness</h3>
<p><strong>Change Blindness:</strong> Failure to detect changes in visual scenes when they occur during brief interruptions.</p>
<p><strong>Relevance to Figures:</strong> - Readers may miss subtle differences between conditions if not highlighted - Before/after comparisons need clear side-by-side presentation - Don’t rely on readers remembering Figure 2 when viewing Figure 5</p>
<p><strong>Solutions:</strong></p>
<pre><code>✓ Direct comparisons within same panel or adjacent panels
✓ Use annotation arrows to highlight changes
✓ Repeat reference condition in multiple panels if needed</code></pre>
<p><strong>Inattentional Blindness:</strong> Failing to see unexpected objects when attention is focused elsewhere.</p>
<p><strong>Relevance to Figures:</strong> - Readers focused on one aspect may miss important secondary patterns - Critical findings need explicit visual emphasis - Cannot assume readers will notice everything you see</p>
<p><strong>Example:</strong></p>
<pre><code>Scatter plot showing correlation:
- Main focus: positive correlation in Treatment A
- Hidden insight: 3 extreme outliers that might be artifacts
→ If outliers aren't highlighted (different color/size),
   readers focused on the trend will miss them</code></pre>
</section>
<section id="working-memory-constraints" class="level3">
<h3 class="anchored" data-anchor-id="working-memory-constraints">Working Memory Constraints</h3>
<p><strong>Miller’s Law:</strong> Human working memory can hold approximately 7±2 items simultaneously.</p>
<p><strong>Implications for Figures:</strong></p>
<p><strong>Bad: Exceeding Memory Limits</strong></p>
<pre><code>Line graph with 15 different colored lines
→ Cannot keep track of which color means what
→ Constant back-and-forth reference to legend
→ Cognitive overload</code></pre>
<p><strong>Good: Respecting Memory Limits</strong></p>
<pre><code>Option 1: Show only 3-5 key lines, others in supplementary figure
Option 2: Use small multiples (separate panels for each line)
Option 3: Highlight 2-3 key comparisons, gray out others</code></pre>
<p><strong>Legend Design Consideration:</strong></p>
<pre><code>If legend requires &gt;7 items, consider:
- Is this really one figure, or should it be split?
- Can you use direct labeling instead of legend?
- Can you group items into fewer categories?</code></pre>
</section>
<section id="perceptual-biases-we-cannot-avoid" class="level3">
<h3 class="anchored" data-anchor-id="perceptual-biases-we-cannot-avoid">Perceptual Biases We Cannot Avoid</h3>
<section id="the-weber-fechner-law" class="level4">
<h4 class="anchored" data-anchor-id="the-weber-fechner-law">The Weber-Fechner Law</h4>
<p><strong>Principle:</strong> We perceive differences logarithmically, not linearly.</p>
<p><strong>Implications:</strong></p>
<pre><code>Comparing values:
- Difference between 1 and 2 feels bigger than between 10 and 11
  (both are +1, but 1→2 is 100% increase vs. 10→11 is 10% increase)

Solution for large ranges:
- Use log scales when data spans orders of magnitude
- This makes proportional differences perceptually equal</code></pre>
</section>
<section id="the-area-perception-bias" class="level4">
<h4 class="anchored" data-anchor-id="the-area-perception-bias">The Area Perception Bias</h4>
<p><strong>Principle:</strong> We systematically underestimate area differences.</p>
<p><strong>Example:</strong></p>
<pre><code>Circle A has diameter 10, Circle B has diameter 20
- Actual area ratio: (20/10)² = 4:1
- Perceived ratio: approximately 2:1

Implication:
✗ Bubble charts exaggerate small differences, hide large ones
✓ Use length/position encodings for accurate magnitude comparison</code></pre>
</section>
<section id="the-color-contrast-effect" class="level4">
<h4 class="anchored" data-anchor-id="the-color-contrast-effect">The Color Contrast Effect</h4>
<p><strong>Principle:</strong> Perceived color depends on surrounding colors.</p>
<p><strong>Example:</strong></p>
<pre><code>Same gray square appears:
- Darker when surrounded by white
- Lighter when surrounded by black

Implication for heatmaps:
- Use consistent backgrounds across figures
- Be aware that adjacent colors influence perception
- Test figures in both digital (white background) and print contexts</code></pre>
</section>
</section>
<section id="temporal-perception-animation-and-change" class="level3">
<h3 class="anchored" data-anchor-id="temporal-perception-animation-and-change">Temporal Perception: Animation and Change</h3>
<p>For dynamic displays (less common in static publications, but relevant for presentations and supplementary materials):</p>
<p><strong>Effective Use:</strong> - Showing temporal progression of processes - Revealing complex patterns in stages - Guiding attention through complex figures</p>
<p><strong>Caution:</strong> - Motion is highly pre-attentive (can be distracting) - Difficult to compare frames from memory - Not suitable for precise quantitative reading - Accessibility issues (motion sensitivity)</p>
<p><strong>Best Practice:</strong></p>
<pre><code>For presentations:
✓ Use animation to build up complexity gradually
✓ Pause on key frames for analysis
✓ Provide static "key frame" summary

For publications:
✓ Convert animations to multi-panel static figures
✓ Show representative timepoints</code></pre>
<hr>
</section>
<section id="exercise-1.1.1-perceptual-hierarchy-experiment" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.1.1-perceptual-hierarchy-experiment">Exercise 1.1.1: Perceptual Hierarchy Experiment</h3>
<p><strong>Objective:</strong> Experience the Cleveland-McGill hierarchy firsthand</p>
<p><strong>Materials needed:</strong> Graph paper or plotting software</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><strong>Create three versions of the same data</strong> (5 categories, values: 20, 35, 45, 60, 75):
<ul>
<li>Version A: Bar chart (length encoding)</li>
<li>Version B: Pie chart (angle encoding)</li>
<li>Version C: Bubble chart (area encoding)</li>
</ul></li>
<li><strong>Test yourself:</strong>
<ul>
<li>Look at each for 3 seconds only</li>
<li>Without referring back, estimate:
<ul>
<li>Which category has the highest value?</li>
<li>What is the ratio of largest to smallest value?</li>
<li>Rank all categories from smallest to largest</li>
</ul></li>
</ul></li>
<li><strong>Reflection questions:</strong>
<ul>
<li>Which version made estimation easiest?</li>
<li>Where did you make errors?</li>
<li>Which version required the most “mental calculation”?</li>
<li>What does this tell you about encoding choice?</li>
</ul></li>
</ol>
<p><strong>Expected finding:</strong> Bar chart will be easiest and most accurate; pie chart most difficult.</p>
<hr>
</section>
<section id="exercise-1.1.2-pre-attentive-feature-detection" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.1.2-pre-attentive-feature-detection">Exercise 1.1.2: Pre-attentive Feature Detection</h3>
<p><strong>Objective:</strong> Identify what “pops out” in your figures</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p><strong>Take a figure you’re currently working on</strong></p></li>
<li><p><strong>The 3-second test:</strong></p>
<ul>
<li>Show figure to a colleague for exactly 3 seconds</li>
<li>Remove it</li>
<li>Ask: “What did you notice first?”</li>
</ul></li>
<li><p><strong>Analysis:</strong></p>
<ul>
<li>Was the first thing they noticed your intended main message?</li>
<li>If yes: What pre-attentive feature made it stand out? (color, size, position?)</li>
<li>If no: What competed for attention? How can you adjust?</li>
</ul></li>
<li><p><strong>Redesign:</strong></p>
<ul>
<li>Emphasize the main message using pre-attentive features</li>
<li>De-emphasize secondary elements</li>
<li>Retest with a different colleague</li>
</ul></li>
</ol>
<hr>
</section>
<section id="exercise-1.1.3-gestalt-principles-audit" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.1.3-gestalt-principles-audit">Exercise 1.1.3: Gestalt Principles Audit</h3>
<p><strong>Objective:</strong> Apply Gestalt principles to improve figure organization</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p><strong>Select a multi-panel figure</strong> (your own or from a published paper)</p></li>
<li><p><strong>Analyze each Gestalt principle:</strong></p>
<ul>
<li><p><strong>Proximity:</strong> Are related panels grouped together? Is white space used to separate conceptually different elements?</p></li>
<li><p><strong>Similarity:</strong> Do similar data types use consistent visual encoding? Are colors/shapes reused meaningfully?</p></li>
<li><p><strong>Continuity:</strong> Does the layout create a natural reading path? Does it match your narrative order?</p></li>
<li><p><strong>Closure:</strong> Are all frames necessary, or could you simplify by letting the brain “complete” structures?</p></li>
<li><p><strong>Figure-Ground:</strong> Do data elements stand out from supporting elements (axes, grids)?</p></li>
</ul></li>
<li><p><strong>Score each principle:</strong> 1 (poor) to 5 (excellent)</p></li>
<li><p><strong>Identify weakest area</strong> and sketch one specific improvement</p></li>
</ol>
<p><strong>Example improvement:</strong></p>
<pre><code>Original: Four panels scattered with inconsistent spacing
Problem: Violation of proximity principle
Solution: Group panels A-B (related experiments) close together,
          separate from panels C-D (control data) with more white space</code></pre>
<hr>
</section>
</section>
<section id="visual-channels-and-their-effectiveness" class="level2">
<h2 class="anchored" data-anchor-id="visual-channels-and-their-effectiveness">1.2 Visual Channels and Their Effectiveness</h2>
<section id="what-are-visual-channels" class="level3">
<h3 class="anchored" data-anchor-id="what-are-visual-channels">What Are Visual Channels?</h3>
<p>A <strong>visual channel</strong> (or <strong>visual variable</strong>) is any controlled aspect of a graphical mark that can encode data. Understanding which channels are most effective for which data types is foundational to making good visualization choices.</p>
</section>
<section id="the-complete-channel-inventory" class="level3">
<h3 class="anchored" data-anchor-id="the-complete-channel-inventory">The Complete Channel Inventory</h3>
<p><strong>Spatial Channels (Most Effective):</strong> 1. <strong>Position (X, Y coordinates)</strong> - <em>Best for quantitative data</em> 2. <strong>Length</strong> - <em>Very good for quantitative data</em> 3. <strong>Angle</strong> - <em>Good for ordinal/limited quantitative</em> 4. <strong>Slope</strong> - <em>Good for trends and rates of change</em></p>
<p><strong>Appearance Channels (Moderate Effectiveness):</strong> 5. <strong>Area</strong> - <em>Moderate for quantitative, good for magnitude</em> 6. <strong>Volume</strong> - <em>Poor for quantitative, avoid if possible</em> 7. <strong>Color Hue</strong> - <em>Best for categorical/nominal data</em> 8. <strong>Color Saturation</strong> - <em>Good for ordinal/limited quantitative</em> 9. <strong>Color Luminance</strong> - <em>Good for quantitative (single hue)</em></p>
<p><strong>Texture Channels (Lower Effectiveness):</strong> 10. <strong>Shape</strong> - <em>Good for categorical (limited #)</em> 11. <strong>Texture/Pattern</strong> - <em>Moderate for categorical</em> 12. <strong>Orientation</strong> - <em>Moderate for categorical/ordinal</em></p>
</section>
<section id="matching-channels-to-data-types" class="level3">
<h3 class="anchored" data-anchor-id="matching-channels-to-data-types">Matching Channels to Data Types</h3>
<p>The type of data you have determines which channels are appropriate:</p>
<section id="quantitative-data-continuous-numbers" class="level4">
<h4 class="anchored" data-anchor-id="quantitative-data-continuous-numbers">1. Quantitative Data (Continuous Numbers)</h4>
<p><strong>Best Channels (in order):</strong> - <strong>Position</strong> (scatter plots, line graphs) - <strong>Length</strong> (bar charts) - <strong>Color luminance</strong> (single-hue gradient heatmaps)</p>
<p><strong>Example:</strong></p>
<pre><code>Showing gene expression levels across samples:
✓ EXCELLENT: Position (dot plot with values on y-axis)
✓ GOOD: Length (bar chart)
✓ ACCEPTABLE: Color luminance (heatmap, light→dark)
✗ POOR: Color hue (rainbow heatmap)
✗ TERRIBLE: Area/volume (3D bar chart)</code></pre>
<p><strong>Why position is best:</strong> - Humans excel at judging positions along a common scale - Precise reading possible with gridlines - Direct comparison between elements - Minimal perceptual distortion</p>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data: gene expression across 5 conditions</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>genes <span class="op">=</span> [<span class="st">'GeneA'</span>, <span class="st">'GeneB'</span>, <span class="st">'GeneC'</span>, <span class="st">'GeneD'</span>, <span class="st">'GeneE'</span>]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>expression <span class="op">=</span> [<span class="fl">2.3</span>, <span class="fl">5.1</span>, <span class="fl">3.7</span>, <span class="fl">8.2</span>, <span class="fl">4.9</span>]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># BEST: Position encoding (dot plot)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Position (best)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(expression, genes, s<span class="op">=</span><span class="dv">100</span>, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Expression Level'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Position Channel (Best)'</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'x'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Length (good)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].barh(genes, expression, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Expression Level'</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Length Channel (Good)'</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Area (poor - for comparison)</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize for bubble sizing</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>sizes <span class="op">=</span> (np.array(expression) <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].scatter([<span class="dv">1</span>]<span class="op">*</span><span class="bu">len</span>(genes), genes, s<span class="op">=</span>sizes,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'steelblue'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlim(<span class="fl">0.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xticks([])</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">'Area Channel (Poor)'</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'channel_comparison.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ordinal-data-rankedordered-categories" class="level4">
<h4 class="anchored" data-anchor-id="ordinal-data-rankedordered-categories">2. Ordinal Data (Ranked/Ordered Categories)</h4>
<p><strong>Best Channels:</strong> - <strong>Position</strong> (along an ordered axis) - <strong>Color luminance</strong> (sequential palette) - <strong>Size</strong> (small to large) - <strong>Angle</strong> (for cyclic data like time of day)</p>
<p><strong>Example:</strong></p>
<pre><code>Showing disease severity (mild, moderate, severe):
✓ EXCELLENT: Position (ordered categories on x-axis)
✓ GOOD: Color (light → dark gradient)
✓ ACCEPTABLE: Size (small → medium → large markers)
✗ POOR: Color hue (red, blue, green - no inherent order)</code></pre>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">severity =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Mild"</span>, <span class="st">"Moderate"</span>, <span class="st">"Severe"</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Position + sequential color for ordinal data</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> severity, <span class="at">y =</span> response, <span class="at">color =</span> severity)) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>) <span class="sc">+</span>  <span class="co"># Sequential palette</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease Severity"</span>, <span class="at">y =</span> <span class="st">"Treatment Response"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Position + Sequential Color for Ordinal Data"</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Legend redundant when x-axis labeled</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="categoricalnominal-data-unordered-groups" class="level4">
<h4 class="anchored" data-anchor-id="categoricalnominal-data-unordered-groups">3. Categorical/Nominal Data (Unordered Groups)</h4>
<p><strong>Best Channels:</strong> - <strong>Color hue</strong> (distinct colors) - <strong>Shape</strong> (different symbols - limit to ~6) - <strong>Position</strong> (separate groups along axis) - <strong>Faceting</strong> (separate panels)</p>
<p><strong>Example:</strong></p>
<pre><code>Showing data from 4 different cell lines:
✓ EXCELLENT: Color hue (4 distinct colors)
✓ GOOD: Shape (4 different symbols: circle, square, triangle, diamond)
✓ ACCEPTABLE: Position (4 separate groups on x-axis)
✗ AVOID: Color luminance (implies ordering that doesn't exist)</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cell_line'</span>: np.repeat([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>], <span class="dv">50</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'time'</span>: np.tile(np.arange(<span class="dv">50</span>), <span class="dv">4</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'growth'</span>: np.concatenate([</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        np.cumsum(np.random.randn(<span class="dv">50</span>) <span class="op">+</span> <span class="fl">0.5</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        np.cumsum(np.random.randn(<span class="dv">50</span>) <span class="op">+</span> <span class="fl">0.3</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        np.cumsum(np.random.randn(<span class="dv">50</span>) <span class="op">+</span> <span class="fl">0.7</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        np.cumsum(np.random.randn(<span class="dv">50</span>) <span class="op">+</span> <span class="fl">0.4</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Color hue for categorical data</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Qualitative color palette</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#E64B35'</span>, <span class="st">'#4DBBD5'</span>, <span class="st">'#00A087'</span>, <span class="st">'#3C5488'</span>]</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, cell_line <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>]):</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> data[data[<span class="st">'cell_line'</span>] <span class="op">==</span> cell_line]</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    ax.plot(subset[<span class="st">'time'</span>], subset[<span class="st">'growth'</span>],</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colors[i], linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Cell Line </span><span class="sc">{</span>cell_line<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Cell Growth (AU)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Color Hue for Categorical Data'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>ax.legend(frameon<span class="op">=</span><span class="va">True</span>, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'categorical_channels.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="channel-combination-rules" class="level3">
<h3 class="anchored" data-anchor-id="channel-combination-rules">Channel Combination Rules</h3>
<p>Often you need to encode multiple data dimensions simultaneously. Here’s how to combine channels effectively:</p>
<section id="rule-1-use-the-strongest-channel-for-the-most-important-variable" class="level4">
<h4 class="anchored" data-anchor-id="rule-1-use-the-strongest-channel-for-the-most-important-variable">Rule 1: Use the Strongest Channel for the Most Important Variable</h4>
<pre><code>Example: Scatter plot showing drug response

Primary variable (most important): Treatment outcome
Secondary variable: Patient age
Tertiary variable: Treatment group

Encoding:
✓ Position Y: Treatment outcome (strongest channel)
✓ Position X: Patient age (second strongest)
✓ Color: Treatment group (weaker channel, but effective for categories)</code></pre>
</section>
<section id="rule-2-avoid-channel-conflict" class="level4">
<h4 class="anchored" data-anchor-id="rule-2-avoid-channel-conflict">Rule 2: Avoid Channel Conflict</h4>
<p><strong>Conflict Example:</strong></p>
<pre><code>✗ BAD: Using both size AND color luminance to encode the same variable
  → Redundant and potentially contradictory
  → e.g., larger AND darker doesn't add information

✓ BETTER: Use size for one variable, color hue for another categorical variable</code></pre>
<p><strong>Non-Conflict Example:</strong></p>
<pre><code>Encoding three variables on a scatter plot:
- X-position: Time
- Y-position: Temperature
- Color: Location (categorical)
→ No conflict: each channel encodes different information</code></pre>
</section>
<section id="rule-3-leverage-redundancy-for-accessibility" class="level4">
<h4 class="anchored" data-anchor-id="rule-3-leverage-redundancy-for-accessibility">Rule 3: Leverage Redundancy for Accessibility</h4>
<p><strong>Strategic Redundancy:</strong></p>
<pre><code>✓ GOOD: Encoding the same categorical variable with BOTH color AND shape
  → Ensures colorblind accessibility
  → Shape alone works if color unavailable

Example:
Treatment A: Red circles
Treatment B: Blue squares
Treatment C: Green triangles

→ If colors indistinguishable, shapes still differentiate groups</code></pre>
</section>
<section id="rule-4-limit-channel-overload" class="level4">
<h4 class="anchored" data-anchor-id="rule-4-limit-channel-overload">Rule 4: Limit Channel Overload</h4>
<p><strong>Too Many Channels:</strong></p>
<pre><code>✗ BAD: Encoding 6 variables on one scatter plot:
  - X position
  - Y position
  - Color hue
  - Color saturation
  - Size
  - Shape

→ Cognitively overwhelming
→ Hard to decode

✓ BETTER: Use small multiples (faceting) to split some variables into panels</code></pre>
</section>
</section>
<section id="common-channel-mistakes" class="level3">
<h3 class="anchored" data-anchor-id="common-channel-mistakes">Common Channel Mistakes</h3>
<section id="mistake-1-using-area-for-quantitative-comparison" class="level4">
<h4 class="anchored" data-anchor-id="mistake-1-using-area-for-quantitative-comparison">Mistake 1: Using Area for Quantitative Comparison</h4>
<p><strong>The Problem:</strong></p>
<pre><code>Bubble chart where bubble size represents quantity:
- Data: values of 100, 200, 300
- Bubble areas: A₁, A₂, A₃
- Perceptual ratio: ~1.5:2:2.3
- Actual ratio: 1:2:3

→ Systematic underestimation of larger values</code></pre>
<p><strong>The Fix:</strong></p>
<pre><code>✓ Use length encoding instead (bar chart)
✗ If bubble chart necessary, scale radius (not area) linearly
  But still expect perceptual error</code></pre>
<p><strong>Code to Demonstrate:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>])</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG: Area proportional to value (default behavior)</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], s<span class="op">=</span>values, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlim(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'WRONG: Area ∝ Value</span><span class="ch">\n</span><span class="st">(Perceptually misleading)'</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(values)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER: Length proportional to value</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].bar([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], values, width<span class="op">=</span><span class="fl">0.6</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'BETTER: Length ∝ Value</span><span class="ch">\n</span><span class="st">(Accurate perception)'</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(values)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Value'</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'area_vs_length.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="mistake-2-rainbow-color-maps-for-quantitative-data" class="level4">
<h4 class="anchored" data-anchor-id="mistake-2-rainbow-color-maps-for-quantitative-data">Mistake 2: Rainbow Color Maps for Quantitative Data</h4>
<p><strong>The Problem:</strong></p>
<pre><code>Using hue spectrum (rainbow: red→yellow→green→blue→violet) for continuous data:

Issues:
1. No perceptual ordering (is yellow &gt; green?)
2. Non-uniform perceptual steps (yellow is much brighter)
3. False boundaries (sharp transitions in smooth data)
4. Accessibility issues (colorblind viewers lose information)</code></pre>
<p><strong>The Fix:</strong></p>
<pre><code>✓ Use sequential colormaps (single hue, varying luminance)
  Examples: Blues, Greens, Greys

✓ Use diverging colormaps for data with meaningful midpoint
  Examples: Blue-White-Red for positive/negative values

✓ Use perceptually uniform colormaps
  Examples: viridis, plasma, cividis</code></pre>
<p><strong>Demonstration:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample heatmap data</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randn(<span class="dv">10</span>, <span class="dv">10</span>).cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">4</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Rainbow</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> axes[<span class="dv">0</span>].imshow(data, cmap<span class="op">=</span><span class="st">'jet'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'BAD: Rainbow (jet)</span><span class="ch">\n</span><span class="st">Non-uniform, no order'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im1, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER: Sequential</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> axes[<span class="dv">1</span>].imshow(data, cmap<span class="op">=</span><span class="st">'Blues'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'BETTER: Sequential</span><span class="ch">\n</span><span class="st">Clear low→high'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im2, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># BEST: Perceptually uniform</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>im3 <span class="op">=</span> axes[<span class="dv">2</span>].imshow(data, cmap<span class="op">=</span><span class="st">'viridis'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">'BEST: Viridis</span><span class="ch">\n</span><span class="st">Perceptually uniform'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>plt.colorbar(im3, ax<span class="op">=</span>axes[<span class="dv">2</span>])</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'colormap_comparison.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="mistake-3-using-3d-for-2d-data" class="level4">
<h4 class="anchored" data-anchor-id="mistake-3-using-3d-for-2d-data">Mistake 3: Using 3D for 2D Data</h4>
<p><strong>The Problem:</strong></p>
<pre><code>3D bar charts, 3D pie charts, 3D scatter plots when z-axis adds no information:

Issues:
1. Perspective distortion (objects in back appear smaller)
2. Occlusion (bars hide each other)
3. Difficult to read exact values
4. Adds no information, only visual complexity</code></pre>
<p><strong>The Fix:</strong></p>
<pre><code>✓ Use 2D representations with position/length channels
✗ Only use 3D when you genuinely have 3 spatial dimensions of data
  (e.g., protein structure, geographic elevation)</code></pre>
<hr>
</section>
</section>
<section id="exercise-1.2.1-channel-selection-practice" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.2.1-channel-selection-practice">Exercise 1.2.1: Channel Selection Practice</h3>
<p><strong>Objective:</strong> Practice choosing appropriate channels for different data types</p>
<p><strong>Scenario:</strong> You have the following dataset from a clinical trial:</p>
<ul>
<li><strong>Patient ID</strong> (categorical, nominal)</li>
<li><strong>Treatment Group</strong> (categorical: A, B, C, Control)</li>
<li><strong>Age</strong> (quantitative, continuous: 20-80 years)</li>
<li><strong>Disease Severity</strong> (ordinal: Mild, Moderate, Severe)</li>
<li><strong>Treatment Outcome</strong> (quantitative, continuous: 0-100 scale)</li>
<li><strong>Time to Response</strong> (quantitative, continuous: days)</li>
</ul>
<p><strong>Task:</strong> Design visualizations for these questions, specifying which channels you’d use:</p>
<ol type="1">
<li><strong>Question:</strong> How does treatment outcome vary by treatment group?
<ul>
<li>Primary channel for outcome: _______</li>
<li>Channel for treatment group: _______</li>
<li>Justification: _______</li>
</ul></li>
<li><strong>Question:</strong> Is there a relationship between age and treatment outcome?
<ul>
<li>Channel for age: _______</li>
<li>Channel for outcome: _______</li>
<li>Optional third variable (disease severity): _______</li>
<li>Justification: _______</li>
</ul></li>
<li><strong>Question:</strong> How do the four treatment groups compare across disease severity levels?
<ul>
<li>Channel for treatment group: _______</li>
<li>Channel for severity: _______</li>
<li>Channel for outcome: _______</li>
<li>Plot type: _______</li>
</ul></li>
</ol>
<p><strong>Deliverable:</strong> Sketch rough layouts and write 2-3 sentences justifying each channel choice based on the Cleveland-McGill hierarchy.</p>
<hr>
</section>
<section id="exercise-1.2.2-channel-effectiveness-audit" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.2.2-channel-effectiveness-audit">Exercise 1.2.2: Channel Effectiveness Audit</h3>
<p><strong>Objective:</strong> Evaluate channel usage in existing figures</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p><strong>Find 3 published figures</strong> from your field (preferably recent high-impact papers)</p></li>
<li><p><strong>For each figure, document:</strong></p>
<ul>
<li>What channels are used? (position, length, color, size, shape, etc.)</li>
<li>What type of data is each channel encoding? (quantitative, ordinal, categorical)</li>
<li>Is this an effective match based on the hierarchy?</li>
</ul></li>
<li><p><strong>Identify at least one figure where:</strong></p>
<ul>
<li>A strong channel is wasted on less important data</li>
<li>A weak channel is used for critical quantitative data</li>
<li>Channel choice could be improved</li>
</ul></li>
<li><p><strong>Redesign:</strong> Sketch how you would reassign channels for better effectiveness</p></li>
</ol>
<p><strong>Example Analysis:</strong></p>
<pre><code>Figure: Scatter plot of gene expression

Current encoding:
- X-axis (position): Gene ID number (nominal) ❌
- Y-axis (position): Expression level (quantitative) ✓
- Color (hue): Experimental condition (categorical) ✓

Problem: X-axis position (strongest channel) wasted on arbitrary gene IDs

Improved encoding:
- X-axis (position): Time point
</code></pre>
</section>
</section>
<section id="gestalt-principles-in-figure-design-expanded" class="level2">
<h2 class="anchored" data-anchor-id="gestalt-principles-in-figure-design-expanded">1.3 Gestalt Principles in Figure Design (Expanded)</h2>
<section id="the-law-of-prägnanz-simplicity" class="level3">
<h3 class="anchored" data-anchor-id="the-law-of-prägnanz-simplicity">The Law of Prägnanz (Simplicity)</h3>
<p>Beyond the basic Gestalt principles introduced in 1.1, the overarching <strong>Law of Prägnanz</strong> states that people perceive and interpret ambiguous or complex images in the simplest form possible. Our brains seek to impose order and structure on visual information.</p>
<p><strong>Implication for Scientific Figures:</strong> - Viewers will try to find patterns even in random data - Clear, simple structures are processed faster and remembered better - Unnecessary complexity causes cognitive strain</p>
</section>
<section id="advanced-gestalt-applications" class="level3">
<h3 class="anchored" data-anchor-id="advanced-gestalt-applications">Advanced Gestalt Applications</h3>
<section id="common-fate" class="level4">
<h4 class="anchored" data-anchor-id="common-fate">Common Fate</h4>
<p><strong>Principle:</strong> Elements moving in the same direction are perceived as a group.</p>
<p><strong>Static Figure Applications:</strong></p>
<pre><code>Line graphs with multiple time series:
✓ Lines following similar trajectories naturally group together
✓ Diverging lines signal important differences
✓ Use this to your advantage: arrange panels so similar patterns are adjacent

Example:
Panel A: All upward trends (treatment responders)
Panel B: All downward trends (treatment non-responders)
→ Visual coherence within each panel strengthens message</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate common fate grouping</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 1: Similar upward trajectories (common fate)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>group1 <span class="op">=</span> [time <span class="op">*</span> <span class="fl">0.8</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>          time <span class="op">*</span> <span class="fl">0.9</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>          time <span class="op">*</span> <span class="fl">0.85</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Group 2: Similar flat trajectories (common fate)</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>group2 <span class="op">=</span> [<span class="dv">5</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>          <span class="fl">5.5</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>          <span class="fl">4.8</span> <span class="op">+</span> np.random.randn(<span class="dv">50</span>) <span class="op">*</span> <span class="fl">0.5</span>]</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot group 1 in shades of red (responders)</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, trajectory <span class="kw">in</span> <span class="bu">enumerate</span>(group1):</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    ax.plot(time, trajectory, color<span class="op">=</span>plt.cm.Reds(<span class="fl">0.5</span> <span class="op">+</span> i<span class="op">*</span><span class="fl">0.15</span>),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Responder </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">''</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot group 2 in shades of blue (non-responders)</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, trajectory <span class="kw">in</span> <span class="bu">enumerate</span>(group2):</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    ax.plot(time, trajectory, color<span class="op">=</span>plt.cm.Blues(<span class="fl">0.5</span> <span class="op">+</span> i<span class="op">*</span><span class="fl">0.15</span>),</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Non-responder </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">''</span>)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time (hours)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Biomarker Level'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Common Fate: Trajectories Naturally Group'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'common_fate_example.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="symmetry-and-balance" class="level4">
<h4 class="anchored" data-anchor-id="symmetry-and-balance">Symmetry and Balance</h4>
<p><strong>Principle:</strong> Symmetric elements are perceived as belonging together and forming a coherent whole.</p>
<p><strong>Applications in Multi-Panel Figures:</strong></p>
<pre><code>✓ Symmetric grid layouts feel organized and professional
✓ Asymmetry draws attention (use deliberately for emphasis)

Example layouts:

Symmetric (balanced, harmonious):
[Panel A] [Panel B]
[Panel C] [Panel D]

Asymmetric for emphasis (main result gets more space):
[Panel A - large    ] [B]
[Panel C - large    ] [D]
→ Panels A &amp; C visually dominate</code></pre>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample plots</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Panel A: Main Result"</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Panel B: Control"</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> disp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Panel C: Supplementary"</span>) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> qsec, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Panel D: Supplementary"</span>) <span class="sc">+</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Symmetric layout</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>symmetric <span class="ot">&lt;-</span> (p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Asymmetric layout (emphasize A and C)</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>asymmetric <span class="ot">&lt;-</span> (p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) <span class="sc">+</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"symmetric_layout.png"</span>, symmetric, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"asymmetric_layout.png"</span>, asymmetric, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="connectedness" class="level4">
<h4 class="anchored" data-anchor-id="connectedness">Connectedness</h4>
<p><strong>Principle:</strong> Elements connected by lines or enclosed in shapes are perceived as more strongly grouped than mere proximity.</p>
<p><strong>Applications:</strong></p>
<pre><code>✓ Use lines to connect related data points (time series)
✓ Use boxes/frames to group related panels
✓ Use arrows to show causal relationships

Example:
Before/After comparison:
[Before image] --arrow--&gt; [After image]
→ Arrow creates stronger association than just placement</code></pre>
<hr>
</section>
</section>
</section>
<section id="visual-hierarchy-and-focus" class="level2">
<h2 class="anchored" data-anchor-id="visual-hierarchy-and-focus">1.4 Visual Hierarchy and Focus</h2>
<section id="creating-effective-visual-hierarchy" class="level3">
<h3 class="anchored" data-anchor-id="creating-effective-visual-hierarchy">Creating Effective Visual Hierarchy</h3>
<p><strong>Visual hierarchy</strong> is the arrangement of elements in order of importance, guiding the viewer’s attention through the figure in a deliberate sequence.</p>
</section>
<section id="the-three-level-hierarchy" class="level3">
<h3 class="anchored" data-anchor-id="the-three-level-hierarchy">The Three-Level Hierarchy</h3>
<p>Every effective figure has three levels:</p>
<section id="level-1-primary-focus-the-message" class="level4">
<h4 class="anchored" data-anchor-id="level-1-primary-focus-the-message">Level 1: Primary Focus (The Message)</h4>
<p><strong>This should be seen first, within 1-2 seconds.</strong></p>
<p><strong>Techniques to create primary focus:</strong> 1. <strong>High contrast</strong> - Make it darker, brighter, or more saturated than everything else 2. <strong>Larger size</strong> - Primary element should be visually dominant 3. <strong>Central position</strong> - Eye naturally goes to center first 4. <strong>Enclosure</strong> - Box, circle, or annotation around key element 5. <strong>Isolation</strong> - Surround with white space</p>
<p><strong>Example:</strong></p>
<pre><code>Scatter plot showing drug efficacy:
Primary focus: The significant outlier responders
→ Make them larger, brighter color, add annotation arrow

Secondary: All other data points
→ Smaller, gray, lower opacity

Tertiary: Grid, axes, legend
→ Lightest gray, thin lines</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randn(<span class="dv">100</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">100</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify "significant" outliers</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>outlier_idx <span class="op">=</span> np.where((y <span class="op">&gt;</span> <span class="dv">4</span>) <span class="op">|</span> (y <span class="op">&lt;</span> <span class="op">-</span><span class="dv">4</span>))[<span class="dv">0</span>]</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure with visual hierarchy</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Level 3: Grid (most subtle)</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'gray'</span>, zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Level 2: Regular data points (secondary)</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>regular_idx <span class="op">=</span> np.setdiff1d(np.arange(<span class="bu">len</span>(x)), outlier_idx)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>ax.scatter(x[regular_idx], y[regular_idx],</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>           s<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'lightgray'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, zorder<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Regular'</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Level 1: Outliers (PRIMARY FOCUS)</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>ax.scatter(x[outlier_idx], y[outlier_idx],</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>           s<span class="op">=</span><span class="dv">200</span>, color<span class="op">=</span><span class="st">'#E63946'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>, zorder<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>           edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidths<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Outliers'</span>)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate one key outlier</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(outlier_idx) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>    key_outlier <span class="op">=</span> outlier_idx[<span class="dv">0</span>]</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>    ax.annotate(<span class="st">'Key responder'</span>,</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>                xy<span class="op">=</span>(x[key_outlier], y[key_outlier]),</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>                xytext<span class="op">=</span>(x[key_outlier]<span class="op">-</span><span class="dv">1</span>, y[key_outlier]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'#E63946'</span>,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>                arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'#E63946'</span>, lw<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>                zorder<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Styling (de-emphasize axes - level 3)</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Drug Concentration (μM)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Cell Response (AU)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Visual Hierarchy: Outliers Stand Out'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'left'</span>].set_color(<span class="st">'gray'</span>)</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'bottom'</span>].set_color(<span class="st">'gray'</span>)</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'lower right'</span>, frameon<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'visual_hierarchy.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="level-2-supporting-context" class="level4">
<h4 class="anchored" data-anchor-id="level-2-supporting-context">Level 2: Supporting Context</h4>
<p><strong>Provides necessary information but doesn’t compete with primary focus.</strong></p>
<p><strong>Elements at this level:</strong> - Main data that isn’t the key finding - Axis labels and titles - Legend (if not redundant) - Reference lines or regions</p>
<p><strong>Techniques:</strong> - Medium contrast - Standard sizing - Neutral colors (blacks, grays, muted tones)</p>
</section>
<section id="level-3-infrastructure" class="level4">
<h4 class="anchored" data-anchor-id="level-3-infrastructure">Level 3: Infrastructure</h4>
<p><strong>Essential for interpretation but should fade into background.</strong></p>
<p><strong>Elements at this level:</strong> - Grid lines - Minor tick marks - Axis lines - Background shading</p>
<p><strong>Techniques:</strong> - Low contrast (light grays) - Thin line weights - Semi-transparency</p>
</section>
</section>
<section id="contrast-as-the-primary-tool" class="level3">
<h3 class="anchored" data-anchor-id="contrast-as-the-primary-tool">Contrast as the Primary Tool</h3>
<p><strong>Types of contrast for creating hierarchy:</strong></p>
<p><strong>1. Value Contrast (Light vs.&nbsp;Dark)</strong></p>
<pre><code>✓ Dark data on light background (most common)
✓ Light data on dark background (for presentations/posters)
✗ Medium gray data on medium gray background (no contrast)</code></pre>
<p><strong>2. Saturation Contrast</strong></p>
<pre><code>✓ Saturated color for key data, desaturated for context
Example: Bright red key points, pale pink supporting data</code></pre>
<p><strong>3. Size Contrast</strong></p>
<pre><code>✓ Larger primary elements, smaller supporting elements
Rule of thumb: 2:1 or 3:1 size ratio minimum</code></pre>
<p><strong>4. Weight Contrast</strong></p>
<pre><code>✓ Bold/thick for primary, light/thin for secondary
Applies to: lines, fonts, borders</code></pre>
</section>
<section id="common-hierarchy-mistakes" class="level3">
<h3 class="anchored" data-anchor-id="common-hierarchy-mistakes">Common Hierarchy Mistakes</h3>
<section id="mistake-1-everything-is-emphasized-nothing-stands-out" class="level4">
<h4 class="anchored" data-anchor-id="mistake-1-everything-is-emphasized-nothing-stands-out">Mistake 1: Everything is Emphasized (Nothing Stands Out)</h4>
<p><strong>Bad Example:</strong></p>
<pre><code>✗ All data points large and bright
✗ Bold axis labels
✗ Thick grid lines
✗ Multiple colors all saturated
→ Result: Visual chaos, no clear message</code></pre>
<p><strong>Fix:</strong></p>
<pre><code>✓ Choose ONE element as primary focus
✓ Make everything else subordinate
✓ Ask: "If viewer sees only one thing, what should it be?"</code></pre>
</section>
<section id="mistake-2-wrong-element-is-emphasized" class="level4">
<h4 class="anchored" data-anchor-id="mistake-2-wrong-element-is-emphasized">Mistake 2: Wrong Element is Emphasized</h4>
<p><strong>Bad Example:</strong></p>
<pre><code>✗ Huge, bold legend in bright colors
✗ Decorative border or logo prominently featured
✗ Actual data is small and gray
→ Result: Reader focuses on metadata, not results</code></pre>
<p><strong>Fix:</strong></p>
<pre><code>✓ Data ink &gt;&gt; non-data ink (Tufte's principle)
✓ Legend should be smallest readable size
✓ Branding/logos should be minimal or absent</code></pre>
</section>
<section id="mistake-3-competing-focal-points" class="level4">
<h4 class="anchored" data-anchor-id="mistake-3-competing-focal-points">Mistake 3: Competing Focal Points</h4>
<p><strong>Bad Example:</strong></p>
<pre><code>✗ Three different elements all trying to be #1:
  - Large red title
  - Bright blue highlighted region
  - Orange outlier points
→ Result: Eye doesn't know where to go first</code></pre>
<p><strong>Fix:</strong></p>
<pre><code>✓ Clear priority: One primary (e.g., outliers)
✓ Others as secondary (title standard weight, region subtle shading)
✓ Use color consistently, not for multiple purposes</code></pre>
<hr>
</section>
</section>
<section id="exercise-1.4.1-visual-hierarchy-redesign" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.4.1-visual-hierarchy-redesign">Exercise 1.4.1: Visual Hierarchy Redesign</h3>
<p><strong>Objective:</strong> Transform a flat figure into one with clear visual hierarchy</p>
<p><strong>Materials:</strong> - Take a figure you’ve created (or find one online) where everything has similar visual weight</p>
<p><strong>Task:</strong></p>
<ol type="1">
<li><strong>Audit current state:</strong>
<ul>
<li>List all visual elements in the figure</li>
<li>Rate each on “attention-grabbing” scale (1-10)</li>
<li>Identify if multiple elements score 8-10 (competing focus problem)</li>
</ul></li>
<li><strong>Define hierarchy:</strong>
<ul>
<li>What is THE main message? (This becomes Level 1)</li>
<li>What supports understanding? (Level 2)</li>
<li>What is infrastructure? (Level 3)</li>
</ul></li>
<li><strong>Redesign with tools:</strong>
<ul>
<li><strong>For Level 1:</strong> Increase size by 2x, use high-contrast color, add annotation</li>
<li><strong>For Level 2:</strong> Use medium gray or neutral colors, standard sizes</li>
<li><strong>For Level 3:</strong> Reduce to light gray (alpha=0.2-0.3), thin lines</li>
</ul></li>
<li><strong>Test:</strong>
<ul>
<li>Show both versions to a colleague for 3 seconds each</li>
<li>Ask: “What did you notice first?”</li>
<li>Did the redesign direct attention correctly?</li>
</ul></li>
</ol>
<p><strong>Example Transformation:</strong></p>
<p><em>Before:</em> - All scatter points same size (50 pixels) - All points same color (blue) - Grid lines same thickness as data trendline - Title and axis labels same font weight</p>
<p><em>After:</em> - Key points: 150 pixels, red - Other points: 30 pixels, light gray - Grid lines: alpha=0.2, thin - Trendline: Bold, black - Title: Bold, axis labels: regular weight</p>
<hr>
</section>
<section id="theme-base-size-and-font-scaling" class="level3">
<h3 class="anchored" data-anchor-id="theme-base-size-and-font-scaling"><strong>1.5 Theme Base Size and Font Scaling</strong></h3>
<p><strong>Principle:</strong> Set appropriate base font sizes that account for potential figure reduction.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Font size calculation for figure reduction</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">FONT SIZE PLANNING:</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">Journals often reduce figures to fit column width:</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">- 50% reduction common (7" → 3.5")</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">- Font sizes reduce proportionally</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">Minimum readable size: 6-7 points after reduction</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">Calculation:</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">If figure reduced 50%, you need DOUBLE the font size:</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">- Want 8pt final → Use 16pt in original</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">- Want 10pt final → Use 20pt in original</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">Safe starting sizes (for 50% reduction):</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">- Title: 24-28pt → becomes 12-14pt ✓</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">- Axis labels: 20-22pt → becomes 10-11pt ✓</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">- Tick labels: 16-18pt → becomes 8-9pt ✓</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">- Legend: 16-18pt → becomes 8-9pt ✓</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: TOO SMALL - Will be unreadable after reduction</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>ax1.scatter(x, y, s<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Variable X (units)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)  <span class="co"># TOO SMALL</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Variable Y (units)'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)  <span class="co"># TOO SMALL</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Too Small Fonts'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)  <span class="co"># TOO SMALL</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(labelsize<span class="op">=</span><span class="dv">7</span>)  <span class="co"># TOO SMALL</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>ax1.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>ax1.text(<span class="fl">0.5</span>, <span class="fl">1.15</span>, <span class="st">'❌ BAD: After 50</span><span class="sc">% r</span><span class="st">eduction</span><span class="ch">\n</span><span class="st">Title→5pt, Labels→4pt (UNREADABLE)'</span>,</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax1.transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#FFCCCC'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: CORRECT - Accounts for reduction</span></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>ax2.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#27AE60'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Variable X (units)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)  <span class="co"># GOOD</span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Variable Y (units)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)  <span class="co"># GOOD</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Correct Font Sizes'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)  <span class="co"># GOOD</span></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(labelsize<span class="op">=</span><span class="dv">12</span>)  <span class="co"># GOOD</span></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>ax2.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>ax2.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>ax2.text(<span class="fl">0.5</span>, <span class="fl">1.15</span>, <span class="st">'✓ GOOD: After 50</span><span class="sc">% r</span><span class="st">eduction</span><span class="ch">\n</span><span class="st">Title→8pt, Labels→7pt (READABLE)'</span>,</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax2.transAxes, ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#CCFFCC'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Theme base_size comparison</span></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Matplotlib rcParams approach</span></span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">18</span>,  <span class="co"># Base size accounting for reduction</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: <span class="dv">20</span>,</span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="dv">22</span>,</span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: <span class="dv">16</span>,</span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: <span class="dv">16</span>,</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.fontsize'</span>: <span class="dv">16</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>ax3.scatter(x, y, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#3498DB'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Variable X (units)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Variable Y (units)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Using rcParams Base Size'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a>ax3.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a>code_example <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a><span class="st"># Set once at script start:</span></span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a><span class="st">plt.rcParams['font.size'] = 18</span></span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a><span class="st">plt.rcParams['axes.labelsize'] = 20</span></span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a><span class="st">plt.rcParams['axes.titlesize'] = 22</span></span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a><span class="st"># All subsequent plots inherit these sizes</span></span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>ax3.text(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.25</span>, code_example, transform<span class="op">=</span>ax3.transAxes,</span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a>        ha<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>, family<span class="op">=</span><span class="st">'monospace'</span>,</span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightgray'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel D: Test print guide</span></span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a>ax4.axis(<span class="st">'off'</span>)</span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a>test_guide <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a><span class="st">FONT SIZE TEST PROCEDURE:</span></span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a><span class="st">1. Create figure at FINAL SIZE</span></span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a><span class="st">   fig, ax = plt.subplots(figsize=(3.5, 2.5))</span></span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a><span class="st">   # Not (7, 5) if it will be reduced to (3.5, 2.5)!</span></span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a><span class="st">2. Set fonts for FINAL SIZE</span></span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a><span class="st">   ax.set_xlabel('Label', fontsize=11)</span></span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a><span class="st">   # Not 22 if figure already at final size</span></span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a><span class="st">3. Save and PRINT at 100</span><span class="sc">% s</span><span class="st">cale</span></span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a><span class="st">   plt.savefig('test.pdf', dpi=300)</span></span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a><span class="st">   # Print without "fit to page"</span></span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a><span class="st">4. Check readability:</span></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a><span class="st">   • Can you read smallest text from 1 foot away?</span></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a><span class="st">   • Are subscripts/superscripts clear?</span></span>
<span id="cb60-117"><a href="#cb60-117" aria-hidden="true" tabindex="-1"></a><span class="st">   • Is legend distinguishable?</span></span>
<span id="cb60-118"><a href="#cb60-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="st">5. If NO to any → Increase font sizes</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a><span class="st">ALTERNATIVE: Scale test</span></span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="st">• Create at large size (7×5)</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a><span class="st">• Print and physically reduce by 50%</span></span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a><span class="st">• Check readability</span></span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a>ax4.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, test_guide, transform<span class="op">=</span>ax4.transAxes,</span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a>        verticalalignment<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, family<span class="op">=</span><span class="st">'monospace'</span>,</span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightyellow'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-131"><a href="#cb60-131" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Font Size Testing Guide'</span>,</span>
<span id="cb60-132"><a href="#cb60-132" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb60-133"><a href="#cb60-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-134"><a href="#cb60-134" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb60-135"><a href="#cb60-135" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'font_size_reduction_planning.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb60-136"><a href="#cb60-136" aria-hidden="true" tabindex="-1"></a>           bbox_inches<span class="op">=</span><span class="st">'tight'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb60-137"><a href="#cb60-137" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb60-138"><a href="#cb60-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-139"><a href="#cb60-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset rcParams</span></span>
<span id="cb60-140"><a href="#cb60-140" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(plt.rcParamsDefault)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>R equivalent:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Base size in ggplot2 theme</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Will scale all text proportionally</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># TOO SMALL (will be unreadable after reduction)</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>p_bad <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">'#3498DB'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Variable X (units)'</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Variable Y (units)'</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Too Small Fonts'</span>) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">8</span>) <span class="sc">+</span>  <span class="co"># TOO SMALL!</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>))</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD (accounts for 50% reduction)</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>p_good <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">'#27AE60'</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Variable X (units)'</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Variable Y (units)'</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correct Font Sizes'</span>) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span>  <span class="co"># GOOD!</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Save at final intended size</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">'figure_correct_size.png'</span>, p_good,</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">3.5</span>, <span class="at">height =</span> <span class="fl">2.5</span>,  <span class="co"># Final size, not pre-reduction</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="common-perceptual-traps-and-how-to-avoid-them" class="level2">
<h2 class="anchored" data-anchor-id="common-perceptual-traps-and-how-to-avoid-them">1.6 Common Perceptual Traps and How to Avoid Them</h2>
<section id="trap-1-the-truncated-axis" class="level3">
<h3 class="anchored" data-anchor-id="trap-1-the-truncated-axis">Trap 1: The Truncated Axis</h3>
<p><strong>The Problem:</strong> When y-axis doesn’t start at zero for bar charts, small differences appear exaggerated.</p>
<p><strong>Example of Misuse:</strong></p>
<pre><code>Sales data:
Competitor A: 98 units
Our product: 100 units

✗ BAD: Y-axis from 95-100
→ Bar for our product appears 2.5x taller (visual difference 5 units out of 5)
→ Actual difference: 2% (100 vs 98)</code></pre>
<p><strong>When It’s Acceptable:</strong></p>
<pre><code>✓ Line graphs (emphasizing trend over absolute values)
✓ Scatter plots (focusing on relationship)
✓ When differences ARE meaningful relative to natural variation

Example: Temperature anomalies
- Baseline: 15.0°C
- Year 1: 15.1°C
- Year 2: 15.3°C
✓ OK to zoom to 14.8-15.5°C range
→ These small changes are scientifically significant</code></pre>
<p><strong>Code Example - Demonstrating the Effect:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Competitor A'</span>, <span class="st">'Our Product'</span>]</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="dv">98</span>, <span class="dv">100</span>]</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># MISLEADING: Truncated axis for bar chart</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].bar(categories, values, color<span class="op">=</span>[<span class="st">'gray'</span>, <span class="st">'steelblue'</span>])</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="dv">95</span>, <span class="dv">101</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Sales (units)'</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'MISLEADING: Truncated Axis</span><span class="ch">\n</span><span class="st">(Appears 5x difference)'</span>,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">11</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co"># HONEST: Full axis from zero</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].bar(categories, values, color<span class="op">=</span>[<span class="st">'gray'</span>, <span class="st">'steelblue'</span>])</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="dv">110</span>)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Sales (units)'</span>)</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'HONEST: Full Axis</span><span class="ch">\n</span><span class="st">(Shows 2</span><span class="sc">% d</span><span class="st">ifference)'</span>,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">11</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'truncated_axis_trap.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution:</strong></p>
<pre><code>For bar charts:
✓ Always start at zero (or explicitly show break if necessary)
✓ Add context: "Values differ by 2% (98 vs 100)"

For line graphs:
✓ Truncation is OK but add reference line at zero
✓ Clearly label axis range
✓ Consider showing full range in inset panel</code></pre>
</section>
<section id="trap-2-the-dual-axis-deception" class="level3">
<h3 class="anchored" data-anchor-id="trap-2-the-dual-axis-deception">Trap 2: The Dual Axis Deception</h3>
<p><strong>The Problem:</strong> Dual y-axes allow arbitrary scaling that can manufacture correlations or hide them.</p>
<p><strong>Example of Misuse:</strong></p>
<pre><code>✗ Graph showing "Ice cream sales" and "Drowning deaths" over months
→ Both increase in summer
→ Dual axes scaled to make lines overlap perfectly
→ Implies causal relationship (which doesn't exist)</code></pre>
<p><strong>Why It’s Problematic:</strong></p>
<pre><code>1. No inherent relationship between the two scales
2. Can be manipulated to show any pattern desired
3. Viewer cannot judge relative magnitudes
4. Confuses correlation with causation</code></pre>
<p><strong>Better Alternatives:</strong></p>
<pre><code>✓ Option 1: Two separate plots stacked vertically
  → Allows visual comparison without misleading single axis

✓ Option 2: Normalize both variables (0-100% scale or z-scores)
  → Same scale, honest comparison

✓ Option 3: Scatter plot (X = variable 1, Y = variable 2)
  → Shows relationship directly

✓ Option 4: If truly related, use secondary axis BUT:
  - Use same scale factor (e.g., both per capita)
  - Make relationship explicit ("°F" vs "°C" - mathematically linked)</code></pre>
<p><strong>Code Example (R):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>ice_cream <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">65</span>, <span class="dv">45</span>, <span class="dv">30</span>, <span class="dv">22</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>drownings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">month =</span> months, <span class="at">ice_cream =</span> ice_cream, <span class="at">drownings =</span> drownings)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Dual axis (manipulable)</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>p_bad <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> month)) <span class="sc">+</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream), <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> drownings <span class="sc">*</span> <span class="dv">6</span>), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Scaled to overlap</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">6</span>, <span class="at">name =</span> <span class="st">"Drownings"</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MISLEADING: Dual Axis (Scales Manipulated)"</span>) <span class="sc">+</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER: Separate panels</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> ice_cream)) <span class="sc">+</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Ice Cream Sales"</span>, <span class="at">title =</span> <span class="st">"Ice Cream Sales"</span>) <span class="sc">+</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> drownings)) <span class="sc">+</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Drownings"</span>, <span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">title =</span> <span class="st">"Drowning Deaths"</span>) <span class="sc">+</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>p_good <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"BETTER: Separate Panels (Honest Comparison)"</span>)</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"dual_axis_bad.png"</span>, p_bad, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"dual_axis_good.png"</span>, p_good, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="trap-3-cherry-picked-axis-ranges" class="level3">
<h3 class="anchored" data-anchor-id="trap-3-cherry-picked-axis-ranges">Trap 3: Cherry-Picked Axis Ranges</h3>
<p><strong>The Problem:</strong></p>
<p>Selectively choosing axis ranges to emphasize or hide patterns.</p>
<p><strong>Example:</strong></p>
<pre><code>Clinical trial results:

Full timeline (0-24 months):
→ Drug effect appears temporary, returns to baseline

Cropped timeline (0-6 months):
→ Drug appears highly effective
→ Hides the fact that effect disappears

✗ Publishing only the 6-month view is misleading</code></pre>
<p><strong>Solution:</strong></p>
<pre><code>✓ Show complete temporal or spatial range relevant to the study
✓ If cropping for focus, include inset with full range
✓ State explicit rationale for range choice
✓ Provide supplementary figures with full data</code></pre>
</section>
<section id="trap-4-logarithmic-scale-without-clear-indication" class="level3">
<h3 class="anchored" data-anchor-id="trap-4-logarithmic-scale-without-clear-indication">Trap 4: Logarithmic Scale Without Clear Indication</h3>
<p><strong>The Problem:</strong> Log scales dramatically change visual perception but are easy to miss.</p>
<p><strong>Example:</strong></p>
<pre><code>Linear scale:
1, 2, 3, 4, 5, 10, 100, 1000
→ Visually: huge jump to 100

Log scale:
10⁰, 10¹, 10², 10³
→ Visually: even spacing
→ Can hide massive actual differences</code></pre>
<p><strong>When Logarithmic Scales are Appropriate:</strong></p>
<pre><code>✓ Data spanning multiple orders of magnitude
✓ Exponential growth/decay processes
✓ Multiplicative effects (fold-changes)
✓ When relative changes matter more than absolute

Examples:
- Gene expression (ranges from 0.01 to 10,000)
- Earthquake magnitudes (Richter scale)
- Sound intensity (decibels)
- Drug concentrations (dose-response curves)</code></pre>
<p><strong>How to Use Responsibly:</strong></p>
<pre><code>✓ Label axis clearly: "Log₁₀ Concentration"
✓ Show actual values on tick labels (1, 10, 100) not (0, 1, 2)
✓ Mention in caption: "Note logarithmic scale"
✓ Consider showing both linear and log versions</code></pre>
<p><strong>Code Example (Python):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential data</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.exp(x<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear scale</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, y, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Cell Count'</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'LINEAR Scale</span><span class="ch">\n</span><span class="st">(Emphasizes recent growth)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, y, <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'coral'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Cell Count (log scale)'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'LOGARITHMIC Scale</span><span class="ch">\n</span><span class="st">(Shows exponential trend clearly)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(alpha<span class="op">=</span><span class="fl">0.3</span>, which<span class="op">=</span><span class="st">'both'</span>)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight log scale usage</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="fl">0.5</span>, <span class="fl">0.95</span>, <span class="st">'NOTE: Log scale'</span>, transform<span class="op">=</span>axes[<span class="dv">1</span>].transAxes,</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">11</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'yellow'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'log_scale_comparison.png'</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="trap-5-the-3d-disaster" class="level3">
<h3 class="anchored" data-anchor-id="trap-5-the-3d-disaster">Trap 5: The 3D Disaster</h3>
<p><strong>The Problem:</strong> 3D charts for 2D data introduce perspective distortion and occlusion without adding information.</p>
<p><strong>Common Offenders:</strong> - 3D pie charts - 3D bar charts - 3D scatter plots (when Z-axis is unused)</p>
<p><strong>Why They Fail:</strong></p>
<pre><code>1. Perspective makes closer elements appear larger
2. Back elements occluded by front elements
3. Difficult to read exact values
4. Chartjunk (unnecessary visual complexity)
5. "Cool factor" often motivates use, not data needs</code></pre>
<p><strong>Example:</strong></p>
<pre><code>✗ 3D pie chart:
→ Slice in foreground appears larger than identical slice in background
→ Pure perceptual distortion

✓ 2D pie chart (or better, bar chart):
→ Accurate representation
→ Easy comparison</code></pre>
<p><strong>When 3D is Justified:</strong></p>
<pre><code>✓ Genuine spatial data (protein structures, geographic terrain)
✓ Physical specimens (medical imaging)
✓ Three independent quantitative variables

Even then, consider:
- Providing multiple 2D views (orthogonal projections)
- Interactive 3D (can rotate) for digital supplements
- Color/size encoding on 2D projection as alternative</code></pre>
<hr>
</section>
<section id="exercise-1.6.1-perceptual-trap-detection" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1.6.1-perceptual-trap-detection">Exercise 1.6.1: Perceptual Trap Detection</h3>
<p><strong>Objective:</strong> Develop critical eye for misleading visualizations</p>
<p><strong>Materials:</strong> News articles, advertisements, or scientific papers with quantitative graphics</p>
<p><strong>Task:</strong></p>
<ol type="1">
<li><p><strong>Find 5 figures</strong> from various sources (news media, research papers, company reports)</p></li>
<li><p><strong>For each, check for these traps:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Truncated axis (bar chart not starting at zero)</label></li>
<li><label><input type="checkbox">Dual axes (with manipulated scaling)</label></li>
<li><label><input type="checkbox">Cherry-picked range (timeline suspiciously cropped)</label></li>
<li><label><input type="checkbox">Unlabeled log scale</label></li>
<li><label><input type="checkbox">Unnecessary 3D</label></li>
<li><label><input type="checkbox">Misleading aspect ratio (tall/skinny vs.&nbsp;wide/short changes perception of slope)</label></li>
</ul></li>
<li><p><strong>Analyze intent:</strong></p>
<ul>
<li>Is this an honest mistake or deliberate distortion?</li>
<li>What is the figure trying to emphasize?</li>
<li>How would fixing the issue change the message?</li>
</ul></li>
<li><p><strong>Redesign one:</strong></p>
<ul>
<li>Choose the most misleading figure</li>
<li>Create an honest version</li>
<li>Write 2-3 sentences on how perception changes</li>
</ul></li>
</ol>
<p><strong>Example Analysis:</strong></p>
<pre><code>Figure: Bar chart from Company X press release
Trap detected: Y-axis starts at 95%, goes to 100%
Effect: 96% → 98% improvement appears massive (fills whole chart)
Honest version: Y-axis 0-100% shows 2 percentage point change (barely visible)
Conclusion: Likely deliberate to exaggerate modest improvement</code></pre>
<hr>
</section>
</section>
<section id="chapter-1-summary" class="level2">
<h2 class="anchored" data-anchor-id="chapter-1-summary">Chapter 1 Summary</h2>
<section id="key-principles-from-visual-perception-science" class="level3">
<h3 class="anchored" data-anchor-id="key-principles-from-visual-perception-science">Key Principles from Visual Perception Science</h3>
<ol type="1">
<li><strong>Pre-attentive processing</strong> guides immediate attention
<ul>
<li>Use color, size, position strategically</li>
<li>Key findings should “pop out” without effort</li>
</ul></li>
<li><strong>Cleveland-McGill hierarchy</strong> informs encoding choices
<ul>
<li>Position &gt; Length &gt; Angle &gt; Area &gt; Color hue</li>
<li>Match strongest channels to most important data</li>
</ul></li>
<li><strong>Gestalt principles</strong> create coherent organization
<ul>
<li>Proximity, similarity, continuity, closure</li>
<li>Work with brain’s natural grouping tendencies</li>
</ul></li>
<li><strong>Visual hierarchy</strong> directs viewer’s eye
<ul>
<li>Three levels: Primary focus, supporting context, infrastructure</li>
<li>Use contrast (value, saturation, size, weight) to differentiate</li>
</ul></li>
<li><strong>Working memory limits</strong> constrain complexity
<ul>
<li>7±2 items maximum simultaneously</li>
<li>Simplify, chunk, or use small multiples</li>
</ul></li>
<li><strong>Perceptual biases</strong> require vigilance
<ul>
<li>We underestimate area differences</li>
<li>We perceive logarithmically</li>
<li>Dual axes and truncated ranges can mislead</li>
</ul></li>
</ol>
</section>
<section id="practical-application-checklist" class="level3">
<h3 class="anchored" data-anchor-id="practical-application-checklist">Practical Application Checklist</h3>
<p>Before finalizing any figure, ask:</p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>Can a naive viewer identify the main message in 3 seconds?</strong></label></li>
<li><label><input type="checkbox"><strong>Are the strongest visual channels used for the most important data?</strong></label></li>
<li><label><input type="checkbox"><strong>Does the layout group related elements (Gestalt proximity/similarity)?</strong></label></li>
<li><label><input type="checkbox"><strong>Is there a clear visual hierarchy (one primary focus)?</strong></label></li>
<li><label><input type="checkbox"><strong>Are comparisons easy (common scales, aligned axes)?</strong></label></li>
<li><label><input type="checkbox"><strong>Is the figure free from perceptual traps (truncation, dual axes, unnecessary 3D)?</strong></label></li>
<li><label><input type="checkbox"><strong>Would this work in grayscale (redundant encoding for accessibility)?</strong></label></li>
<li><label><input type="checkbox"><strong>Does it require less than 7 simultaneous comparisons?</strong></label></li>
</ul>
</section>
<section id="transition-to-chapter-2" class="level3">
<h3 class="anchored" data-anchor-id="transition-to-chapter-2">Transition to Chapter 2</h3>
<p>Now that we understand <strong>how humans perceive visual information</strong>, we can make informed decisions about <strong>specific design elements</strong>.</p>
<p><strong>Chapter 2: The Language of Color</strong> will build on these perceptual foundations to explore: - Color theory and color spaces - Choosing palettes for different data types - Accessibility and color-blind friendly design - Avoiding common color mistakes</p>
<p>You now have the cognitive science framework; next we apply it to one of the most powerful (and most misused) visual channels: <strong>color</strong>.</p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter 0.html" class="pagination-link" aria-label="**Grammar of Figures: The Art and Science of Visualizing Data for Publication**">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title"><strong>Grammar of Figures: The Art and Science of Visualizing Data for Publication</strong></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter 2.html" class="pagination-link" aria-label="Chapter 2: The Language of Color">
        <span class="nav-page-text"><span class="chapter-title">Chapter 2: The Language of Color</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>